import{r as M}from"./index-5284b0bf.js";import{s as q}from"./index-847519d5.js";const y=Math.min,O=Math.max,V=Date.now,R=e=>e!=null,J=(e,t)=>Array.from({length:e},(r,o)=>t(o)),B=(e,t)=>{let r;const o=()=>{R(r)&&clearTimeout(r)},c=()=>{o(),r=setTimeout(()=>{r=null,e()},t)};return c._cancel=o,c},j=(e,t)=>{let r=V()-t;return(...o)=>{const c=V();r+t<c&&(r=c,e(...o))}},k=e=>{let t,r;return(...o)=>(t||(t=!0,r=e(...o)),r)},E=-1,v=(e,t)=>{const r=e._sizes[t];return r===E?e._defaultItemSize:r},H=(e,t,r)=>{e._sizes[t]=r,e._measuredOffsetIndex=y(t,e._measuredOffsetIndex)},Q=(e,t,r)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return r?e._offsets[t]+v(e,t):e._offsets[t];let o=e._measuredOffsetIndex,c=e._offsets[o];for(;o<=t&&(e._offsets[o]=c,!(o===t&&!r));)c+=v(e,o),o++;return e._measuredOffsetIndex=t,c},ee=e=>Q(e,e._length-1,!0),F=(e,t)=>Q(e,t),X=(e,t,r)=>{let o=0;if(r>=0)for(;t<e._length-1;){const c=v(e,t++);if((o+=c)>=r){o-c/2>=r&&t--;break}}else for(;t>0;){const c=v(e,--t);if((o-=c)<=r){o+c/2<r&&t++;break}}return y(O(t,0),e._length-1)},P=(e,t,r,o)=>X(e,r,t-o),Z=X,te=(e,t,r)=>{for(let o=t;o<=r;o++)if(e._sizes[o]===E)return!0;return!1},$=(e,t,r)=>({_defaultItemSize:t,_length:e,_measuredOffsetIndex:r?y(r._measuredOffsetIndex,e-1):0,_sizes:J(e,o=>{const c=r&&r._sizes[o];return R(c)?c:E}),_offsets:J(e,o=>{if(o===0)return 0;const c=r&&r._offsets[o];return R(c)?c:E})}),w=0,Y=1,N=2,A=3,b=1,T=2,U=3,W=4,oe=(e,t,r=0,o,c)=>{let g=t*O(r-1,0),z=0,d=[],f=$(e,t),S=w,I=[0,r],n;const _=new Set;return{_getRange(){const[s,i]=I,m=F(f,s),l=P(f,z,s,m),u=Z(f,l,g);return s===l&&i===u?I:I=[l,u]},_isUnmeasuredItem(s){return f._sizes[s]===E},_hasUnmeasuredItemsInRange(s){return te(f,s,Z(f,s,g))},_getItemOffset(s){return F(f,s)},_getItemSize(s){return v(f,s)},_getScrollOffset(){return z},_getViewportSize(){return g},_getScrollSize(){return ee(f)},_getJump(){return d},_getItemIndexForScrollTo(s){return P(f,s,0,0)},_waitForScrollDestinationItemsMeasured(){return n&&n[1](),new Promise((s,i)=>{n=[()=>{Promise.resolve().then(()=>{s(),n=void 0})},i]})},_subscribe(s){return _.add(s),()=>{_.delete(s)}},_update(s,i){(()=>{switch(s){case b:{const l=i.filter(([a,p])=>f._sizes[a]!==p);if(!l.length)return!1;const u=[];return l.forEach(([a,p])=>{u.push([p-v(f,a),a]),H(f,a,p)}),d=u,!0}case T:return g===i?!1:(g=i,!0);case U:case W:{const l=z;return(z=i)!==l}}})()&&(_.forEach(l=>{l()}),s===U?c(z):n&&s===b&&n[0]())},_getScrollDirection(){return S},_setScrollDirection(s){const i=S;S=s,S===w?o(!1):i===w&&(S===Y||S===N)&&o(!0)},_updateCacheLength(s){f._length!==s&&(f=$(s,t,f))}}},ie=typeof window<"u"?M.useLayoutEffect:M.useEffect,ce=(e,t)=>q.useSyncExternalStore(e,t,t),se=k(e=>{const t="scrollLeft",r=e[t];e[t]=1;const o=e[t]<1;return e[t]=r,o}),le=(e,t,r,o)=>{let c;const g=t?"scrollLeft":"scrollTop",z=()=>c?t?c.scrollWidth:c.scrollHeight:0,d=(n,_)=>se(c)||_?-n:e._getScrollSize()-e._getViewportSize()-n,f=(n,_)=>{c&&(t&&r&&(n=d(n,_)),_?c[g]+=n:(c[g]=n,e._setScrollDirection(A)))},S=async(n,_)=>{const s=()=>{let i=_();const m=z(),l=e._getViewportSize();return m-(i+l)<=0&&(i=m-l),i};if(e._hasUnmeasuredItemsInRange(n)){do{e._update(W,s());try{await e._waitForScrollDestinationItemsMeasured()}catch{return}}while(e._hasUnmeasuredItemsInRange(n));f(s())}else{const i=s();f(i),e._update(W,i)}},I=n=>n.reduce((_,[s])=>_+s,0);return{_initRoot(n){c=n;const _=()=>{let l=n[g];t&&r&&(l=d(l));const u=e._getScrollOffset();if(u===l)return;const a=e._getScrollDirection(),p=o();(a===w||!p)&&a!==A&&e._setScrollDirection(u>l?N:Y),e._update(U,l)},s=B(()=>{_(),e._setScrollDirection(w)},150),i=()=>{_(),s()},m=j(l=>{if(e._getScrollDirection()!==w&&!l.ctrlKey&&(t?l.deltaX:l.deltaY)){const u=e._getScrollOffset();u>0&&u<e._getScrollSize()-e._getViewportSize()&&s()}},50);return n.addEventListener("scroll",i),n.addEventListener("wheel",m,{passive:!0}),()=>{n.removeEventListener("scroll",i),n.removeEventListener("wheel",m),s._cancel()}},_getActualScrollSize:z,_scrollTo(n){n=O(n,0),S(e._getItemIndexForScrollTo(n),()=>n)},_scrollToIndex(n,_){n=O(y(n,_-1),0),S(n,()=>e._getItemOffset(n))},_fixScrollJump:(n,_)=>{const s=e._getScrollDirection();if(s===N){const i=I(n);i&&f(i,!0)}else if(s===A){const i=e._getScrollOffset();if(i!==0){const m=I(n);if(e._getScrollSize()-(i+e._getViewportSize()+m)<=0)m&&f(i+m);else{const l=n.reduce((u,[a,p])=>(p<_&&(u+=a),u),0);l&&f(l,!0)}}}}}},G="current",fe=e=>!R(e)||typeof e=="boolean",ue=e=>{const t=M.useRef();return t[G]||(t[G]=e())},ae=(e,t)=>{let r=!1,o;const c=t?"width":"height",g=new WeakMap,z=k(()=>new ResizeObserver(d=>{const f=[];for(const{target:S,contentRect:I}of d)if(S===o)e._update(T,I[c]);else{const n=g.get(S);R(n)&&f.push([n,I[c]])}f.length&&(e._update(b,f),r=!0)}));return{_observeRoot(d){o=d;const f=z();return f.observe(d),()=>{f.disconnect()}},_observeItem(d,f){const S=z();return g.set(d,f),S.observe(d),()=>{g.delete(d),S.unobserve(d)}},_isJustResized(){const d=r;return r=!1,d}}},_e=(e,t)=>{let r=!1,o=!1,c;const g="height",z="width",d=new WeakMap,f=new Set,S=new Set,I=new Map,n=(s,i)=>`${s}-${i}`,_=k(()=>new ResizeObserver(s=>{const i=new Set,m=new Set;for(const{target:l,contentRect:u}of s)if(l===c)e._update(T,u[g]),t._update(T,u[z]);else{const a=d.get(l);if(a){const[p,h]=a,K=n(p,h),C=I.get(K),x=[u[g],u[z]];let L,D;C?(C[0]!==x[0]&&(L=!0),C[1]!==x[1]&&(D=!0)):L=D=!0,L&&i.add(p),D&&m.add(h),(L||D)&&I.set(K,x)}}if(i.size){const l=[];i.forEach(u=>{let a=0;S.forEach(p=>{const h=I.get(n(u,p));h&&(a=O(a,h[0]))}),a&&l.push([u,a])}),e._update(b,l),r=!0}if(m.size){const l=[];m.forEach(u=>{let a=0;f.forEach(p=>{const h=I.get(n(p,u));h&&(a=O(a,h[1]))}),a&&l.push([u,a])}),t._update(b,l),o=!0}}));return{_observeRoot(s){c=s;const i=_();return i.observe(s),()=>{i.disconnect()}},_observeItem(s,i,m){const l=_();return d.set(s,[i,m]),f.add(i),S.add(m),l.observe(s),()=>{d.delete(s),l.unobserve(s)}},_isJustResized(s){const i=s?o:r;return s?o=!1:r=!1,i}}};export{ie as a,ue as b,oe as c,le as d,y as e,_e as f,R as g,ae as h,fe as i,O as m,G as r,ce as u};
//# sourceMappingURL=resizer-ba43f0ed.js.map
