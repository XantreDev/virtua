import{r as L}from"./index-c6dae603.js";import{j as Q}from"./jsx-runtime-c3d7f245.js";const x=Math.min,z=Math.max,pe=Math.abs,Y=Date.now,xe=Object.values,ge=Array.isArray,re=setTimeout,V=(e,t,s)=>x(s,z(t,e)),K=e=>e!=null,Se=e=>{const t=[...e].sort((r,n)=>r-n),s=e.length/2|0;return t.length%2===0?(t[s-1]+t[s])/2:t[s]},oe=(e,t)=>{let s;const r=()=>{K(s)&&clearTimeout(s)},n=()=>{r(),s=re(()=>{s=null,e()},t)};return n._cancel=r,n},we=(e,t)=>{let s=Y()-t;return(...r)=>{const n=Y();s+t<n&&(s=n,e(...r))}},J=e=>{let t,s;return(...r)=>(t||(t=!0,s=e(...r)),s)},ie=e=>getComputedStyle(e),B=e=>e?parseFloat(e):0,y=-1,N=(e,t)=>{const s=e._sizes[t];return s===y?e._defaultItemSize:s},Ie=(e,t,s)=>{const r=e._sizes[t]===y;return e._sizes[t]=s,e._measuredOffsetIndex=x(t,e._measuredOffsetIndex),r},X=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let s=e._measuredOffsetIndex,r=e._offsets[s];for(;s<t;)r+=N(e,s),e._offsets[++s]=r;return e._measuredOffsetIndex=t,r},be=e=>e._length?X(e,e._length-1)+N(e,e._length-1):0,j=(e,t,s)=>{let r=0;if(s>=0)for(;t<e._length-1;){const n=N(e,t++);if((r+=n)>=s){r-n/2>=s&&t--;break}}else for(;t>0;){const n=N(e,--t);if((r-=n)<=s){r+n/2<s&&t++;break}}return V(t,0,e._length-1)},$=(e,t,s)=>j(e,s,t-X(e,s)),Oe=(e,t,s)=>e._sizes.slice(t,s+1).includes(y),ve=e=>{const t=e._sizes.filter(r=>r!==y),s=t[0];e._defaultItemSize=t.every(r=>r===s)?s:Se(t)},le=(e,t,s)=>{const r=s?"unshift":"push";for(let n=e._length;n<t;n++)e._sizes[r](y),e._offsets.push(n===0?0:y);e._length=t},Re=(e,t)=>{const s={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return le(s,e),s},H=(e,t,s)=>{const r=t-e._length,n=r<0;let u;return n?(u=(s?e._sizes.splice(0,-r):e._sizes.splice(r)).reduce((l,i)=>l+(i===y?e._defaultItemSize:i),0),e._offsets.splice(r)):(u=e._defaultItemSize*r,le(e,e._length+r,s)),e._measuredOffsetIndex=s?0:V(t-1,0,e._measuredOffsetIndex),e._length=t,[u,n]},q=(e,t,s)=>t.reduce((r,[n,u])=>{const l=u-N(e,n);return(!s||l>0)&&(r+=l),r},0),he=1.5,U=0,ue=1,F=2,k=1,D=2,ze=3,W=4,fe=5,Z=6,ce=7,ee=1,G=2,te=4,se=8,Ee=16,Ne=(e,t,s=40,r=0,n=Re(t,s),u,l)=>{let i=s*z(r-1,0),o=0,c=0,p=0,d=U,f=!1,w=!1,g=!1,m=[0,r];const S=new Set,h=()=>be(n),b=()=>h()-i,A=_=>V(_,0,b()),T=_=>{const a=d;return d=_,d!==a};return{_getCache(){return JSON.parse(JSON.stringify(n))},_getRange(){const[_,a]=m,I=$(n,o,x(_,n._length-1)),O=j(n,I,i);return _===I&&a===O?m:m=[I,O]},_isUnmeasuredItem(_){return n._sizes[_]===y},_hasUnmeasuredItemsInTargetViewport(_){const a=$(n,_,m[0]);return Oe(n,z(0,a-1),x(n._length-1,j(n,a,i)+1))},_getItemOffset(_){const a=X(n,_);return u?a+z(0,i-h()):a},_getItemSize(_){return N(n,_)},_getItemsLength(){return n._length},_getScrollOffset(){return o},_getScrollOffsetMax:b,_getScrollDirection(){return d},_getViewportSize(){return i},_getCorrectedScrollSize(){return z(h(),i)},_getJumpCount(){return c},_flushJump(){const _=p;return p=0,_},_subscribe(_,a){const I=[_,a];return S.add(I),()=>{S.delete(I)}},_update(_,a){let I,O=0;switch(_){case k:{const v=a.filter(([E,M])=>n._sizes[E]!==M);if(!v.length)break;let R=0;if(f||w){const[E]=m;o===0||(o>b()-he?R=q(n,v,!0):R=q(n,v.filter(([M])=>M<E)))}else d===F&&(R=q(n,v));R&&(p=R,c++,O+=te);let C=!1;v.forEach(([E,M])=>{Ie(n,E,M)&&(C=!0)}),l&&C&&!o&&ve(n),O+=G,g=I=!0;break}case D:{i!==a&&(i=a,O=G);break}case ze:{if(a[1]){const v=b()-o,[R,C]=H(n,a[0],!0),E=C?-x(R,v):R;p+=E,o=A(o+E),c++,O=ee+te,f=!0}else H(n,a[0]);break}case W:case fe:{if(o===a)break;if(_===W){const v=a-o,R=g;g=!1,(d===U||!R)&&!w&&T(v<0?F:ue)&&(O+=se),I=pe(v)>i,O+=Ee,R||(f=!1)}o=A(a),O+=ee;break}case Z:{T(U)&&(O=se),f=w=!1;break}case ce:{w=!0;break}}if(O){const v=()=>{S.forEach(([R,C])=>{O&R&&C()})};I?e(v):v()}}}},de=typeof window<"u"?L.useLayoutEffect:L.useEffect,P="current",Ae={},ae=(e,t)=>{if(ge(e))for(const s of e)ae(s,t);else!K(e)||typeof e=="boolean"||t.push(e)},Me=e=>{const t=[];return ae(e,t),t},Ve=(e,t,s)=>z(e-(s===ue?1:z(1,t)),0),ke=(e,t,s,r)=>x(e+(s===F?1:z(1,t)),r-1),ye=e=>{const t=L.useRef(e);return de(()=>{t[P]=e},[e]),t},De=(e,t,s,r)=>{const[n,u]=L.useState(t),l=ye(t);if(de(()=>e._subscribe(s,()=>{u(()=>l[P]())}),[]),r){const i=t();n!==i&&u(i)}return n},Le=J(e=>{const t="scrollLeft",s=e[t];e[t]=1;const r=e[t]<1;return e[t]=s,r}),_e=(e,t,s)=>we(r=>{if(e._getScrollDirection()!==U&&!r.ctrlKey&&(t?r.deltaX:r.deltaY)){const n=e._getScrollOffset();n>0&&n<e._getScrollOffsetMax()&&s()}},50),Ue=(e,t,s)=>{let r,n;const u=t?"scrollLeft":"scrollTop",l=(o,c)=>t&&s?Le(r)||c?-o:e._getScrollOffsetMax()-o:o,i=async o=>{if(!r)return;const c=()=>V(o(),0,e._getScrollOffsetMax());for(;;){const p=c();if(e._update(fe,p),!e._hasUnmeasuredItemsInTargetViewport(p))break;n&&n[1]();const d=e._subscribe(G,()=>{n&&n[0]()});try{await new Promise((f,w)=>{let g=!1;const m=()=>{g||(g=!0,f(),n=void 0)};n=[m,w],re(m,250)})}catch{return}finally{d()}}r[u]=l(c()),e._update(ce)};return{_initRoot(o){r=o;const c=()=>{e._update(W,l(o[u]))},p=oe(()=>{c(),e._update(Z)},150),d=()=>{c(),p()},f=_e(e,t,p);return o.addEventListener("scroll",d),o.addEventListener("wheel",f,{passive:!0}),()=>{o.removeEventListener("scroll",d),o.removeEventListener("wheel",f),p._cancel()}},_scrollTo(o){i(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),i(()=>o)},_scrollToIndex(o,c){o=V(o,0,e._getItemsLength()-1),i(c==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{r&&(r[u]+=l(o,!0))}}},We=(e,t)=>{const s=t?"scrollX":"scrollY",r=t?"offsetLeft":"offsetTop";return{_initRoot(n){let u=!1;const l=(f,w)=>{const g=w+f[r],m=f.offsetParent;return f===document.body||!m?g:l(m,g)},i=()=>{u&&e._update(W,window[s]-l(n,0))},o=oe(()=>{i(),e._update(Z)},150),c=()=>{i(),o()},p=_e(e,t,o),d=new IntersectionObserver(([f])=>{u=f.isIntersecting});return d.observe(n),window.addEventListener("scroll",c),window.addEventListener("wheel",p,{passive:!0}),()=>{d.disconnect(),window.removeEventListener("scroll",c),window.removeEventListener("wheel",p),o._cancel()}},_fixScrollJump:n=>{window.scrollBy(t?n:0,t?0:n)}}},Pe=e=>{const t=L.useRef();return t[P]||(t[P]=e())},me={box:"border-box"},Ke=(e,t)=>{let s;const r=t?"width":"height",n=new WeakMap,u=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:c}of l)if(o===s)e._update(D,c[r]+c[t?"left":"top"]+B(ie(s)[t?"paddingRight":"paddingBottom"]));else{const p=n.get(o);K(p)&&i.push([p,c[r]])}i.length&&e._update(k,i)}));return{_observeRoot(l){s=l;const i=u();return i.observe(l,me),()=>{i.disconnect()}},_observeItem(l,i){const o=u();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},Je=(e,t)=>{const s=t?"width":"height",r=t?"innerWidth":"innerHeight",n=new WeakMap,u=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:c}of l){const p=n.get(o);K(p)&&i.push([p,c[s]])}i.length&&e._update(k,i)}));return{_observeRoot(){const l=()=>{e._update(D,window[r])};return window.addEventListener("resize",l),l(),()=>{window.removeEventListener("resize",l),u().disconnect()}},_observeItem(l,i){const o=u();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},qe=(e,t)=>{let s;const r="height",n="width",u=new WeakMap,l=new Set,i=new Set,o=new Map,c=(d,f)=>`${d}-${f}`,p=J(()=>new ResizeObserver(d=>{const f=new Set,w=new Set;for(const{target:g,contentRect:m}of d)if(g===s){const S=ie(s);e._update(D,m[r]+m.top+B(S.paddingBottom)),t._update(D,m[n]+m.left+B(S.paddingRight))}else{const S=u.get(g);if(S){const[h,b]=S,A=c(h,b),T=o.get(A),_=[m[r],m[n]];let a,I;T?(T[0]!==_[0]&&(a=!0),T[1]!==_[1]&&(I=!0)):a=I=!0,a&&f.add(h),I&&w.add(b),(a||I)&&o.set(A,_)}}if(f.size){const g=[];f.forEach(m=>{let S=0;i.forEach(h=>{const b=o.get(c(m,h));b&&(S=z(S,b[0]))}),S&&g.push([m,S])}),e._update(k,g)}if(w.size){const g=[];w.forEach(m=>{let S=0;l.forEach(h=>{const b=o.get(c(h,m));b&&(S=z(S,b[1]))}),S&&g.push([m,S])}),t._update(k,g)}}));return{_observeRoot(d){s=d;const f=p();return f.observe(d,me),()=>{f.disconnect()}},_observeItem(d,f,w){const g=p();return u.set(d,[f,w]),l.add(f),i.add(w),g.observe(d),()=>{u.delete(d),g.unobserve(d)}}}},ne=L.forwardRef(({children:e,attrs:t,width:s,height:r,scrolling:n},u)=>Q("div",{ref:u,...t,children:Q("div",{style:L.useMemo(()=>({position:"relative",visibility:"hidden",width:s??"100%",height:r??"100%",pointerEvents:n?"none":"auto"}),[s,r,n]),children:e})}));try{ne.displayName="Viewport",ne.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{ze as A,U as S,ee as U,ne as V,Pe as a,De as b,de as c,Ae as d,K as e,Me as f,Ne as g,Je as h,We as i,G as j,se as k,te as l,Ve as m,ke as n,qe as o,Ue as p,Ee as q,P as r,Ke as s,ye as u,xe as v};
//# sourceMappingURL=Viewport-1944a604.js.map
