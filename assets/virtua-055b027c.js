import{j as J}from"./jsx-runtime-f8a6c6ea.js";import{r as m}from"./index-5284b0bf.js";import{r as le}from"./index-480187bb.js";const j=Math.min,T=Math.max,ie=Math.abs,Y=Date.now,ce=Object.values,te=setTimeout,q=e=>e!=null,$=(e,t)=>Array.from({length:e},(r,n)=>t(n)),ue=(e,t)=>{let r;const n=()=>{q(r)&&clearTimeout(r)},o=()=>{n(),r=te(()=>{r=null,e()},t)};return o.t=n,o},re=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},H=-1,O=(e,t)=>{const r=e.o[t];return r===H?e.i:r},ne=(e,t,r)=>{if(!e.l)return 0;if(e.u>=t)return r?e.h[t]+O(e,t):e.h[t];let n=e.u,o=e.h[n];for(;n<=t&&(e.h[n]=o,n!==t||r);)o+=O(e,n),n++;return e.u=t,o},G=(e,t)=>ne(e,t),oe=(e,t,r)=>{let n=0;if(r>=0)for(;t<e.l-1;){const o=O(e,t++);if((n+=o)>=r){n-o/2>=r&&t--;break}}else for(;t>0;){const o=O(e,--t);if((n-=o)<=r){n+o/2<r&&t++;break}}return j(T(t,0),e.l-1)},U=(e,t,r,n)=>oe(e,r,t-n),Z=(e,t,r)=>({i:r?r.i:t,l:e,u:r?j(r.u,e-1):0,o:$(e,n=>{const o=r&&r.o[n];return q(o)?o:H}),h:$(e,n=>{if(n===0)return 0;const o=r&&r.h[n];return q(o)?o:H})}),K=e=>e.reduce((t,[r])=>t+r,0),Q=(e,t)=>t.map(([r,n])=>[n-O(e,r),r]),ae=(e,t,r=0,n,o,c)=>{const i=!t,u=t||40;let l,p,f=u*T(r-1,0),v=0,C=0,h=Z(e,u),b=0,z=!1,V=[0,r];const W=new Set,A=()=>(s=>ne(s,s.l-1,!0))(h),E=()=>A()-f,B=s=>{const a=b;return b=s,b!==0&&(a===0&&(b===1||b===2)||void 0)};return{_(){const[s,a]=V,L=G(h,s),g=U(h,v,s,L),R=oe(h,g,f);return s===g&&a===R?V:V=[g,R]},g:s=>h.o[s]===H,m:s=>((a,L,g)=>{for(let R=L;R<=g;R++)if(a.o[R]===H)return!0;return!1})(h,T(0,s-2),j(h.l-1,s+2)),v(s){const a=G(h,s);return n?a+T(0,f-A()):a},p:s=>O(h,s),S:()=>h.l,I:()=>v,R:E,k:()=>f,O:A,T:()=>T(A(),f),C:()=>C,M(){const s=l;return l=void 0,s},H:s=>U(h,s,0,0),W:()=>(p&&p[1](),new Promise((s,a)=>{let L=!1;const g=()=>{L||(L=!0,s(),p=void 0)};p=[g,a],te(g,250)})),L:s=>(W.add(s),()=>{W.delete(s)}),J(s,a){let L,g,R=!1;switch(s){case 1:{const M=a.filter(([k,x])=>h.o[k]!==x);if(!M.length)break;let _=0;if(b===2)_=K(Q(h,M));else if(b===3){const k=Q(h,M),[x]=V;v===0||(_=v>E()-1.5?K(k):K(k.filter(([,I])=>I<x)))}_&&(l=_,C++);let N=!1;M.forEach(([k,x])=>{((I,d,y)=>{const w=I.o[d]===H;return I.o[d]=y,I.u=j(d,I.u),w})(h,k,x)&&(N=!0)}),i&&N&&!v&&(k=>{const x=k.o.filter(d=>d!==H),I=x[0];k.i=x.every(d=>d===I)?I:(d=>{const y=[...d].sort((D,se)=>D-se),w=d.length/2|0;return y.length%2==0?(y[w-1]+y[w])/2:y[w]})(x)})(h),z=L=R=!0;break}case 2:R=f!==a,f=a;break;case 3:case 4:if(v===a)break;if(s===3){const M=(()=>{const _=z;return z=!1,_})();b!==0&&M||b===3||(g=B(v>a?2:1)),L=ie(v-a)>f}v=a,R=!0;break;case 5:g=B(a?3:0)}R&&(W.forEach(M=>{M(L)}),s===3&&c(v)),p&&s===1&&p[0](),q(g)&&o(g)},$:()=>b,D(s){h.l!==s&&(h=Z(s,u,h))}}},F=typeof window<"u"?m.useLayoutEffect:m.useEffect,S="current",de=e=>{const t=[];return m.Children.forEach(e,r=>{q(r)&&typeof r!="boolean"&&t.push(r)}),t},P=e=>{const t=m.useRef(e);return F(()=>{t[S]=e},[e]),t},X=(e,t,r)=>{const[n,o]=m.useState(t),c=P(t);if(m.useLayoutEffect(()=>{const i=()=>{o(()=>c[S]())};return e.L(u=>{u?le.flushSync(i):i()})},[]),r){const i=t();n!==i&&o(i)}return n},fe=re(e=>{const t="scrollLeft",r=e[t];e[t]=1;const n=e[t]<1;return e[t]=r,n}),he=(e,t,r)=>(()=>{let n=Y()-50;return(...o)=>{const c=Y();n+50<c&&(n=c,(i=>{if(e.$()!==0&&!i.ctrlKey&&(t?i.deltaX:i.deltaY)){const u=e.I();u>0&&u<e.R()&&r()}})(...o))}})(),me=(e,t,r)=>{let n;const o=t?"scrollLeft":"scrollTop",c=()=>n?t?n.scrollWidth:n.scrollHeight:0,i=(l,p)=>t&&r?fe(n)||p?-l:e.R()-l:l,u=async(l,p)=>{if(!n)return;const f=()=>j(p(),c()-e.k());for(;e.J(4,f()),e.m(l);)try{await e.W()}catch{return}n[o]=i(f()),e.J(5,!0)};return{j(l){n=l;const p=()=>{e.J(3,i(l[o]))},f=ue(()=>{p(),e.J(5,!1)},150),v=()=>{p(),f()},C=he(e,t,f);return l.addEventListener("scroll",v),l.addEventListener("wheel",C,{passive:!0}),()=>{l.removeEventListener("scroll",v),l.removeEventListener("wheel",C),f.t()}},A:c,B(l){l=T(l,0),u(e.H(l),()=>l)},F(l){l=T(j(l,e.S()-1),0),u(l,()=>e.v(l))},U:l=>{n&&(n[o]+=i(l,!0))}}},pe=e=>{const t=m.useRef();return t[S]||(t[S]=e())},ve=(e,t)=>{let r;const n=t?"width":"height",o=new WeakMap,c=re(()=>new ResizeObserver(i=>{const u=[];for(const{target:l,contentRect:p}of i)if(l===r)e.J(2,p[n]);else{const f=o.get(l);q(f)&&u.push([f,p[n]])}u.length&&e.J(1,u)}));return{P(i){r=i;const u=c();return u.observe(i),()=>{u.disconnect()}},V(i,u){const l=c();return o.set(i,u),l.observe(i),()=>{o.delete(i),l.unobserve(i)}}}},ge=m.forwardRef(({children:e,attrs:t,width:r,height:n,scrolling:o},c)=>J("div",{ref:c,...t,children:J("div",{style:m.useMemo(()=>({position:"relative",visibility:"hidden",width:r??"100%",height:n??"100%",pointerEvents:o?"none":"auto"}),[r,n,o]),children:e})})),ye=m.memo(({X:e,Y:t,q:r,G:n,K:o,N:c,Z:i})=>{const u=m.useRef(null),l=X(r,()=>r.v(n),!0),p=X(r,()=>r.g(n),!0);return F(()=>t.V(u[S],n),[n]),J(o,{ref:u,style:m.useMemo(()=>{const f=i?"right":"left",v={margin:0,padding:0,position:"absolute",[c?"height":"width"]:"100%",[c?"top":f]:0,[c?f:"top"]:l,visibility:p?"hidden":"visible"};return c&&(v.display="flex"),v},[l,p]),children:e})}),we=m.forwardRef(({children:e,overscan:t=4,initialItemSize:r,initialItemCount:n,horizontal:o,mode:c,element:i=ge,itemElement:u="div",onScroll:l,onScrollStop:p,onRangeChange:f,...v},C)=>{const h=m.useMemo(()=>de(e),[e]),b=h.length,z=P(l),V=P(p),[W,A]=m.useState(!1),[E,B,s,a,L]=pe(()=>{const d=!!o,y=c==="rtl",w=ae(b,r,n,c==="reverse",D=>{A(D),D||V[S]&&V[S]()},D=>{z[S]&&z[S](D)});return[w,ve(w,d),me(w,d,y),d,y]});E.D(b);const[g,R]=X(E,E._),M=X(E,E.C),_=X(E,E.T,!0),N=m.useRef(null);F(()=>{const d=N[S],y=B.P(d),w=s.j(d);return()=>{y(),w()}},[]),F(()=>{const d=E.M();d&&s.U(d)},[M]),m.useEffect(()=>{f&&f({start:g,end:R,count:b})},[g,R]),m.useImperativeHandle(C,()=>({get scrollOffset(){return E.I()},get scrollSize(){return s.A()},get viewportSize(){return E.k()},scrollToIndex:s.F,scrollTo:s.B,scrollBy(d){s.B(E.I()+d)}}),[]);const k=T(g-t,0),x=j(R+t,b-1),I=m.useMemo(()=>{const d=[];for(let y=k;y<=x;y++){const w=h[y];q(w)&&d.push(J(ye,{Y:B,q:E,G:y,K:u,X:w,N:a,Z:L},(w==null?void 0:w.key)||y))}return d},[h,k,x]);return J(i,{ref:N,width:a?_:void 0,height:a?void 0:_,scrolling:W,attrs:m.useMemo(()=>({...v,style:{overflow:a?"auto hidden":"hidden auto",display:a?"inline-block":"block",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...v.style}}),ce(v)),children:I})}),ee=m.memo(({count:e,Component:t,handle:r})=>{const n=m.useRef(null);return m.useImperativeHandle(r,()=>({scrollToIndex:o=>{var c;(c=n.current)==null||c.scrollToIndex(o)}})),J(we,{ref:n,children:Array.from({length:e}).map((o,c)=>J(t,{index:c},c))})});try{ee.displayName="VirtuaList",ee.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ee as V};
//# sourceMappingURL=virtua-055b027c.js.map
