import{j as A}from"./jsx-runtime-f8a6c6ea.js";import{r as p}from"./index-5284b0bf.js";import{r as se}from"./index-480187bb.js";const O=Math.min,D=Math.max,ie=Math.abs,G=Date.now,ee=setTimeout,z=e=>e!=null,J=(e,t)=>Array.from({length:e},(n,r)=>t(r)),te=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},N=-1,P=(e,t)=>{const n=e.t[t];return n===N?e.o:n},ne=(e,t,n)=>{if(!e.l)return 0;if(e.i>=t)return n?e.u[t]+P(e,t):e.u[t];let r=e.i,s=e.u[r];for(;r<=t&&(e.u[r]=s,r!==t||n);)s+=P(e,r),r++;return e.i=t,s},U=(e,t)=>ne(e,t),re=(e,t,n)=>{let r=0;if(n>=0)for(;t<e.l-1;){const s=P(e,t++);if((r+=s)>=n){r-s/2>=n&&t--;break}}else for(;t>0;){const s=P(e,--t);if((r-=s)<=n){r+s/2<n&&t++;break}}return O(D(t,0),e.l-1)},Y=(e,t,n,r)=>re(e,n,t-r),$=(e,t,n)=>({o:n?n.o:t,l:e,i:n?O(n.i,e-1):0,t:J(e,r=>{const s=n&&n.t[r];return z(s)?s:N}),u:J(e,r=>{if(r===0)return 0;const s=n&&n.u[r];return z(s)?s:N})}),B=e=>e.reduce((t,[n])=>t+n,0),Z=(e,t)=>t.map(([n,r])=>[r-P(e,n),n]),le=(e,t,n=0,r,s,u)=>{const d=!t,m=t||40;let w,o,a=m*D(n-1,0),v=0,x=0,f=$(e,m),l=0,k=!1,R=[0,n];const C=new Set,V=()=>(i=>ne(i,i.l-1,!0))(f),L=i=>{const h=l;return l=i,l!==0&&(h===0&&(l===1||l===2)||void 0)};return{_(){const[i,h]=R,S=U(f,i),b=Y(f,v,i,S),E=re(f,b,a);return i===b&&h===E?R:R=[b,E]},h:i=>f.t[i]===N,g:i=>((h,S,b)=>{for(let E=S;E<=b;E++)if(h.t[E]===N)return!0;return!1})(f,D(0,i-2),O(f.l-1,i+2)),m(i){const h=U(f,i);return r?h+D(0,a-V()):h},v:i=>P(f,i),S:()=>v,p:()=>a,I:()=>V(),R:()=>D(V(),a),T:()=>x,k(){const i=w;return w=void 0,i},M:i=>Y(f,i,0,0),C:()=>(o&&o[1](),new Promise((i,h)=>{let S=!1;const b=()=>{S||(S=!0,i(),o=void 0)};o=[b,h],ee(b,250)})),O:i=>(C.add(i),()=>{C.delete(i)}),H(i,h){let S,b,E=!1;switch(i){case 1:{const H=h.filter(([I,M])=>f.t[I]!==M);if(!H.length)break;let q=0;if(l===2)q=B(Z(f,H));else if(l===3){const I=Z(f,H),[M]=R;v===0||(q=V()<=v+a?B(I):B(I.filter(([,_])=>_<M)))}q&&(w=q,x++);let j=!1;H.forEach(([I,M])=>{((_,c,g)=>{const y=_.t[c]===N;return _.t[c]=g,_.i=O(c,_.i),y})(f,I,M)&&(j=!0)}),d&&j&&!v&&(I=>{const M=I.t.filter(c=>c!==N),_=M[0];I.o=M.every(c=>c===_)?_:(c=>{const g=[...c].sort((K,oe)=>K-oe),y=c.length/2|0;return g.length%2==0?(g[y-1]+g[y])/2:g[y]})(M)})(f),k=S=E=!0;break}case 2:E=a!==h,a=h;break;case 3:case 4:if(v===h)break;if(i===3){const H=(()=>{const q=k;return k=!1,q})();l!==0&&H||l===3||(b=L(v>h?2:1)),S=ie(v-h)>a}v=h,E=!0;break;case 5:b=L(h?3:0)}E&&(C.forEach(H=>{H(S)}),i===3&&u(v)),o&&i===1&&o[0](),z(b)&&s(b)},D:()=>l,W(i){f.l!==i&&(f=$(i,m,f))}}},W=typeof window<"u"?p.useLayoutEffect:p.useEffect,T="current",X=e=>{const t=p.useRef(e);return W(()=>{t[T]=e},[e]),t},F=(e,t,n)=>{const[r,s]=p.useState(t),u=X(t);if(p.useLayoutEffect(()=>{const d=()=>{s(()=>u[T]())};return e.O(m=>{m?se.flushSync(d):d()})},[]),n){const d=t();r!==d&&s(d)}return r},ce=te(e=>{const t="scrollLeft",n=e[t];e[t]=1;const r=e[t]<1;return e[t]=n,r}),ue=(e,t,n)=>{let r;const s=t?"scrollLeft":"scrollTop",u=()=>r?t?r.scrollWidth:r.scrollHeight:0,d=(o,a)=>ce(r)||a?-o:e.I()-e.p()-o,m=(o,a)=>{r&&(t&&n&&(o=d(o,a)),a?r[s]+=o:r[s]=o)},w=async(o,a)=>{const v=()=>{let x=a();const f=u(),l=e.p();return f-(x+l)<=0&&(x=f-l),x};for(;e.H(4,v()),e.g(o);)try{await e.C()}catch{return}m(v()),e.H(5,!0)};return{$(o){r=o;const a=()=>{let l=o[s];t&&n&&(l=d(l)),e.H(3,l)},v=(()=>{let l;const k=()=>{z(l)&&clearTimeout(l)},R=()=>{k(),l=ee(()=>{l=null,a(),e.H(5,!1)},150)};return R.J=k,R})(),x=()=>{a(),v()},f=(()=>{let l=G()-50;return(...k)=>{const R=G();l+50<R&&(l=R,(C=>{if(e.D()!==0&&!C.ctrlKey&&(t?C.deltaX:C.deltaY)){const V=e.S();V>0&&V<e.I()-e.p()&&v()}})(...k))}})();return o.addEventListener("scroll",x),o.addEventListener("wheel",f,{passive:!0}),()=>{o.removeEventListener("scroll",x),o.removeEventListener("wheel",f),v.J()}},L:u,A(o){o=D(o,0),w(e.M(o),()=>o)},B(o,a){o=D(O(o,a-1),0),w(o,()=>e.m(o))},F:o=>{m(o,!0)}}},ae=e=>{const t=p.useRef();return t[T]||(t[T]=e())},de=(e,t)=>{let n;const r=t?"width":"height",s=new WeakMap,u=te(()=>new ResizeObserver(d=>{const m=[];for(const{target:w,contentRect:o}of d)if(w===n)e.H(2,o[r]);else{const a=s.get(w);z(a)&&m.push([a,o[r]])}m.length&&e.H(1,m)}));return{U(d){n=d;const m=u();return m.observe(d),()=>{m.disconnect()}},j(d,m){const w=u();return s.set(d,m),w.observe(d),()=>{s.delete(d),w.unobserve(d)}}}},fe=p.forwardRef(({children:e,attrs:t,width:n,height:r,scrolling:s},u)=>A("div",{ref:u,...t,children:A("div",{style:p.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:r??"100%",pointerEvents:s?"none":"auto"}),[n,r,s]),children:e})})),he=p.memo(({P:e,V:t,q:n,G:r,K:s,N:u,X:d})=>{const m=p.useRef(null),w=F(n,()=>n.m(r),!0),o=F(n,()=>n.h(r),!0);return W(()=>t.j(m[T],r),[r]),A(s,{ref:m,style:p.useMemo(()=>{const a=d?"right":"left",v={margin:0,padding:0,position:"absolute",[u?"height":"width"]:"100%",[u?"top":a]:0,[u?a:"top"]:w,visibility:o?"hidden":"visible"};return u&&(v.display="flex"),v},[w,o]),children:e})}),me=({P:e,Y:t,q:n,K:r,Z:s,ee:u,N:d})=>{const m=F(n,n.I);return A(r,{ref:t,width:d?m:void 0,height:d?void 0:m,scrolling:s,attrs:p.useMemo(()=>({...u,style:{overflow:d?"auto hidden":"hidden auto",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...u.style}}),[u]),children:e})},pe=p.forwardRef(({children:e,overscan:t=4,initialItemSize:n,initialItemCount:r,horizontal:s,mode:u,element:d=fe,itemElement:m="div",onScroll:w,onScrollStop:o,onRangeChange:a,...v},x)=>{const f=p.useMemo(()=>{const c=[];return p.Children.forEach(e,g=>{(y=>!z(y)||typeof y=="boolean")(g)||c.push(g)}),c},[e]),l=f.length,k=X(w),R=X(o),[C,V]=p.useState(!1),[L,i,h,S,b]=ae(()=>{const c=!!s,g=u==="rtl",y=le(l,n,r,u==="reverse",K=>{V(K),K||R[T]&&R[T]()},K=>{k[T]&&k[T](K)});return[y,de(y,c),ue(y,c,g),c,g]});L.W(l);const[E,H]=F(L,L._),q=F(L,L.T),j=p.useRef(null);W(()=>{const c=j[T],g=i.U(c),y=h.$(c);return()=>{g(),y()}},[]),W(()=>{const c=L.k();c&&h.F(c)},[q]),p.useEffect(()=>{a&&a({start:E,end:H,count:l})},[E,H]),p.useImperativeHandle(x,()=>({get scrollOffset(){return L.S()},get scrollSize(){return h.L()},get viewportSize(){return L.p()},scrollToIndex(c){h.B(c,l)},scrollTo:h.A,scrollBy(c){h.A(L.S()+c)}}),[l]);const I=D(E-t,0),M=O(H+t,l-1),_=p.useMemo(()=>{const c=[];for(let g=I;g<=M;g++){const y=f[g];z(y)&&c.push(A(he,{V:i,q:L,G:g,K:m,P:y,N:S,X:b},(y==null?void 0:y.key)||g))}return c},[f,I,M]);return A(me,{Y:j,q:L,K:d,Z:C,P:_,ee:v,N:S})}),Q=p.memo(({count:e,Component:t,handle:n})=>{const r=p.useRef(null);return p.useImperativeHandle(n,()=>({scrollToIndex:s=>{var u;(u=r.current)==null||u.scrollToIndex(s)}})),A(pe,{ref:r,children:Array.from({length:e}).map((s,u)=>A(t,{index:u},u))})});try{Q.displayName="VirtuaList",Q.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{Q as V};
//# sourceMappingURL=virtua-0f2acbc7.js.map
