import{j}from"./jsx-runtime-f8a6c6ea.js";import{r as m}from"./index-5284b0bf.js";import{r as le}from"./index-480187bb.js";const H=Math.min,C=Math.max,ie=Math.abs,G=Date.now,ce=Object.values,te=setTimeout,q=e=>e!=null,ue=(e,t)=>{let r;const n=()=>{q(r)&&clearTimeout(r)},o=()=>{n(),r=te(()=>{r=null,e()},t)};return o.t=n,o},re=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},W=-1,A=(e,t)=>{const r=e.o[t];return r===W?e.i:r},ne=(e,t,r)=>{if(!e.l)return 0;if(e.u>=t)return r?e.h[t]+A(e,t):e.h[t];let n=e.u,o=e.h[n];for(;n<=t&&(e.h[n]=o,n!==t||r);)o+=A(e,n),n++;return e.u=t,o},U=(e,t)=>ne(e,t),oe=(e,t,r)=>{let n=0;if(r>=0)for(;t<e.l-1;){const o=A(e,t++);if((n+=o)>=r){n-o/2>=r&&t--;break}}else for(;t>0;){const o=A(e,--t);if((n-=o)<=r){n+o/2<r&&t++;break}}return H(C(t,0),e.l-1)},Z=(e,t,r,n)=>oe(e,r,t-n),$=(e,t,r)=>{const n=[],o=[];for(let i=0;i<e;i++){const c=r&&r.o[i];if(n.push(q(c)?c:W),i===0)o.push(0);else{const u=r&&r.h[i];o.push(q(u)?u:W)}}return{i:r?r.i:t,l:e,u:r?H(r.u,e-1):0,o:n,h:o}},X=e=>e.reduce((t,[r])=>t+r,0),Q=(e,t)=>t.map(([r,n])=>[n-A(e,r),r]),ae=(e,t,r=0,n,o,i,c)=>{var u;const g=!t,l=t||40;let h=l*C(r-1,0),p=0,x=0,S=0,a=(u=i)!==null&&u!==void 0?u:$(e,l),v=0,V=!1,N=[0,r];const P=new Set,D=()=>(s=>ne(s,s.l-1,!0))(a),y=()=>D()-h,z=s=>{const d=v;return v=s,v!==0&&(d===0&&(v===1||v===2)||void 0)};return{_:()=>JSON.parse(JSON.stringify(a)),g(){const[s,d]=N,R=U(a,s),E=Z(a,p,s,R),w=oe(a,E,h);return s===E&&d===w?N:N=[E,w]},m:s=>a.o[s]===W,v:s=>((d,R,E)=>{for(let w=R;w<=E;w++)if(d.o[w]===W)return!0;return!1})(a,C(0,s-2),H(a.l-1,s+2)),p(s){const d=U(a,s);return n?d+C(0,h-D()):d},S:s=>A(a,s),I:()=>a.l,R:()=>p,k:y,O:()=>h,C:D,T:()=>C(D(),h),M:()=>x,H(){const s=S;return S=0,s},J:s=>Z(a,s,0,0),W(s,d){const R=[s,d];return P.add(R),()=>{P.delete(R)}},L(s,d){let R,E,w=0;switch(s){case 1:{const I=d.filter(([k,M])=>a.o[k]!==M);if(!I.length)break;let T=0;if(v===2)T=X(Q(a,I));else if(v===3){const k=Q(a,I),[M]=N;p===0||(T=p>y()-1.5?X(k):X(k.filter(([,_])=>_<M)))}T&&(S=T,x++,w+=4);let B=!1;I.forEach(([k,M])=>{((_,f,b)=>{const L=_.o[f]===W;return _.o[f]=b,_.u=H(f,_.u),L})(a,k,M)&&(B=!0)}),g&&B&&!p&&(k=>{const M=k.o.filter(f=>f!==W),_=M[0];k.i=M.every(f=>f===_)?_:(f=>{const b=[...f].sort((J,se)=>J-se),L=f.length/2|0;return b.length%2==0?(b[L-1]+b[L])/2:b[L]})(M)})(a),w+=2,V=R=!0;break}case 2:h!==d&&(h=d,w=2);break;case 3:case 4:if(p===d)break;if(s===3){const I=(()=>{const T=V;return V=!1,T})();v!==0&&I||v===3||(E=z(p>d?2:1)),R=ie(p-d)>h}p=C(0,H(y(),d)),w=1;break;case 5:E=z(d?3:0)}w&&(P.forEach(([I,T])=>{w&I&&T(R)}),s===3&&c&&c(p)),q(E)&&o(E)},$:()=>v,j(s){a.l!==s&&(a=$(s,l,a))}}},K=typeof window<"u"?m.useLayoutEffect:m.useEffect,O="current",de=e=>{const t=[];return m.Children.forEach(e,r=>{q(r)&&typeof r!="boolean"&&t.push(r)}),t},Y=e=>{const t=m.useRef(e);return K(()=>{t[O]=e},[e]),t},F=(e,t,r)=>{const[n,o]=m.useState(t),i=Y(t);if(m.useLayoutEffect(()=>{let c;c=t===e.g?3:t===e.T?2:t===e.M?4:2;const u=()=>{o(()=>i[O]())};return e.W(c,g=>{g?le.flushSync(u):u()})},[]),r){const c=t();n!==c&&o(c)}return n},fe=re(e=>{const t="scrollLeft",r=e[t];e[t]=1;const n=e[t]<1;return e[t]=r,n}),he=(e,t,r)=>(()=>{let n=G()-50;return(...o)=>{const i=G();n+50<i&&(n=i,(c=>{if(e.$()!==0&&!c.ctrlKey&&(t?c.deltaX:c.deltaY)){const u=e.R();u>0&&u<e.k()&&r()}})(...o))}})(),pe=(e,t,r)=>{let n,o;const i=t?"scrollLeft":"scrollTop",c=()=>n?t?n.scrollWidth:n.scrollHeight:0,u=(l,h)=>t&&r?fe(n)||h?-l:e.k()-l:l,g=async(l,h)=>{if(!n)return;const p=()=>H(h(),c()-e.O());for(;e.L(4,p()),e.v(l);){o&&o[1]();const x=e.W(2,()=>{o&&o[0]()});try{await new Promise((S,a)=>{let v=!1;const V=()=>{v||(v=!0,S(),o=void 0)};o=[V,a],te(V,250)})}catch{return}finally{x()}}n[i]=u(p()),e.L(5,!0)};return{B(l){n=l;const h=()=>{e.L(3,u(l[i]))},p=ue(()=>{h(),e.L(5,!1)},150),x=()=>{h(),p()},S=he(e,t,p);return l.addEventListener("scroll",x),l.addEventListener("wheel",S,{passive:!0}),()=>{l.removeEventListener("scroll",x),l.removeEventListener("wheel",S),p.t()}},D:c,N(l){l=C(l,0),g(e.J(l),()=>l)},U(l){l=C(H(l,e.I()-1),0),g(l,()=>e.p(l))},A:l=>{n&&(n[i]+=u(l,!0))}}},me=e=>{const t=m.useRef();return t[O]||(t[O]=e())},ve=(e,t)=>{let r;const n=t?"width":"height",o=new WeakMap,i=re(()=>new ResizeObserver(c=>{const u=[];for(const{target:g,contentRect:l}of c)if(g===r)e.L(2,l[n]);else{const h=o.get(g);q(h)&&u.push([h,l[n]])}u.length&&e.L(1,u)}));return{F(c){r=c;const u=i();return u.observe(c),()=>{u.disconnect()}},P(c,u){const g=i();return o.set(c,u),g.observe(c),()=>{o.delete(c),g.unobserve(c)}}}},ge=m.forwardRef(({children:e,attrs:t,width:r,height:n,scrolling:o},i)=>j("div",{ref:i,...t,children:j("div",{style:m.useMemo(()=>({position:"relative",visibility:"hidden",width:r??"100%",height:n??"100%",pointerEvents:o?"none":"auto"}),[r,n,o]),children:e})})),ye=m.memo(({V:e,X:t,Y:r,q:n,G:o,K:i,Z:c})=>{const u=m.useRef(null),g=F(r,()=>r.p(n),!0),l=F(r,()=>r.m(n),!0);return K(()=>t.P(u[O],n),[n]),j(o,{ref:u,style:m.useMemo(()=>{const h=c?"right":"left",p={margin:0,padding:0,position:"absolute",[i?"height":"width"]:"100%",[i?"top":h]:0,[i?h:"top"]:g,visibility:l?"hidden":"visible"};return i&&(p.display="flex"),p},[g,l]),children:e})}),we=m.forwardRef(({children:e,overscan:t=4,initialItemSize:r,initialItemCount:n,horizontal:o,mode:i,cache:c,element:u=ge,itemElement:g="div",onScroll:l,onScrollStop:h,onRangeChange:p,...x},S)=>{const a=m.useMemo(()=>de(e),[e]),v=a.length,V=Y(l),N=Y(h),[P,D]=m.useState(!1),[y,z,s,d,R]=me(()=>{const f=!!o,b=i==="rtl",L=ae(v,r,n,i==="reverse",J=>{D(J),J||N[O]&&N[O]()},c,J=>{V[O]&&V[O](J)});return[L,ve(L,f),pe(L,f,b),f,b]});y.j(v);const[E,w]=F(y,y.g),I=F(y,y.M),T=F(y,y.T,!0),B=m.useRef(null);K(()=>{const f=B[O],b=z.F(f),L=s.B(f);return()=>{b(),L()}},[]),K(()=>{const f=y.H();f&&s.A(f)},[I]),m.useEffect(()=>{p&&p({start:E,end:w,count:v})},[E,w]),m.useImperativeHandle(S,()=>({get cache(){return y._()},get scrollOffset(){return y.R()},get scrollSize(){return s.D()},get viewportSize(){return y.O()},scrollToIndex:s.U,scrollTo:s.N,scrollBy(f){s.N(y.R()+f)}}),[]);const k=C(E-t,0),M=H(w+t,v-1),_=m.useMemo(()=>{const f=[];for(let b=k;b<=M;b++){const L=a[b];q(L)&&f.push(j(ye,{X:z,Y:y,q:b,G:g,V:L,K:d,Z:R},L.key||b))}return f},[a,k,M]);return j(u,{ref:B,width:d?T:void 0,height:d?void 0:T,scrolling:P,attrs:m.useMemo(()=>({...x,style:{overflow:d?"auto hidden":"hidden auto",display:d?"inline-block":"block",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...x.style}}),ce(x)),children:_})}),ee=m.memo(({count:e,Component:t,handle:r})=>{const n=m.useRef(null);return m.useImperativeHandle(r,()=>({scrollToIndex:o=>{var i;(i=n.current)==null||i.scrollToIndex(o)}})),j(we,{ref:n,children:Array.from({length:e}).map((o,i)=>j(t,{index:i},i))})});try{ee.displayName="VirtuaList",ee.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ee as V};
//# sourceMappingURL=virtua-b1a9d4ec.js.map
