import{a as $}from"./jsx-runtime-sgeEVxPu.js";import{r as R}from"./index-yp3VsGQP.js";import{r as pe}from"./index-8dy-jdxy.js";const B=Math.min,I=Math.max,oe=Math.abs,ve=Array.isArray,ee=setTimeout,ne=(e,t,n)=>B(n,I(t,e)),Z=e=>e!=null,re=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},H=-1,G=(e,t,n)=>{const r=n?"unshift":"push";for(let s=0;s<t;s++)e[r](H);return e},W=(e,t)=>{const n=e.t[t];return n===H?e.o:n},te=(e,t)=>{if(!e.i)return 0;if(e.l>=t)return e.h[t];e.l<0&&(e.h[0]=0,e.l=0);let n=e.l,r=e.h[n];for(;n<t;)r+=W(e,n),e.h[++n]=r;return e.l=t,r},se=(e,t,n)=>{let r=te(e,n);for(;n>=0&&n<e.i;)if(r<=t){const s=W(e,n);if(r+s>t)break;r+=s,n++}else r-=W(e,--n);return ne(n,0,e.i-1)},ie=(e,t,n,r)=>{const s=se(e,t,B(n,e.i-1));return[s,se(e,t+r,s)]},le=(e,t,n)=>{const r=t-e.i,s=r>0;let i;return s?(i=e.o*r,G(e.t,r,n),G(e.h,r)):(i=(n?e.t.splice(0,-r):e.t.splice(r)).reduce((c,u)=>c+(u===H?e.o:u),0),e.h.splice(r)),e.l=n?-1:B(t-1,e.l),e.i=t,[i,s]},ue=typeof window<"u",fe=()=>document.documentElement,ge=e=>e.ownerDocument,ye=e=>e.defaultView,de=re(()=>!!ue&&getComputedStyle(fe()).direction==="rtl"),he=re(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),we=re(()=>"scrollBehavior"in fe().style),Re=e=>I(e.u(),e._()),be=(e,t,n)=>I(e-(n===1?1:I(1,t)),0),Ee=(e,t,n,r)=>B(e+(n===2?1:I(1,t)),r-1),Q=(e,t,n)=>t.reduce((r,[s,i])=>{const c=i-W(e,s);return(!n||c>0)&&(r+=c),r},0),Le=(e,t=40,n=0,r,s,i=0,c=0)=>{let u=!!n,o=[],l=0,a=0,d=0,m=0,w=0,T=0,x=0,g=0,b=u?[0,I(n-1,0)]:null,M=[0,0];const p=r||((h,y)=>({o:y,i:h,l:-1,t:G([],h),h:G([],h)}))(e,t),D=new Set,X=()=>(h=>h.i?te(h,h.i-1)+W(h,h.i-1):0)(p),Y=()=>X()+i+c,N=()=>I(0,Y()-l),v=h=>{he()&&x!==0?w+=h:(m+=h,d++)};return{p:()=>o,v:()=>JSON.parse(JSON.stringify(p)),m:()=>b?[B(M[0],b[0]),I(M[1],b[1])]:T?M:M=ie(p,a-i+w+m,M[0],l),S:h=>p.t[h]===H,I:()=>!!b&&p.t.slice(I(0,b[0]-1),B(p.i-1,b[1]+1)+1).includes(H),R:h=>te(p,h)-w,C:h=>W(p,h),k:()=>p.i,T:()=>a,M:()=>x,_:()=>l,O:()=>i,H:()=>c,u:X,J:()=>d,W:()=>l>Y()?m=0:(T=m,m=0,T),B(h,y){const O=[h,y];return D.add(O),()=>{D.delete(O)}},$(h,y){let O,q,k=0;switch(h){case 1:{const E=y.filter(([_,V])=>p.t[_]!==V);if(!E.length)break;let L=0;if(a!==0)if(a>N()-1.5)L=Q(p,E,!0);else if(g===2)L=Q(p,E);else{const[_]=M;L=Q(p,E.filter(([V])=>V<_))}L&&v(L);let P=!1;E.forEach(([_,V])=>{((A,S,f)=>{const C=A.t[S]===H;return A.t[S]=f,A.l=B(S,A.l),C})(p,_,V)&&(P=!0)}),s&&P&&!a&&(_=>{const V=_.t.filter(S=>S!==H),A=V[0];_.o=V.every(S=>S===A)?A:(S=>{const f=[...S].sort((J,j)=>J-j),C=S.length/2|0;return f.length%2==0?(f[C-1]+f[C])/2:f[C]})(V)})(p),k=2,q=!0;break}case 2:l!==y&&(l=y,k=2);break;case 3:if(y[1]){const E=N()-a,[L,P]=le(p,y[0],!0);v(P?L:-B(L,E)),P&&(g=2),k=1}else le(p,y[0]);break;case 4:{const E=ne(y,0,N()),L=T;if(T=0,E===a)break;const P=E-a,_=oe(P);L&&_<oe(L)+1||g!==0||(x=P<0?2:1),u&&(b=null,u=!1),q=_>l,a=E,k=5;break}case 5:k=8,x!==0&&(O=!0,k+=1),x=0,g=0,b=null;break;case 6:g=1;break;case 7:b=ie(p,y,M[0],l),k=1}k&&(o=[],O&&w&&(m+=w,w=0,d++),D.forEach(([E,L])=>{k&E&&L(q)}))}}},U=ue?R.useLayoutEffect:R.useEffect,K=(e,t)=>t&&de()?-e:e,_e=(e,t,n,r,s)=>{const i=Date.now;let c=0,u=!1,o=!1,l=!1,a=!1;const d=(()=>{let g;const b=()=>{Z(g)&&clearTimeout(g)},M=()=>{b(),g=ee(()=>{g=null,(()=>{if(u||o)return u=!1,void d();l=!1,e.$(5)})()},150)};return M.A=b,M})(),m=()=>{c=i(),l&&(a=!0),e.$(4,r()),d()},w=g=>{if(u||e.M()===0||g.ctrlKey)return;const b=i()-c;150>b&&50<b&&(n?g.deltaX:g.deltaY)&&(u=!0)},T=()=>{o=!0,l=a=!1},x=()=>{o=!1,he()&&(l=!0)};return t.addEventListener("scroll",m),t.addEventListener("wheel",w,{passive:!0}),t.addEventListener("touchstart",T,{passive:!0}),t.addEventListener("touchend",x,{passive:!0}),{L:()=>{t.removeEventListener("scroll",m),t.removeEventListener("wheel",w),t.removeEventListener("touchstart",T),t.removeEventListener("touchend",x),d.A()},P:g=>{s(g,a),a=!1}}},ke=(e,t)=>{let n,r,s;const i=t?"scrollLeft":"scrollTop",c=t?"overflowX":"overflowY",u=async(o,l)=>{if(!n)return;s&&s();const a=()=>{let d;return[new Promise((m,w)=>{d=m,ee(s=w,150)}),e.B(2,()=>{d&&d()})]};if(l&&we()){for(;e.$(7,o()),e.I();){const[d,m]=a();try{await d}catch{return}finally{m()}}n.scrollTo({[t?"left":"top"]:K(o(),t),behavior:"smooth"})}else for(;;){const[d,m]=a();try{n[i]=K(o(),t),e.$(6),await d}catch{return}finally{m()}}};return{V(o){n=o,r=_e(e,o,t,()=>K(o[i],t),(l,a)=>{if(a){const d=o.style,m=d[c];d[c]="hidden",ee(()=>{d[c]=m})}o[i]+=K(l,t)})},L(){r&&r.L()},X(o){u(()=>o)},Y(o){o+=e.T(),u(()=>o)},j(o,{align:l,smooth:a}={}){if(o=ne(o,0,e.k()-1),l==="nearest"){const d=e.R(o),m=e.T();if(d<m)l="start";else{if(!(d+e.C(o)>m+e._()))return;l="end"}}u(()=>e.O()+(l==="end"?e.R(o)+e.C(o)-e._():l==="center"?e.R(o)+(e.C(o)-e._())/2:e.R(o)),a)},P:o=>{r&&r.P(o)}}},z="current",me=(e,t)=>{if(ve(e))for(const n of e)me(n,t);else Z(e)&&typeof e!="boolean"&&t.push(e)},Se=(e,t)=>{const n=e.key;return Z(n)?n:"_"+t},Ce=e=>{const t=R.useRef();return t[z]||(t[z]=e())},ce=e=>{const t=R.useRef(e);return U(()=>{t[z]=e},[e]),t},Te=e=>{let t;return{V(n){(t||(t=new(ye(ge(n))).ResizeObserver(e))).observe(n)},D(n){t.unobserve(n)},L(){t&&t.disconnect()}}},xe=(e,t)=>{let n;const r=t?"width":"height",s=new WeakMap,i=Te(c=>{const u=[];for(const{target:o,contentRect:l}of c)if(o.offsetParent)if(o===n)e.$(2,l[r]);else{const a=s.get(o);Z(a)&&u.push([a,l[r]])}u.length&&e.$(1,u)});return{N(c){i.V(n=c)},U:(c,u)=>(s.set(c,u),i.V(c),()=>{s.delete(c),i.D(c)}),L:i.L}},Me=R.memo(({F:e,G:t,q:n,K:r,Z:s,ee:i,te:c,ne:u})=>{const o=R.useRef(null);U(()=>t(o[z],n),[n]);const l=R.useMemo(()=>{const a={margin:0,padding:0,position:s&&u?void 0:"absolute",[c?"height":"width"]:"100%",[c?"top":"left"]:0,[c?de()?"right":"left":"top"]:r,visibility:!s||u?"visible":"hidden"};return c&&(a.display="flex"),a},[r,s,u]);return $(i,typeof i=="string"?{ref:o,style:l,children:e}:{ref:o,style:l,index:n,children:e})}),Ve=e=>R.useReducer(e.p,void 0,e.p)[1],ze=(e,t)=>R.useMemo(()=>{if(typeof e=="function")return[e,t||0];const n=(r=>{const s=[];return me(r,s),s})(e);return[r=>n[r],n.length]},[e,t]),Ie=R.forwardRef(({children:e,count:t,overscan:n=4,itemSize:r,shift:s,horizontal:i,reverse:c,cache:u,startMargin:o,endMargin:l,ssrCount:a,as:d="div",item:m="div",scrollRef:w,onScroll:T,onScrollEnd:x,onRangeChange:g},b)=>{const[M,p]=ze(e,t),D=R.useRef(null),X=R.useRef(!!a),Y=ce(T),N=ce(x),[v,h,y,O]=Ce(()=>{const f=!!i,C=Le(p,r,a,u,!r,o,l);return[C,xe(C,f),ke(C,f),f]});p!==v.k()&&v.$(3,[p,s]);const q=Ve(v),[k,E]=v.m(),L=v.M(),P=v.J(),_=v.u(),V=(f=>I(f.u(),f._()-f.O()-f.H()))(v),A=c?I(0,V-_):0,S=[];U(()=>{X[z]=!1;const f=v.B(3,F=>{F?pe.flushSync(q):q()}),C=v.B(4,()=>{Y[z]&&Y[z](v.T())}),J=v.B(8,()=>{N[z]&&N[z]()}),j=F=>{h.N(F),y.V(F)};return w?Promise.resolve().then(()=>j(w[z])):j(D[z].parentElement),()=>{f(),C(),J(),h.L(),y.L()}},[]),U(()=>{const f=v.W();f&&y.P(f)},[P]),R.useEffect(()=>{g&&g(k,E)},[k,E]),R.useImperativeHandle(b,()=>({get cache(){return v.v()},get scrollOffset(){return v.T()},get scrollSize(){return Re(v)},get viewportSize(){return v._()},scrollToIndex:y.j,scrollTo:y.X,scrollBy:y.Y}),[]);for(let f=be(k,n,L),C=Ee(E,n,L,p);f<=C;f++){const J=M(f);S.push($(Me,{G:h.U,q:f,K:v.R(f)+A,Z:v.S(f),ee:m,F:J,te:O,ne:X[z]},Se(J,f)))}return $(d,{ref:D,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:O?_:"100%",height:O?"100%":_,[O?"minWidth":"minHeight"]:V,pointerEvents:L!==0?"none":"auto"},children:S})}),Oe=R.forwardRef(({children:e,count:t,overscan:n,itemSize:r,shift:s,horizontal:i,reverse:c,cache:u,ssrCount:o,item:l,onScroll:a,onScrollEnd:d,onRangeChange:m,style:w,...T},x)=>$("div",{...T,style:{display:i?"inline-block":"block",[i?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...w},children:$(Ie,{ref:x,count:t,overscan:n,itemSize:r,shift:s,horizontal:i,reverse:c,cache:u,ssrCount:o,item:l,onScroll:a,onScrollEnd:d,onRangeChange:m,children:e})})),ae=R.memo(({count:e,Component:t,handle:n})=>{const r=R.useRef(null);return R.useImperativeHandle(n,()=>({scrollToIndex:s=>{var i;(i=r.current)==null||i.scrollToIndex(s)}})),$(Oe,{ref:r,children:Array.from({length:e}).map((s,i)=>$(t,{index:i},i))})});try{ae.displayName="VirtuaList",ae.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ae as V};
