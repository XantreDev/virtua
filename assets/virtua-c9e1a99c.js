import{j as q}from"./jsx-runtime-c3d7f245.js";import{r as p}from"./index-c6dae603.js";import{r as re}from"./index-eb008d06.js";const z=Math.min,H=Math.max,ne=Math.abs,U=Date.now,oe=Object.values,G=setTimeout,A=e=>e!=null,se=(e,t)=>{let n;const r=()=>{A(n)&&clearTimeout(n)},s=()=>{r(),n=G(()=>{n=null,e()},t)};return s.t=r,s},Z=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},C=-1,F=(e,t)=>{const n=e.o[t];return n===C?e.i:n},Q=(e,t,n)=>{if(!e.l)return 0;if(e.u>=t)return n?e.h[t]+F(e,t):e.h[t];let r=e.u,s=e.h[r];for(;r<=t&&(e.h[r]=s,r!==t||n);)s+=F(e,r),r++;return e.u=t,s},X=(e,t)=>Q(e,t),ee=(e,t,n)=>{let r=0;if(n>=0)for(;t<e.l-1;){const s=F(e,t++);if((r+=s)>=n){r-s/2>=n&&t--;break}}else for(;t>0;){const s=F(e,--t);if((r-=s)<=n){r+s/2<n&&t++;break}}return z(H(t,0),e.l-1)},Y=(e,t,n,r)=>ee(e,n,t-r),K=(e,t)=>t.reduce((n,[r,s])=>n+(s-F(e,r)),0),le=(e,t,n=0,r,s)=>{const u=!t,d=t||40,o=s||((i,c)=>{const g=[],f=[];for(let a=0;a<i;a++)g.push(C),f.push(a===0?0:C);return{i:c,l:i,u:0,o:g,h:f}})(e,d);let h=d*H(n-1,0),l=0,y=0,w=0,b=0,k=!1,O=!1,_=[0,n];const V=new Set,N=()=>(i=>Q(i,i.l-1,!0))(o),m=()=>N()-h,J=i=>{const c=b;return b=i,b!==c&&(b===0||c===0)};return{_:()=>JSON.parse(JSON.stringify(o)),g(){const[i,c]=_,g=X(o,i),f=Y(o,l,i,g),a=ee(o,f,h);return i===f&&c===a?_:_=[f,a]},m:i=>o.o[i]===C,p:i=>((c,g,f)=>{for(let a=g;a<=f;a++)if(c.o[a]===C)return!0;return!1})(o,H(0,i-2),z(o.l-1,i+2)),v(i){const c=X(o,i);return r?c+H(0,h-N()):c},S:i=>F(o,i),I:()=>o.l,R:()=>l,k:m,O:()=>h,C:N,T:()=>H(N(),h),M:()=>y,H(){const i=w;return w=0,i},J:i=>Y(o,i,0,0),W(i,c){const g=[i,c];return V.add(g),()=>{V.delete(g)}},L(i,c){let g,f=0;switch(i){case 1:{const a=c.filter(([R,x])=>o.o[R]!==x);if(!a.length)break;let L=0;if(b===2)L=K(o,a);else if(k){const[R]=_;l===0||(L=l>m()-1.5?K(o,a):K(o,a.filter(([x])=>x<R)))}L&&(w=L,y++,f+=4);let j=!1;a.forEach(([R,x])=>{((S,E,W)=>{const v=S.o[E]===C;return S.o[E]=W,S.u=z(E,S.u),v})(o,R,x)&&(j=!0)}),u&&j&&!l&&(R=>{const x=R.o.filter(E=>E!==C),S=x[0];R.i=x.every(E=>E===S)?S:(E=>{const W=[...E].sort((M,I)=>M-I),v=E.length/2|0;return W.length%2==0?(W[v-1]+W[v])/2:W[v]})(x)})(o),f+=2,O=g=!0;break}case 2:h!==c&&(h=c,f=2);break;case 3:case 4:if(l===c)break;if(i===3){const a=O;O=!1,b!==0&&a||k||J(l>c?2:1)&&(f+=8),g=ne(l-c)>h,f+=16}l=H(0,z(m(),c)),f+=1;break;case 5:J(0)&&(f=8),k=!1;break;case 6:k=!0}f&&V.forEach(([a,L])=>{f&a&&L(g)})},$:()=>b!==0,j(i){o.l!==i&&((c,g)=>{const f=[],a=[];for(let L=0;L<g;L++){const j=c.o[L];if(f.push(A(j)?j:C),L===0)a.push(0);else{const R=c.h[L];a.push(A(R)?R:C)}}c.l=g,c.u=z(c.u,g-1),c.o=f,c.h=a})(o,i)}}},B=typeof window<"u"?p.useLayoutEffect:p.useEffect,T="current",ie={},ce=e=>{const t=[];return p.Children.forEach(e,n=>{A(n)&&typeof n!="boolean"&&t.push(n)}),t},P=e=>{const t=p.useRef(e);return B(()=>{t[T]=e},[e]),t},D=(e,t,n,r)=>{const[s,u]=p.useState(t),d=P(t);if(p.useLayoutEffect(()=>{const o=()=>{u(()=>d[T]())};return e.W(n,h=>{h?re.flushSync(o):o()})},[]),r){const o=t();s!==o&&u(o)}return s},ue=Z(e=>{const t="scrollLeft",n=e[t];e[t]=1;const r=e[t]<1;return e[t]=n,r}),ae=(e,t,n)=>(()=>{let r=U()-50;return(...s)=>{const u=U();r+50<u&&(r=u,(d=>{if(e.$()&&!d.ctrlKey&&(t?d.deltaX:d.deltaY)){const o=e.R();o>0&&o<e.k()&&n()}})(...s))}})(),de=(e,t,n)=>{let r,s;const u=t?"scrollLeft":"scrollTop",d=()=>r?t?r.scrollWidth:r.scrollHeight:0,o=(l,y)=>t&&n?ue(r)||y?-l:e.k()-l:l,h=async(l,y)=>{if(!r)return;const w=()=>z(y(),d()-e.O());for(;e.L(4,w()),e.p(l);){s&&s[1]();const b=e.W(2,()=>{s&&s[0]()});try{await new Promise((k,O)=>{let _=!1;const V=()=>{_||(_=!0,k(),s=void 0)};s=[V,O],G(V,250)})}catch{return}finally{b()}}r[u]=o(w()),e.L(6)};return{B(l){r=l;const y=()=>{e.L(3,o(l[u]))},w=se(()=>{y(),e.L(5)},150),b=()=>{y(),w()},k=ae(e,t,w);return l.addEventListener("scroll",b),l.addEventListener("wheel",k,{passive:!0}),()=>{l.removeEventListener("scroll",b),l.removeEventListener("wheel",k),w.t()}},N:d,U(l){l=H(l,0),h(e.J(l),()=>l)},A(l){l=H(z(l,e.I()-1),0),h(l,()=>e.v(l))},D:l=>{r&&(r[u]+=o(l,!0))}}},fe=e=>{const t=p.useRef();return t[T]||(t[T]=e())},he=(e,t)=>{let n;const r=t?"width":"height",s=new WeakMap,u=Z(()=>new ResizeObserver(d=>{const o=[];for(const{target:h,contentRect:l}of d)if(h===n)e.L(2,l[r]);else{const y=s.get(h);A(y)&&o.push([y,l[r]])}o.length&&e.L(1,o)}));return{F(d){n=d;const o=u();return o.observe(d),()=>{o.disconnect()}},P(d,o){const h=u();return s.set(d,o),h.observe(d),()=>{s.delete(d),h.unobserve(d)}}}},pe=p.forwardRef(({children:e,attrs:t,width:n,height:r,scrolling:s},u)=>q("div",{ref:u,...t,children:q("div",{style:p.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:r??"100%",pointerEvents:s?"none":"auto"}),[n,r,s]),children:e})})),me=p.memo(({V:e,X:t,Y:n,q:r,G:s,K:u,Z:d})=>{const o=p.useRef(null),h=D(n,()=>n.v(r),2,!0),l=D(n,()=>n.m(r),2,!0);return B(()=>t.P(o[T],r),[r]),q(s,{ref:o,style:p.useMemo(()=>{const y=d?"right":"left",w={margin:0,padding:0,position:"absolute",[u?"height":"width"]:"100%",[u?"top":y]:0,[u?y:"top"]:h,visibility:l?"hidden":"visible"};return u&&(w.display="flex"),w},[h,l]),children:e})}),ve=p.forwardRef(({children:e,overscan:t=4,initialItemSize:n,initialItemCount:r,horizontal:s,mode:u,cache:d,components:{Root:o=pe,Item:h="div"}=ie,onScroll:l,onScrollStop:y,onRangeChange:w,...b},k)=>{const O=p.useMemo(()=>ce(e),[e]),_=O.length,V=P(l),N=P(y),[m,J,i,c,g]=fe(()=>{const v=!!s,M=u==="rtl",I=le(_,n,r,u==="reverse",d);return[I,he(I,v),de(I,v,M),v,M]});m.j(_);const[f,a]=D(m,m.g,3),L=D(m,m.$,8),j=D(m,m.M,4),R=D(m,m.T,2,!0),x=p.useRef(null);B(()=>{const v=x[T],M=J.F(v),I=i.B(v),te=m.W(16,()=>{V[T]&&V[T](m.R())});return()=>{M(),I(),te()}},[]),B(()=>{const v=m.H();v&&i.D(v)},[j]),p.useEffect(()=>{L||N[T]&&N[T]()},[L]),p.useEffect(()=>{w&&w(f,a)},[f,a]),p.useImperativeHandle(k,()=>({get cache(){return m._()},get scrollOffset(){return m.R()},get scrollSize(){return i.N()},get viewportSize(){return m.O()},scrollToIndex:i.A,scrollTo:i.U,scrollBy(v){i.U(m.R()+v)}}),[]);const S=H(f-t,0),E=z(a+t,_-1),W=p.useMemo(()=>{const v=[];for(let M=S;M<=E;M++){const I=O[M];A(I)&&v.push(q(me,{X:J,Y:m,q:M,G:h,V:I,K:c,Z:g},I.key||M))}return v},[O,S,E]);return q(o,{ref:x,width:c?R:void 0,height:c?void 0:R,scrolling:L,attrs:p.useMemo(()=>({...b,style:{overflow:c?"auto hidden":"hidden auto",display:c?"inline-block":"block",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...b.style}}),oe(b)),children:W})}),$=p.memo(({count:e,Component:t,handle:n})=>{const r=p.useRef(null);return p.useImperativeHandle(n,()=>({scrollToIndex:s=>{var u;(u=r.current)==null||u.scrollToIndex(s)}})),q(ve,{ref:r,children:Array.from({length:e}).map((s,u)=>q(t,{index:u},u))})});try{$.displayName="VirtuaList",$.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{$ as V};
//# sourceMappingURL=virtua-c9e1a99c.js.map
