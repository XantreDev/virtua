import{j as z}from"./jsx-runtime-c3d7f245.js";import{r as d}from"./index-c6dae603.js";import{s as be}from"./index-778f7dbf.js";const N=Math.min,U=Math.max,_e=Math.abs,se=Date.now,W=e=>e!=null,ie=(e,t)=>Array.from({length:e},(n,o)=>t(o)),X=(e,t)=>{const n=e.t[t];return n===-1?e.o:n},me=(e,t,n)=>{if(!e.l)return 0;if(e.i>=t)return n?e.u[t]+X(e,t):e.u[t];let o=e.i,u=e.u[o];for(;o<=t&&(e.u[o]=u,o!==t||n);)u+=X(e,o),o++;return e.i=t,u},le=(e,t)=>me(e,t),pe=(e,t,n)=>{let o=0;if(n>=0)for(;t<e.l-1;){const u=X(e,t++);if((o+=u)>=n){o-u/2>=n&&t--;break}}else for(;t>0;){const u=X(e,--t);if((o-=u)<=n){o+u/2<n&&t++;break}}return N(U(t,0),e.l-1)},ce=(e,t,n,o)=>pe(e,n,t-o),ue=pe,ae=(e,t,n)=>({o:t,l:e,i:n?N(n.i,e-1):0,t:ie(e,o=>{const u=n&&n.t[o];return W(u)?u:-1}),u:ie(e,o=>{if(o===0)return 0;const u=n&&n.u[o];return W(u)?u:-1})}),P=typeof window<"u"?d.useLayoutEffect:d.useEffect,B=(e,t)=>be.useSyncExternalStore(e,t,t),b="current",de=e=>{const t=d.useRef();return t[b]||(t[b]=e())},fe=e=>{const t=d.useRef(e);return P(()=>{t[b]=e},[e]),d.useCallback((...n)=>{t[b]&&t[b](...n)},[])},xe=d.memo(({_:e,h:t,m:n,g:o,p:u})=>{const x=d.useRef(null),V=B(n.S,()=>n.I(o)),_=B(n.S,()=>n.v(o));return P(()=>t.T(x[b],o),[o]),z(u,{ref:x,style:d.useMemo(()=>{const M=n.O(),j=n.R()?"right":"left",D={margin:0,padding:0,position:"absolute",[M?"height":"width"]:"100%",[M?"top":j]:0,[M?j:"top"]:V};return M&&(D.display="flex"),_&&(D.visibility="hidden"),D},[V,_]),children:e})}),Me=d.forwardRef(({children:e,style:t,scrollSize:n,scrolling:o,horizontal:u,rtl:x},V)=>z("div",{ref:V,style:t,children:z("div",{style:d.useMemo(()=>{const _=u?n:"100%",M=u?"100%":n;return{position:"absolute",top:0,[x?"right":"left"]:0,width:_,height:M,minWidth:_,minHeight:M,pointerEvents:o?"none":"auto"}},[n,o]),children:e})})),Te=({_:e,M:t,m:n,p:o,k:u,j:x})=>{const V=B(n.S,n.A),_=n.O();return z(o,{ref:t,scrollSize:V,scrolling:u,horizontal:_,rtl:n.R(),style:d.useMemo(()=>({overflow:_?"auto hidden":"hidden auto",position:"relative",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...x}),[x]),children:e})},Ve=d.forwardRef(({children:e,itemSize:t=40,overscan:n=4,horizontal:o,rtl:u,endThreshold:x=0,style:V,element:_=Me,itemElement:M="div",onEndReached:j,onScroll:D,onScrollStop:ge},ve)=>{const Y=d.useMemo(()=>{const r=[];return d.Children.forEach(e,v=>{(E=>!W(E)||typeof E=="boolean")(v)||r.push(v)}),r},[e]),F=Y.length,S=de(()=>((r,v,E,J)=>{let h,C=0,T=0,w=0,H=[],f=ae(r,v),I=[0,0];const L=new Set,k=()=>E?C:T;return{D(){const[c,p]=I,g=le(f,c),s=ce(f,w,c,g),l=ue(f,s,k());return c===s&&p===l?I:I=[s,l]},v:c=>f.t[c]===-1,F:c=>((p,g,s)=>{for(let l=g;l<=s;l++)if(p.t[l]===-1)return!0;return!1})(f,c,ue(f,c,k())),I:c=>le(f,c),H:()=>w,J:()=>k(),A:()=>(c=>me(c,c.l-1,!0))(f),P:()=>f.l,U:()=>H,O:()=>E,R:()=>J,W:c=>ce(f,c,0,0),C:()=>(h&&h[1](),new Promise((c,p)=>{h=[()=>{Promise.resolve().then(()=>{c(),h=void 0})},p]})),S:c=>(L.add(c),()=>{L.delete(c)}),L(c,p){(()=>{switch(c){case 0:return f.l!==p&&(f=ae(p,v,f),!0);case 1:{const g=p.filter(([l,i])=>f.t[l]!==i);if(!g.length)return!1;const s=[];return g.forEach(([l,i])=>{s.push([l,i-X(f,l)]),((a,y,R)=>{a.t[y]=R,a.i=N(y,a.i)})(f,l,i)}),H=s,!0}case 2:return(C!==p.V||T!==p.q)&&(C=p.V,T=p.q,!0);case 3:{const g=w;return(w=p)!==g}}})()&&(L.forEach(g=>{g()}),h&&c===1&&h[0]())}}})(F,t,!!o,!!u)),[te,Q]=B(S.S,S.D),Z=B(S.S,S.U),ne=d.useRef(null),G=d.useRef(-1),ye=fe(D),we=fe(ge),[$,Se]=d.useState(new Set),[Ee,Re]=d.useState(!1),A=de(()=>((r,v,E)=>{let J,h,C,T=-1,w=0,H=!1;const f=r.O(),I=r.R(),L=f?"scrollLeft":"scrollTop",k=new WeakMap,c=()=>C||(C=new ResizeObserver(s=>{const l=[];for(const i of s)if(i.target===h)r.L(2,{V:i.contentRect.width,q:i.contentRect.height});else{const a=k.get(i.target);W(a)&&l.push([a,i.contentRect[f?"width":"height"]])}l.length&&(r.L(1,l),H=!0)})),p=()=>h?r.O()?h.scrollWidth:h.scrollHeight:0,g=(s,l)=>{if(h){if(I){if(!W(J)){const i=h[L];h[L]=1,J=h[L]===0,h[L]=i}J&&(s*=-1)}l?h[L]+=s:(h[L]=s,w=3)}};return{B(s){h=s;const l=c(),i=()=>{let m=s[L];I&&(m=_e(m)),T!==m&&(w!==0&&H?H=!1:w!==3&&(w=T>m?2:1),r.L(3,T=m),v(m))},a=(()=>{let m;const q=()=>{W(m)&&clearTimeout(m)},K=()=>{q(),m=setTimeout(()=>{m=null,i(),w=0,E(!1)},150)};return K.G=q,K})(),y=()=>{const m=w===0;i(),m&&E(!0),a()},R=(()=>{let m=se()-50;return(...q)=>{const K=se();m+50<K&&(m=K,(ee=>{w!==0&&(ee.ctrlKey||(f?ee.deltaX:ee.deltaY)&&T>0&&T<r.A()-r.J()&&a())})(...q))}})();return l.observe(s),s.addEventListener("scroll",y),s.addEventListener("wheel",R,{passive:!0}),()=>{l.disconnect(),s.removeEventListener("scroll",y),s.removeEventListener("wheel",R),a.G()}},T(s,l){const i=c();return k.set(s,l),i.observe(s),()=>{k.delete(s),i.unobserve(s)}},K:p,N:async(s,l)=>{const i=()=>{let a=l();const y=p(),R=r.J();return y-(a+R)<=0&&(a=y-R),a};if(r.F(s)){do{r.L(3,i());try{await r.C()}catch{return}}while(r.F(s));g(i())}else{const a=i();g(a),r.L(3,a)}},X:(s,l)=>{if(w===2){const i=s.reduce((a,[,y])=>a+y,0);i&&g(i,!0)}else if(w===3){const i=r.H();if(i!==0){const a=s.reduce((y,[,R])=>y+R,0);if(r.A()-(i+r.J()+a)<=0)a&&g(i+a);else{const y=s.reduce((R,[m,q])=>(m<l&&(R+=q),R),0);y&&g(y,!0)}}}}}})(S,ye,r=>{Re(r),r||(Se(new Set),we())})),O=N(F,S.P());P(()=>{S.L(0,F)},[F]),P(()=>A.B(ne[b]),[]),P(()=>{Z.length&&A.X(Z,te)},[Z]),d.useEffect(()=>{j&&(G[b]>O&&(G[b]=-1),O-1-Q<=x&&G[b]<O&&(G[b]=O,j()))},[Q]),d.useImperativeHandle(ve,()=>({get scrollOffset(){return S.H()},get scrollSize(){return A.K()},scrollToIndex(r){r=U(N(r,O-1),0),A.N(r,()=>S.I(r))},scrollToOffset(r){r=U(r,0),A.N(S.W(r),()=>r)}}),[O]);const re=U(te-n,0),oe=N(Q+n,O-1),Le=d.useMemo(()=>{const r=[];for(let v=re;v<=oe;v++)$.add(v);return $.forEach(v=>{const E=Y[v];r.push(z(xe,{h:A,m:S,g:v,p:M,_:E},(E==null?void 0:E.key)||v))}),r},[Y,$,re,oe]);return z(Te,{M:ne,m:S,p:_,k:Ee,j:V,_:Le})}),ze={flex:1},he=({count:e,Component:t})=>z(Ve,{style:ze,children:Array.from({length:e}).map((n,o)=>z(t,{index:o},o))});try{he.displayName="VirtuaList",he.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}}}}}catch{}export{he as V};
//# sourceMappingURL=virtua-f297234e.js.map
