import{j as T}from"./jsx-runtime-c3d7f245.js";import{r as a}from"./index-c6dae603.js";import{s as be}from"./index-7f713258.js";const j=Math.min,Q=Math.max,_e=Math.abs,ce=Date.now,F=e=>e!=null,ue=(e,t)=>Array.from({length:e},(r,s)=>t(s)),D=(e,t)=>{const r=e.t[t];return r===-1?e.o:r},ve=(e,t,r)=>{if(!e.l)return 0;if(e.i>=t)return r?e.u[t]+D(e,t):e.u[t];let s=e.i,l=e.u[s];for(;s<=t&&(e.u[s]=l,s!==t||r);)l+=D(e,s),s++;return e.i=t,l},ae=(e,t)=>ve(e,t),we=(e,t,r)=>{let s=0;if(r>=0)for(;t<e.l-1;){const l=D(e,t++);if((s+=l)>=r){s-l/2>=r&&t--;break}}else for(;t>0;){const l=D(e,--t);if((s-=l)<=r){s+l/2<r&&t++;break}}return j(Q(t,0),e.l-1)},de=(e,t,r,s)=>we(e,r,t-s),fe=we,he=(e,t,r)=>({o:t,l:e,i:r?j(r.i,e-1):0,t:ue(e,s=>{const l=r&&r.t[s];return F(l)?l:-1}),u:ue(e,s=>{if(s===0)return 0;const l=r&&r.u[s];return F(l)?l:-1})}),B=typeof window<"u"?a.useLayoutEffect:a.useEffect,K=(e,t)=>be.useSyncExternalStore(e,t,t),x="current",me=e=>{const t=a.useRef();return t[x]||(t[x]=e())},pe=e=>{const t=a.useRef(e);return B(()=>{t[x]=e},[e]),t},xe=a.memo(({_:e,h:t,m:r,g:s,S:l})=>{const g=a.useRef(null),k=K(r.p,()=>r.v(s)),V=K(r.p,()=>r.I(s));return B(()=>t.T(g[x],s),[s]),T(l,{ref:g,style:a.useMemo(()=>{const A=r.R(),J=r.M()?"right":"left",X={margin:0,padding:0,position:"absolute",[A?"height":"width"]:"100%",[A?"top":J]:0,[A?J:"top"]:k,visibility:V?"hidden":"visible"};return A&&(X.display="flex"),X},[k,V]),children:e})}),Me=a.forwardRef(({children:e,scrollSize:t,scrolling:r,horizontal:s,attrs:l},g)=>T("div",{ref:g,...l,children:T("div",{style:a.useMemo(()=>({position:"relative",visibility:"hidden",width:s?t:"100%",height:s?"100%":t,pointerEvents:r?"none":"auto"}),[t,r]),children:e})})),ze=({_:e,O:t,m:r,S:s,k:l,j:g})=>{const k=K(r.p,r.A),V=r.R();return T(s,{ref:t,scrollSize:k,scrolling:l,horizontal:V,attrs:a.useMemo(()=>({...g,style:{overflow:V?"auto hidden":"hidden auto",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...g.style}}),[g]),children:e})},Te=a.forwardRef(({children:e,itemSize:t=40,overscan:r=4,horizontal:s,rtl:l,element:g=Me,itemElement:k="div",onScroll:V,onScrollStop:A,onRangeChange:J,...X},ye)=>{const Z=a.useMemo(()=>{const o=[];return a.Children.forEach(e,w=>{(E=>!F(E)||typeof E=="boolean")(w)||o.push(w)}),o},[e]),Y=Z.length,R=me(()=>((o,w,E,O)=>{let h,C=0,_=0,S=0,q=[],d=he(o,w),N=[0,0];const L=new Set,H=()=>E?C:_;return{C(){const[c,p]=N,v=ae(d,c),b=de(d,S,c,v),y=fe(d,b,H());return c===b&&p===y?N:N=[b,y]},I:c=>d.t[c]===-1,D:c=>((p,v,b)=>{for(let y=v;y<=b;y++)if(p.t[y]===-1)return!0;return!1})(d,c,fe(d,c,H())),v:c=>ae(d,c),F:()=>S,J:()=>H(),A:()=>(c=>ve(c,c.l-1,!0))(d),P:()=>d.l,U:()=>q,R:()=>E,M:()=>O,B:c=>de(d,c,0,0),H:()=>(h&&h[1](),new Promise((c,p)=>{h=[()=>{Promise.resolve().then(()=>{c(),h=void 0})},p]})),p:c=>(L.add(c),()=>{L.delete(c)}),L(c,p){(()=>{switch(c){case 0:return d.l!==p&&(d=he(p,w,d),!0);case 1:{const v=p.filter(([y,n])=>d.t[y]!==n);if(!v.length)return!1;const b=[];return v.forEach(([y,n])=>{b.push([y,n-D(d,y)]),((u,i,f)=>{u.t[i]=f,u.i=j(i,u.i)})(d,y,n)}),q=b,!0}case 2:return(C!==p.V||_!==p.W)&&(C=p.V,_=p.W,!0);case 3:{const v=S;return(S=p)!==v}}})()&&(L.forEach(v=>{v()}),h&&c===1&&h[0]())}}})(Y,t,!!s,!!l)),[G,$]=K(R.p,R.C),ee=K(R.p,R.U),re=a.useRef(null),oe=pe(V),se=pe(A),[te,Se]=a.useState(new Set),[Re,Ee]=a.useState(!1),I=me(()=>((o,w,E)=>{let O,h,C,_=-1,S=0,q=!1;const d=o.R(),N=o.M(),L=d?"scrollLeft":"scrollTop",H=new WeakMap,c=()=>C||(C=new ResizeObserver(n=>{const u=[];for(const i of n)if(i.target===h)o.L(2,{V:i.contentRect.width,W:i.contentRect.height});else{const f=H.get(i.target);F(f)&&u.push([f,i.contentRect[d?"width":"height"]])}u.length&&(o.L(1,u),q=!0)})),p=()=>h?o.R()?h.scrollWidth:h.scrollHeight:0,v=(n,u)=>{if(h){if(N){if(!F(O)){const i=h[L];h[L]=1,O=h[L]===0,h[L]=i}O&&(n*=-1)}u?h[L]+=n:(h[L]=n,S=3)}},b=async(n,u)=>{const i=()=>{let f=u();const M=p(),z=o.J();return M-(f+z)<=0&&(f=M-z),f};if(o.D(n)){do{o.L(3,i());try{await o.H()}catch(f){return}}while(o.D(n));v(i())}else{const f=i();v(f),o.L(3,f)}},y=n=>n.reduce((u,[,i])=>u+i,0);return{q(n){h=n;const u=c(),i=()=>{let m=n[L];N&&(m=_e(m)),_!==m&&(S!==0&&q?q=!1:S!==3&&(S=_>m?2:1),o.L(3,_=m),w(m))},f=(()=>{let m;const W=()=>{F(m)&&clearTimeout(m)},P=()=>{W(),m=setTimeout(()=>{m=null,i(),S=0,E(!1)},150)};return P.G=W,P})(),M=()=>{const m=S===0;i(),m&&E(!0),f()},z=(()=>{let m=ce()-50;return(...W)=>{const P=ce();m+50<P&&(m=P,(ne=>{S!==0&&(ne.ctrlKey||(d?ne.deltaX:ne.deltaY)&&_>0&&_<o.A()-o.J()&&f())})(...W))}})();return u.observe(n),n.addEventListener("scroll",M),n.addEventListener("wheel",z,{passive:!0}),()=>{u.disconnect(),n.removeEventListener("scroll",M),n.removeEventListener("wheel",z),f.G()}},T(n,u){const i=c();return H.set(n,u),i.observe(n),()=>{H.delete(n),i.unobserve(n)}},K:p,N(n){n=Q(n,0),b(o.B(n),()=>n)},X(n,u){n=Q(j(n,u-1),0),b(n,()=>o.v(n))},Y:(n,u)=>{if(S===2){const i=y(n);i&&v(i,!0)}else if(S===3){const i=o.F();if(i!==0){const f=y(n);if(o.A()-(i+o.J()+f)<=0)f&&v(i+f);else{const M=n.reduce((z,[m,W])=>(m<u&&(z+=W),z),0);M&&v(M,!0)}}}}}})(R,o=>{oe[x]&&oe[x](o)},o=>{Ee(o),o||(Se(new Set),se[x]&&se[x]())})),U=j(Y,R.P());B(()=>{R.L(0,Y)},[Y]),B(()=>I.q(re[x]),[]),B(()=>{ee.length&&I.Y(ee,G)},[ee]),a.useEffect(()=>{J&&J({start:G,end:$,count:U})},[G,$]),a.useImperativeHandle(ye,()=>({get scrollOffset(){return R.F()},get scrollSize(){return I.K()},get viewportSize(){return R.J()},scrollToIndex(o){I.X(o,U)},scrollTo:I.N,scrollBy(o){I.N(R.F()+o)}}),[U]);const ie=Q(G-r,0),le=j($+r,U-1),Le=a.useMemo(()=>{const o=[];for(let w=ie;w<=le;w++)te.add(w);return te.forEach(w=>{const E=Z[w];o.push(T(xe,{h:I,m:R,g:w,S:k,_:E},(E==null?void 0:E.key)||w))}),o},[Z,te,ie,le]);return T(ze,{O:re,m:R,S:g,k:Re,_:Le,j:X})}),ge=a.memo(({count:e,Component:t,handle:r})=>{const s=a.useRef(null);return a.useImperativeHandle(r,()=>({scrollToIndex:l=>{var g;(g=s.current)==null||g.scrollToIndex(l)}})),T(Te,{ref:s,children:Array.from({length:e}).map((l,g)=>T(t,{index:g},g))})});try{ge.displayName="VirtuaList",ge.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch(e){}export{ge as V};
//# sourceMappingURL=virtua-34884cfb.js.map
