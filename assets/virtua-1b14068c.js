import{j as N}from"./jsx-runtime-c3d7f245.js";import{r as h}from"./index-c6dae603.js";import{r as ie}from"./index-eb008d06.js";const D=Math.min,z=Math.max,ce=Math.abs,G=Date.now,ue=Object.values,ae=Array.isArray,ne=setTimeout,F=(e,t,r)=>D(r,z(t,e)),Y=e=>e!=null,fe=(e,t)=>{let r;const n=()=>{Y(r)&&clearTimeout(r)},o=()=>{n(),r=ne(()=>{r=null,e()},t)};return o.t=n,o},oe=e=>{let t,r;return(...n)=>(t||(t=!0,r=e(...n)),r)},de=e=>getComputedStyle(e),he=e=>e?parseFloat(e):0,A=-1,P=(e,t)=>{const r=e.o[t];return r===A?e.i:r},K=(e,t)=>{if(!e.l)return 0;if(e.u>=t)return e.h[t];let r=e.u,n=e.h[r];for(;r<t;)n+=P(e,r),e.h[++r]=n;return e.u=t,n},Z=(e,t,r)=>{let n=K(e,r);for(;r>=0&&r<e.l;)if(n<=t){const o=P(e,r);if(n+o>t)break;n+=o,r++}else n-=P(e,--r);return F(r,0,e.l-1)},ee=(e,t,r,n)=>{const o=Z(e,t,D(r,e.l-1));return[o,Z(e,t+n,o)]},se=(e,t,r)=>{const n=r?"unshift":"push";for(let o=e.l;o<t;o++)e.o[n](A),e.h.push(o===0?0:A);e.l=t},te=(e,t,r)=>{const n=t-e.l,o=n<0;let i;return o?(i=(r?e.o.splice(0,-n):e.o.splice(n)).reduce((u,l)=>u+(l===A?e.i:l),0),e.h.splice(n)):(i=e.i*n,se(e,e.l+n,r)),e.u=r?0:F(t-1,0,e.u),e.l=t,[i,o]},$=(e,t,r)=>t.reduce((n,[o,i])=>{const u=i-P(e,o);return(!r||u>0)&&(n+=u),n},0),pe=(e,t,r=40,n=0,o=((l,s)=>{const a={i:s,l:0,u:0,o:[],h:[]};return se(a,l),a})(t,r),i,u)=>{let l=r*z(n-1,0),s=0,a=0,m=0,y=0,R=!1,S=!1,C=!1,E=[0,n];const V=new Set,j=()=>(c=>c.l?K(c,c.l-1)+P(c,c.l-1):0)(o),H=()=>j()-l,d=c=>F(c,0,H()),B=c=>{const f=y;return y=c,y!==f};return{_:()=>JSON.parse(JSON.stringify(o)),g(){const[c,f]=E,[k,p]=ee(o,s,c,l);return c===k&&f===p?E:E=[k,p]},m:c=>o.o[c]===A,p(c){const[f,k]=ee(o,c,E[0],l);return((p,v,g)=>p.o.slice(z(0,v-1),D(p.l-1,g+1)+1).includes(A))(o,f,k)},v(c){const f=K(o,c);return i?f+z(0,l-j()):f},S:c=>P(o,c),I:()=>o.l,R:()=>s,k:H,O:()=>y,C:()=>l,T:()=>z(j(),l),M:()=>a,H(){const c=m;return m=0,c},J(c,f){const k=[c,f];return V.add(k),()=>{V.delete(k)}},W(c,f){let k,p=0;switch(c){case 1:{const v=f.filter(([b,L])=>o.o[b]!==L);if(!v.length)break;let g=0;if(R||S){const[b]=E;s===0||(g=s>H()-1.5?$(o,v,!0):$(o,v.filter(([L])=>L<b)))}else y===2&&(g=$(o,v));g&&(m=g,a++,p+=4);let O=!1;v.forEach(([b,L])=>{((M,x,T)=>{const J=M.o[x]===A;return M.o[x]=T,M.u=D(x,M.u),J})(o,b,L)&&(O=!0)}),u&&O&&!s&&(b=>{const L=b.o.filter(x=>x!==A),M=L[0];b.i=L.every(x=>x===M)?M:(x=>{const T=[...x].sort((w,I)=>w-I),J=x.length/2|0;return T.length%2==0?(T[J-1]+T[J])/2:T[J]})(L)})(o),p+=2,C=k=!0;break}case 2:l!==f&&(l=f,p=2);break;case 3:if(f[1]){const v=H()-s,[g,O]=te(o,f[0],!0),b=O?-D(g,v):g;m+=b,s=d(s+b),a++,p=5,R=!0}else te(o,f[0]);break;case 4:case 5:if(s===f)break;if(c===4){const v=f-s,g=C;C=!1,y!==0&&g||S||B(v<0?2:1)&&(p+=8),k=ce(v)>l,p+=16,g||(R=!1)}s=d(f),p+=1;break;case 6:B(0)&&(p=8),R=S=!1;break;case 7:S=!0}if(p){const v=()=>{V.forEach(([g,O])=>{p&g&&O()})};k?e(v):v()}}}},U=typeof window<"u"?h.useLayoutEffect:h.useEffect,_="current",me={},le=(e,t)=>{if(ae(e))for(const r of e)le(r,t);else Y(e)&&typeof e!="boolean"&&t.push(e)},ve=e=>{const t=[];return le(e,t),t},ge=(e,t,r)=>z(e-(r===1?1:z(1,t)),0),ye=(e,t,r,n)=>D(e+(r===2?1:z(1,t)),n-1),Q=e=>{const t=h.useRef(e);return U(()=>{t[_]=e},[e]),t},q=(e,t,r,n)=>{const[o,i]=h.useState(t),u=Q(t);if(U(()=>e.J(r,()=>{i(()=>u[_]())}),[]),n){const l=t();o!==l&&i(l)}return o},be=oe(e=>{const t="scrollLeft",r=e[t];e[t]=1;const n=e[t]<1;return e[t]=r,n}),we=(e,t,r)=>(()=>{let n=G()-50;return(...o)=>{const i=G();n+50<i&&(n=i,(u=>{if(e.O()!==0&&!u.ctrlKey&&(t?u.deltaX:u.deltaY)){const l=e.R();l>0&&l<e.k()&&r()}})(...o))}})(),Re=(e,t,r)=>{let n,o;const i=t?"scrollLeft":"scrollTop",u=(s,a)=>t&&r?be(n)||a?-s:e.k()-s:s,l=async s=>{if(!n)return;const a=()=>F(s(),0,e.k());for(;;){const m=a();if(e.W(5,m),!e.p(m))break;o&&o[1]();const y=e.J(2,()=>{o&&o[0]()});try{await new Promise((R,S)=>{let C=!1;const E=()=>{C||(C=!0,R(),o=void 0)};o=[E,S],ne(E,250)})}catch{return}finally{y()}}n[i]=u(a()),e.W(7)};return{L(s){n=s;const a=()=>{e.W(4,u(s[i]))},m=fe(()=>{a(),e.W(6)},150),y=()=>{a(),m()},R=we(e,t,m);return s.addEventListener("scroll",y),s.addEventListener("wheel",R,{passive:!0}),()=>{s.removeEventListener("scroll",y),s.removeEventListener("wheel",R),m.t()}},$(s){l(()=>s)},B(s){s+=e.R(),l(()=>s)},j(s,a){s=F(s,0,e.I()-1),l(a==="end"?()=>e.v(s)+e.S(s)-e.C():()=>e.v(s))},D:s=>{n&&(n[i]+=u(s,!0))}}},ke=e=>{const t=h.useRef();return t[_]||(t[_]=e())},xe={box:"border-box"},Ee=(e,t)=>{let r;const n=t?"width":"height",o=new WeakMap,i=oe(()=>new ResizeObserver(u=>{const l=[];for(const{target:s,contentRect:a}of u)if(s.offsetParent)if(s===r)e.W(2,a[n]+a[t?"left":"top"]+he(de(r)[t?"paddingRight":"paddingBottom"]));else{const m=o.get(s);Y(m)&&l.push([m,a[n]])}l.length&&e.W(1,l)}));return{N(u){r=u;const l=i();return l.observe(u,xe),()=>{l.disconnect()}},U(u,l){const s=i();return o.set(u,l),s.observe(u),()=>{o.delete(u),s.unobserve(u)}}}},Le=h.forwardRef(({children:e,attrs:t,width:r,height:n,scrolling:o},i)=>N("div",{ref:i,...t,children:N("div",{style:h.useMemo(()=>({position:"relative",visibility:"hidden",width:r??"100%",height:n??"100%",pointerEvents:o?"none":"auto"}),[r,n,o]),children:e})})),Ie=h.memo(({V:e,A:t,F:r,P:n,X:o,Y:i,q:u})=>{const l=h.useRef(null),s=q(r,()=>r.v(n),2,!0),a=q(r,()=>r.m(n),2,!0);return U(()=>t.U(l[_],n),[n]),N(o,{ref:l,style:h.useMemo(()=>{const m=u?"right":"left",y={margin:0,padding:0,position:"absolute",[i?"height":"width"]:"100%",[i?"top":m]:0,[i?m:"top"]:s,visibility:a?"hidden":"visible"};return i&&(y.display="flex"),y},[s,a]),children:e})}),Me=h.forwardRef(({children:e,overscan:t=4,initialItemSize:r,initialItemCount:n,shift:o,horizontal:i,mode:u,cache:l,components:{Root:s=Le,Item:a="div"}=me,onScroll:m,onScrollStop:y,onRangeChange:R,...S},C)=>{const E=h.useMemo(()=>ve(e),[e]),V=E.length,j=Q(m),H=Q(y),[d,B,c,f,k]=ke(()=>{const w=!!i,I=u==="rtl",W=pe(ie.flushSync,V,r,n,l,u==="reverse",!r);return[W,Ee(W,w),Re(W,w,I),w,I]});V!==d.I()&&d.W(3,[V,o]);const[p,v]=q(d,d.g,3),g=q(d,d.O,8),O=q(d,d.M,4),b=q(d,d.T,2,!0),L=h.useRef(null),M=g!==0;U(()=>{const w=L[_],I=B.N(w),W=c.L(w),X=d.J(16,()=>{j[_]&&j[_](d.R())});return()=>{I(),W(),X()}},[]),U(()=>{const w=d.H();w&&c.D(w)},[O]),h.useEffect(()=>{M||H[_]&&H[_]()},[M]),h.useEffect(()=>{R&&R(p,v)},[p,v]),h.useImperativeHandle(C,()=>({get cache(){return d._()},get scrollOffset(){return d.R()},get scrollSize(){return d.T()},get viewportSize(){return d.C()},scrollToIndex:c.j,scrollTo:c.$,scrollBy:c.B}),[]);const x=ge(p,t,g),T=ye(v,t,g,V),J=h.useMemo(()=>{const w=[];for(let I=x;I<=T;I++){const W=E[I],X=W.key;w.push(N(Ie,{A:B,F:d,P:I,X:a,V:W,Y:f,q:k},Y(X)?X:"_"+I))}return w},[E,x,T]);return N(s,{ref:L,width:f?b:void 0,height:f?void 0:b,scrolling:M,attrs:h.useMemo(()=>({...S,style:{overflow:"auto",display:f?"inline-block":"block",contain:"strict",width:"100%",height:"100%",...S.style}}),ue(S)),children:J})}),re=h.memo(({count:e,Component:t,handle:r})=>{const n=h.useRef(null);return h.useImperativeHandle(r,()=>({scrollToIndex:o=>{var i;(i=n.current)==null||i.scrollToIndex(o)}})),N(Me,{ref:n,children:Array.from({length:e}).map((o,i)=>N(t,{index:i},i))})});try{re.displayName="VirtuaList",re.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{re as V};
//# sourceMappingURL=virtua-1b14068c.js.map
