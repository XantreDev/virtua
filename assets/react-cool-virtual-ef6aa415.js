import{j as vr}from"./jsx-runtime-c3d7f245.js";import{r as a}from"./index-c6dae603.js";var E;(function(t){t.auto="auto",t.start="start",t.center="center",t.end="end"})(E||(E={}));var qr=function(t,u,f,R){for(;t<=u;){var c=(t+u)/2|0,l=R(c);if(f<l)u=c-1;else if(f>l)t=c+1;else return c}return t>0?t-1:0},b=function(t){return typeof t=="number"&&!Number.isNaN(t)},er=function(){return"performance"in window?performance.now():Date.now()},Yr=function(t,u,f){if(t.length!==u.length)return!0;for(var R=function(S){if(Object.keys(t[S]).some(function(k){var j=k;return!f[j]&&t[S][j]!==u[S][j]}))return{v:!0}},c=0;c<t.length;c+=1){var l=R(c);if(typeof l=="object")return l.v}return!1},C=function(t){var u=a.useRef(t);return u.current=t,u},Zr=function(t,u){var f=a.useRef(),R=C(t),c=a.useCallback(function(){f.current&&(cancelAnimationFrame(f.current),f.current=void 0)},[]),l=a.useCallback(function(S){er()-S>=u?R.current():f.current=requestAnimationFrame(function(){return l(S)})},[R,u]),I=a.useCallback(function(){c(),l(er())},[c,l]);return[I,c]},dr=typeof window<"u"?a.useLayoutEffect:a.useEffect,re=function(t,u,f){var R=C(u);dr(function(){if(!(t!=null&&t.current))return function(){return null};var c=new ResizeObserver(function(l){var I=l[0].contentRect,S=I.width,k=I.height;R.current({width:S,height:k})});return c.observe(t.current),function(){return c.disconnect()}},[R,t].concat(f))},ee=function(u,f){f===void 0&&(f=0);for(var R=b(f)?[0,f-1]:f,c=R[0],l=R[1],I=[],S=c;S<=l;S+=1)I.push({index:S,start:0,width:0,size:b(u)?u:u(S,0),measureRef:function(){return null}});return{items:I}},te=function(t){var u=t.itemCount,f=t.ssrItemCount,R=t.itemSize,c=R===void 0?50:R,l=t.horizontal,I=t.resetScroll,S=t.overscanCount,k=S===void 0?1:S,j=t.useIsScrolling,Hr=t.stickyIndices,mr=t.scrollDuration,Kr=mr===void 0?function(e){return Math.min(Math.max(e*.075,100),500)}:mr,Rr=t.scrollEasingFunction,Or=Rr===void 0?function(e){return-(Math.cos(Math.PI*e)-1)/2}:Rr,hr=t.loadMoreCount,H=hr===void 0?15:hr,Br=t.isItemLoaded,Pr=t.loadMore,Ur=t.onScroll,Wr=t.onResize,Sr=a.useState(function(){return ee(c,f)}),T=Sr[0],gr=Sr[1],tr=a.useRef(!1),nr=a.useRef(!0),ar=a.useRef(!1),$=a.useRef(!1),W=a.useRef(new Map),w=a.useRef(0),pr=a.useRef(-1),zr=a.useRef(-1),K=a.useRef(null),G=a.useRef(null),F=a.useRef({width:0,height:0}),z=a.useRef([]),J=a.useRef(!0),O=a.useRef(),ur=C(Hr),Ir=C(Kr),Mr=C(Or),B=C(Br),P=C(Pr),xr=C(c),wr=C(j),ir=C(Ur),or=C(Wr),D=l?"width":"height",Cr=l?"marginLeft":"marginTop",Q=l?"scrollLeft":"scrollTop",br=a.useCallback(function(e){var r=xr.current;return b(r)?r:r(e,F.current.width)},[xr]),X=a.useCallback(function(e,r){var i,n,o=(i=(n=z.current[e-1])==null?void 0:n.end)!=null?i:0;return{idx:e,start:o,end:o+r,size:r}},[]),Y=a.useCallback(function(e){e===void 0&&(e=!0),z.current.length=u;for(var r=0;r<u;r+=1)z.current[r]=X(r,e&&z.current[r]?z.current[r].size:br(r))},[br,X,u]),yr=a.useCallback(function(e){var r=z.current,i=r.length-1,n=0;if($.current)for(;n<i&&r[n].start+r[n].size<e;)n+=1;else n=qr(0,i,e,function(d){return r[d].start});for(var o=n,h=r[o].start;o<i&&h<e+F.current[D];)h+=r[o].size,o+=1;o=o===i?o:o-1;var v=Math.max(n-k,0),s=Math.min(o+k,i),g=r[v].start,m=Math[s<i?"max":"min"](r[s].end+r[s].size,r[i].end);return{oStart:v,oStop:s,vStart:n,vStop:o,innerMargin:g,innerSize:m-g}},[k,D]),L=a.useCallback(function(e,r){r===void 0&&(r=!0),K.current&&(J.current=!1,nr.current=r,K.current[Q]=e)},[Q]),cr=a.useCallback(function(e,r){var i=b(e)?{offset:e}:e,n=i.offset,o=i.smooth;if(b(n)){if(!o){L(n),r&&r();return}var h=w.current,v=er(),s=function g(){var m=Ir.current;m=b(m)?m:m(Math.abs(n-h));var d=Math.min((er()-v)/m,1),x=Mr.current(d);L(x*(n-h)+h),d<1?O.current=requestAnimationFrame(g):r&&r()};O.current=requestAnimationFrame(s)}},[Ir,Mr,L]),A=a.useCallback(function(e,r,i){var n=b(e)?{index:e}:e,o=n.index,h=n.align,v=h===void 0?E.auto:h,s=n.smooth;if(b(o)){ar.current=!0,$.current&&Y();var g=z.current,m=g[Math.max(0,Math.min(o,g.length-1))];if(m){var d=m.start,x=m.end,V=m.size,y=g[g.length-1].end,p=F.current[D],M=w.current;if(y<=p){r&&r();return}if(i||v===E.start||v===E.auto&&M+p>x&&M>d)M=y-d<=p?y-p:d;else if(v===E.end||v===E.auto&&M+p<x&&M<d)M=d+V<=p?0:d-p+V;else if(v===E.center&&d+V/2>p/2){var U=d-p/2+V/2;M=y-U<=p?y-p:U}if($.current&&Math.abs(M-w.current)<=1){r&&r();return}cr({offset:M,smooth:s},function(){$.current?i?requestAnimationFrame(function(){return A(e,r,i)}):setTimeout(function(){return A(e,r)}):r&&r()})}}},[Y,cr,D]),Gr=a.useCallback(function(e,r){return A(e,r)},[A]),Jr=a.useCallback(function(e,r){return A(e,r,!0)},[A]),kr=Zr(function(){return N(w.current)},150),Dr=kr[0],Lr=kr[1],N=a.useCallback(function(e,r,i){if(P.current&&!tr.current&&!(B.current&&B.current(0))&&P.current({startIndex:0,stopIndex:H-1,loadIndex:0,scrollOffset:e,userScroll:!1}),!u){gr({items:[]});return}for(var n=yr(e),o=n.oStart,h=n.oStop,v=n.vStart,s=n.vStop,g=n.innerMargin,m=n.innerSize,d=[],x=Array.isArray(ur.current)?ur.current:[],V=function(_){var Er=z.current,Tr=Er[_],fr=Tr.start,lr=Tr.size;d.push({index:_,start:fr-g,size:lr,width:F.current.width,isScrolling:i||void 0,isSticky:x.includes(_)||void 0,measureRef:function($r){$r&&new ResizeObserver(function(Qr,Fr){var Ar,Nr,Vr,Z=Qr[0].target,rr=Z.getBoundingClientRect()[D];if(!rr){Fr.disconnect(),W.current.delete(Z);return}var Xr=(Ar=(Nr=Er[_-1])==null?void 0:Nr.end)!=null?Ar:0;(rr!==lr||fr!==Xr)&&(_<pr.current&&fr<e&&L(e+rr-lr,!1),z.current[_]=X(_,rr),ar.current||N(w.current,r,i),$.current=!0),pr.current=_,(Vr=W.current.get(Z))==null||Vr.disconnect(),W.current.set(Z,Fr)}).observe($r)}})},y=o;y<=h;y+=1)V(y);if(x.length){var p=x[qr(0,x.length-1,v,function(q){return x[q]})];if(o>p){var M=z.current[p].size;d.unshift({index:p,start:0,size:M,width:F.current.width,isScrolling:i||void 0,isSticky:!0,measureRef:function(){return null}}),g-=M,m+=M}}if(gr(function(q){return Yr(q.items,d,{measureRef:!0})?{items:d,innerMargin:g,innerSize:m}:q}),!!r){var U=e>w.current;ir.current&&ir.current({overscanStartIndex:o,overscanStopIndex:h,visibleStartIndex:v,visibleStopIndex:s,scrollOffset:e,scrollForward:U,userScroll:J.current});var sr=Math.max(Math.floor((s+1)/H)-(U?0:1),0),_r=sr*H;P.current&&s!==zr.current&&!(B.current&&B.current(sr))&&P.current({startIndex:_r,stopIndex:_r+H-1,loadIndex:sr,scrollOffset:e,userScroll:J.current}),i&&Dr(),zr.current=s}},[ur,yr,X,u,H,P,ir,Dr,L,D,B]);return re(K,function(e){var r,i=F.current,n=i.width,o=i.height,h=n===e.width,v=h&&o===e.height,s=z.current.length,g=(r=z.current[s-1])==null?void 0:r.end;if(F.current=e,Y($.current),N(w.current),I&&u!==s&&setTimeout(function(){return L(0,!1)}),!tr.current){tr.current=!0;return}if(!$.current&&!h){var m,d=(m=z.current[z.current.length-1])==null?void 0:m.end,x=d/g||1;L(w.current*x,!1)}!v&&or.current&&or.current(e)},[u,I,N,Y,or,L]),dr(function(){G.current&&(b(T.innerMargin)&&(G.current.style[Cr]=T.innerMargin+"px"),b(T.innerSize)&&(G.current.style[D]=T.innerSize+"px"))},[Cr,D,T.innerMargin,T.innerSize]),dr(function(){var e=K.current;if(!e)return function(){return null};var r=function(o){var h=o.target,v=h[Q];if(v!==w.current){var s=wr.current;s=typeof s=="function"?s(Math.abs(v-w.current)):s,N(v,nr.current,s),J.current=!0,nr.current=!0,ar.current=!1,w.current=v}};e.addEventListener("scroll",r,{passive:!0});var i=W.current;return function(){Lr(),O.current&&(cancelAnimationFrame(O.current),O.current=void 0),e.removeEventListener("scroll",r),i.forEach(function(n){return n.disconnect()}),i.clear()}},[Lr,N,Q,wr]),{outerRef:K,innerRef:G,items:T.items,scrollTo:cr,scrollToItem:Gr,startItem:Jr}};const jr=({count:t,Component:u})=>{const{outerRef:f,innerRef:R,items:c}=te({itemCount:t});return vr("div",{ref:f,style:{flex:1,overflow:"auto"},children:vr("div",{ref:R,children:c.map(({index:l,measureRef:I})=>vr(u,{index:l,ref:I},l))})})};try{jr.displayName="ReactCoolVirtualList",jr.__docgenInfo={description:"",displayName:"ReactCoolVirtualList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}}}}}catch{}export{jr as R};
//# sourceMappingURL=react-cool-virtual-ef6aa415.js.map
