import{r as x}from"./index-c6dae603.js";import{j as $}from"./jsx-runtime-c3d7f245.js";const N=Math.min,O=Math.max,ve=Math.abs,H=Date.now,Me=Object.values,Ie=Array.isArray,j=setTimeout,W=(e,t,n)=>N(n,O(t,e)),U=e=>e!=null,be=e=>{const t=[...e].sort((s,i)=>s-i),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},le=(e,t)=>{let n;const s=()=>{U(n)&&clearTimeout(n)},i=()=>{s(),n=j(()=>{n=null,e()},t)};return i._cancel=s,i},he=(e,t)=>{let n=H()-t;return(...s)=>{const i=H();n+t<i&&(n=i,e(...s))}},M=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},Z=e=>getComputedStyle(e),q=e=>e?parseFloat(e):0,y=-1,A=(e,t)=>{const n=e._sizes[t];return n===y?e._defaultItemSize:n},Oe=(e,t,n)=>{const s=e._sizes[t]===y;return e._sizes[t]=n,e._computedOffsetIndex=N(t,e._computedOffsetIndex),s},Q=(e,t)=>{if(!e._length)return 0;if(e._computedOffsetIndex>=t)return e._offsets[t];let n=e._computedOffsetIndex,s=e._offsets[n];for(;n<t;)s+=A(e,n),e._offsets[++n]=s;return e._computedOffsetIndex=t,s},Ee=e=>e._length?Q(e,e._length-1)+A(e,e._length-1):0,ee=(e,t,n)=>{let s=Q(e,n);for(;n>=0&&n<e._length;)if(s<=t){const i=A(e,n);if(s+i>t)break;s+=i,n++}else s-=A(e,--n);return W(n,0,e._length-1)},te=(e,t,n,s)=>{const i=ee(e,t,N(n,e._length-1));return[i,ee(e,t+s,i)]},Re=(e,t,n)=>e._sizes.slice(O(0,t-1),N(e._length-1,n+1)+1).includes(y),ze=e=>{const t=e._sizes.filter(s=>s!==y),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:be(t)},ue=(e,t,n)=>{const s=n?"unshift":"push";for(let i=e._length;i<t;i++)e._sizes[s](y),e._offsets.push(i===0?0:y);e._length=t},ye=(e,t)=>{const n={_defaultItemSize:t,_length:0,_computedOffsetIndex:0,_sizes:[],_offsets:[]};return ue(n,e),n},ne=(e,t,n)=>{const s=t-e._length,i=s<0;let a;return i?(a=(n?e._sizes.splice(0,-s):e._sizes.splice(s)).reduce((o,l)=>o+(l===y?e._defaultItemSize:l),0),e._offsets.splice(s)):(a=e._defaultItemSize*s,ue(e,e._length+s,n)),e._computedOffsetIndex=n?0:W(t-1,0,e._computedOffsetIndex),e._length=t,[a,i]},ce=typeof window<"u",Le=M(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),F=M(()=>ce?Z(document.body).direction==="rtl":!1),G=M(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),se=(e,t,n)=>t.reduce((s,[i,a])=>{const o=a-A(e,i);return(!n||o>0)&&(s+=o),s},0),Te=1.5,k=0,fe=1,de=2,P=1,D=2,Ce=3,J=4,ae=5,Y=6,_e=7,B=1,X=2,xe=4,Ve=(e,t=40,n=0,s=ye(e,t),i,a)=>{let o=t*O(n-1,0),l=0,r=0,u=0,f=0,_=k,d=!1,S=!1,c=!1,p=[0,n];const g=new Set,v=()=>Ee(s),I=()=>v()-o,V=m=>W(m,0,I()),T=m=>{G()&&_!==k?f+=m:(u+=m,r++)},C=m=>{const w=_;return _=m,_!==w};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){return p=te(s,l+f,p[0],o)},_isUnmeasuredItem(m){return s._sizes[m]===y},_hasUnmeasuredItemsInTargetViewport(m){const[w,L]=te(s,m,p[0],o);return Re(s,w,L)},_getItemOffset(m){const w=Q(s,m)-f;return i?w+O(0,o-v()):w},_getItemSize(m){return A(s,m)},_getItemsLength(){return s._length},_getScrollOffset(){return l},_getScrollOffsetMax:I,_getScrollDirection(){return _},_getViewportSize(){return o},_getCorrectedScrollSize(){return O(v(),o)},_getJumpCount(){return r},_flushJump(){const m=u;return u=0,m},_subscribe(m,w){const L=[m,w];return g.add(L),()=>{g.delete(L)}},_update(m,w){let L,K,R=0;switch(m){case P:{const b=w.filter(([h,z])=>s._sizes[h]!==z);if(!b.length)break;if(!d){let h=0;if(l!==0)if(l>I()-Te)h=se(s,b,!0);else{const[z]=p;h=se(s,b.filter(([Se])=>Se<z))}h&&T(h)}let E=!1;b.forEach(([h,z])=>{Oe(s,h,z)&&(E=!0)}),a&&E&&!l&&ze(s),R+=X,c=K=!0;break}case D:{o!==w&&(o=w,R=X);break}case Ce:{if(w[1]){const b=I()-l,[E,h]=ne(s,w[0],!0),z=h?-N(E,b):E;T(z),G()||(l=V(l+z)),R=B}else ne(s,w[0]);break}case J:case ae:{if(l===w)break;if(m===J){const b=w-l,E=c;c=!1,(_===k||!E)&&!S&&C(b<0?de:fe),K=ve(b)>o,R+=xe}else d=!0;l=V(w),R+=B;break}case Y:{C(k)&&(L=!0,R=B),S=d=!1;break}case _e:{d=!1,S=!0;break}}R&&(L&&f&&(c=!0,u+=f,f=0,r++),g.forEach(([b,E])=>{R&b&&E(K)}))}}},ke=ce?x.useLayoutEffect:x.useEffect,me=(e,t,n)=>he(s=>{if(e._getScrollDirection()!==k&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const i=e._getScrollOffset();i>0&&i<e._getScrollOffsetMax()&&n()}},50),pe=(e,t,n,s)=>Le(e)||s?-n:t._getScrollOffsetMax()-n,We=(e,t)=>{let n,s,i=!1;const a=t?"scrollLeft":"scrollTop",o=(r,u)=>t&&F()?pe(n,e,r,u):r,l=async r=>{if(!n)return;const u=()=>W(r(),0,e._getScrollOffsetMax());for(;;){const f=u();if(e._update(ae,f),!e._hasUnmeasuredItemsInTargetViewport(f))break;s&&s[1]();const _=e._subscribe(X,()=>{s&&s[0]()});try{await new Promise((d,S)=>{let c=!1;const p=()=>{c||(c=!0,d(),s=void 0)};s=[p,S],j(p,250)})}catch{return}finally{_()}}n[a]=o(u()),e._update(_e)};return{_initRoot(r){n=r;let u=!1,f=!1;const _=()=>{e._update(J,o(r[a]))},d=le(()=>{if(u){d();return}f=!1,_(),e._update(Y)},150),S=()=>{f&&(i=!0),_(),d()},c=me(e,t,d),p=()=>{u=!0,f=i=!1},g=()=>{u=!1,G()&&(f=!0)};return r.addEventListener("scroll",S),r.addEventListener("wheel",c,{passive:!0}),r.addEventListener("touchstart",p,{passive:!0}),r.addEventListener("touchend",g,{passive:!0}),()=>{r.removeEventListener("scroll",S),r.removeEventListener("wheel",c),r.removeEventListener("touchstart",p),r.removeEventListener("touchend",g),d._cancel()}},_scrollTo(r){l(()=>r)},_scrollBy(r){r+=e._getScrollOffset(),l(()=>r)},_scrollToIndex(r,u){r=W(r,0,e._getItemsLength()-1),l(u==="end"?()=>e._getItemOffset(r)+e._getItemSize(r)-e._getViewportSize():u==="center"?()=>e._getItemOffset(r)+(e._getItemSize(r)-e._getViewportSize())/2:()=>e._getItemOffset(r))},_fixScrollJump:r=>{if(n){if(i){const u=n.style.overflow;n.style.overflow="hidden",i=!1,j(()=>{n.style.overflow=u})}n[a]+=o(r,!0)}}}},Pe=(e,t)=>{let n;const s=t?"scrollX":"scrollY",i=t?"offsetLeft":"offsetTop",a=(o,l)=>t&&F()?pe(n,e,o,l):o;return{_initRoot(o){n=o;let l=!1;const r=(c,p)=>{const g=p+(t&&F()?window.innerWidth-c[i]-c.offsetWidth:c[i]),v=c.offsetParent;return c===document.body||!v?g:r(v,g)},u=()=>{l&&e._update(J,a(window[s])-r(o,0))},f=le(()=>{u(),e._update(Y)},150),_=()=>{u(),f()},d=me(e,t,f),S=new IntersectionObserver(([c])=>{l=c.isIntersecting});return S.observe(o),window.addEventListener("scroll",_),window.addEventListener("wheel",d,{passive:!0}),()=>{S.disconnect(),window.removeEventListener("scroll",_),window.removeEventListener("wheel",d),f._cancel()}},_fixScrollJump:o=>{window.scrollBy(t?a(o,!0):0,t?0:o)}}},re="current",De={},ge=(e,t)=>{if(Ie(e))for(const n of e)ge(n,t);else!U(e)||typeof e=="boolean"||t.push(e)},Je=e=>{const t=[];return ge(e,t),t},Ue=(e,t,n)=>O(e-(n===fe?1:O(1,t)),0),Ke=(e,t,n,s)=>N(e+(n===de?1:O(1,t)),s-1),Be=e=>{const t=x.useRef();return t[re]||(t[re]=e())},we={box:"border-box"},je=(e,t)=>{let n;const s=t?"width":"height",i=new WeakMap,a=M(()=>new ResizeObserver(o=>{const l=[];for(const{target:r,contentRect:u}of o)if(r.offsetParent)if(r===n)e._update(D,u[s]+u[t?"left":"top"]+q(Z(n)[t?"paddingRight":"paddingBottom"]));else{const f=i.get(r);U(f)&&l.push([f,u[s]])}l.length&&e._update(P,l)}));return{_observeRoot(o){n=o;const l=a();return l.observe(o,we),()=>{l.disconnect()}},_observeItem(o,l){const r=a();return i.set(o,l),r.observe(o),()=>{i.delete(o),r.unobserve(o)}}}},qe=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",i=new WeakMap,a=M(()=>new ResizeObserver(o=>{const l=[];for(const{target:r,contentRect:u}of o){if(!r.offsetParent)continue;const f=i.get(r);U(f)&&l.push([f,u[n]])}l.length&&e._update(P,l)}));return{_observeRoot(){const o=()=>{e._update(D,window[s])};return window.addEventListener("resize",o),o(),()=>{window.removeEventListener("resize",o),a().disconnect()}},_observeItem(o,l){const r=a();return i.set(o,l),r.observe(o),()=>{i.delete(o),r.unobserve(o)}}}},Fe=(e,t)=>{let n;const s="height",i="width",a=new WeakMap,o=new Set,l=new Set,r=new Map,u=(_,d)=>`${_}-${d}`,f=M(()=>new ResizeObserver(_=>{const d=new Set,S=new Set;for(const{target:c,contentRect:p}of _)if(c.offsetParent)if(c===n){const g=Z(n);e._update(D,p[s]+p.top+q(g.paddingBottom)),t._update(D,p[i]+p.left+q(g.paddingRight))}else{const g=a.get(c);if(g){const[v,I]=g,V=u(v,I),T=r.get(V),C=[p[s],p[i]];let m,w;T?(T[0]!==C[0]&&(m=!0),T[1]!==C[1]&&(w=!0)):m=w=!0,m&&d.add(v),w&&S.add(I),(m||w)&&r.set(V,C)}}if(d.size){const c=[];d.forEach(p=>{let g=0;l.forEach(v=>{const I=r.get(u(p,v));I&&(g=O(g,I[0]))}),g&&c.push([p,g])}),e._update(P,c)}if(S.size){const c=[];S.forEach(p=>{let g=0;o.forEach(v=>{const I=r.get(u(v,p));I&&(g=O(g,I[1]))}),g&&c.push([p,g])}),t._update(P,c)}}));return{_observeRoot(_){n=_;const d=f();return d.observe(_,we),()=>{d.disconnect()}},_observeItem(_,d,S){const c=f();return a.set(_,[d,S]),o.add(d),l.add(S),c.observe(_),()=>{a.delete(_),c.unobserve(_)}}}},oe=x.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:i},a)=>$("div",{ref:a,...t,children:$("div",{style:x.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:i?"none":"auto"}),[n,s,i]),children:e})}));try{oe.displayName="Viewport",oe.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}const ie=()=>[],Ge=()=>x.useReducer(ie,void 0,ie)[1];export{Ce as A,k as S,B as U,oe as V,Ge as a,ke as b,X as c,De as d,U as e,Je as f,Ve as g,qe as h,Pe as i,Ke as j,Ue as k,F as l,Fe as m,We as n,xe as o,je as p,re as r,Be as u,Me as v};
//# sourceMappingURL=useRerender-ac310dfc.js.map
