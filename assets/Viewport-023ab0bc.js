import{r as h}from"./index-c6dae603.js";import{r as ce}from"./index-eb008d06.js";import{j as Q}from"./jsx-runtime-c3d7f245.js";const W=Math.min,T=Math.max,fe=Math.abs,Y=Date.now,Te=Object.values,se=setTimeout,M=(e,t,n)=>W(n,T(t,e)),J=e=>e!=null,ae=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},ne=(e,t)=>{let n;const s=()=>{J(n)&&clearTimeout(n)},r=()=>{s(),n=se(()=>{n=null,e()},t)};return r._cancel=s,r},de=(e,t)=>{let n=Y()-t;return(...s)=>{const r=Y();n+t<r&&(n=r,e(...s))}},K=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},R=-1,y=(e,t)=>{const n=e._sizes[t];return n===R?e._defaultItemSize:n},_e=(e,t,n)=>{const s=e._sizes[t]===R;return e._sizes[t]=n,e._measuredOffsetIndex=W(t,e._measuredOffsetIndex),s},X=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let n=e._measuredOffsetIndex,s=e._offsets[n];for(;n<t;)s+=y(e,n),e._offsets[++n]=s;return e._measuredOffsetIndex=t,s},me=e=>e._length?X(e,e._length-1)+y(e,e._length-1):0,G=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=y(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=y(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return M(t,0,e._length-1)},$=(e,t,n)=>G(e,n,t-X(e,n)),pe=(e,t,n)=>e._sizes.slice(t,n+1).includes(R),ge=e=>{const t=e._sizes.filter(s=>s!==R),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:ae(t)},re=(e,t,n)=>{const s=n?"unshift":"push";for(let r=e._length;r<t;r++)e._sizes[s](R),e._offsets.push(r===0?0:R);e._length=t},Se=(e,t)=>{const n={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return re(n,e),n},H=(e,t,n)=>{const s=t-e._length,r=s<0;let f;return r?(f=(n?e._sizes.splice(0,-s):e._sizes.splice(s)).reduce((i,o)=>i+(o===R?e._defaultItemSize:o),0),e._offsets.splice(s)):(f=e._defaultItemSize*s,re(e,e._length+s,n)),e._measuredOffsetIndex=n?0:M(t-1,0,e._measuredOffsetIndex),e._length=t,[f,r]},q=(e,t)=>t.reduce((n,[s,r])=>n+(r-y(e,s)),0),we=1.5,C=0,Ie=1,ee=2,V=1,k=2,Ee=3,D=4,oe=5,F=6,ie=7,j=1,N=2,B=4,Z=8,be=16,Ce=(e,t=40,n=0,s=Se(e,t),r,f)=>{let i=t*T(n-1,0),o=0,u=0,l=0,c=C,_=!1,a=!1,w=!1,p=[0,n];const g=new Set,S=()=>me(s),O=()=>S()-i,v=m=>M(m,0,O()),A=m=>{const d=c;return c=m,c!==d&&(c===C||d===C)};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){const[m,d]=p,E=$(s,o,m),I=G(s,E,i);return m===E&&d===I?p:p=[E,I]},_isUnmeasuredItem(m){return s._sizes[m]===R},_hasUnmeasuredItemsInTargetViewport(m){const d=$(s,m,p[0]);return pe(s,T(0,d-1),W(s._length-1,G(s,d,i)+1))},_getItemOffset(m){const d=X(s,m);return r?d+T(0,i-S()):d},_getItemSize(m){return y(s,m)},_getItemsLength(){return s._length},_getScrollOffset(){return o},_getScrollOffsetMax:O,_getIsScrolling(){return c!==C},_getViewportSize(){return i},_getCorrectedScrollSize(){return T(S(),i)},_getJumpCount(){return u},_flushJump(){const m=l;return l=0,m},_subscribe(m,d){const E=[m,d];return g.add(E),()=>{g.delete(E)}},_update(m,d){let E,I=0;switch(m){case V:{const b=d.filter(([L,x])=>s._sizes[L]!==x);if(!b.length)break;let z=0;if(_||a){if(o!==0)if(o>O()-we)z=q(s,b);else{const[L]=p;z=q(s,b.filter(([x])=>x<L))}}else c===ee&&(z=q(s,b));z&&(l=z,u++,I+=B);let U=!1;b.forEach(([L,x])=>{_e(s,L,x)&&(U=!0)}),f&&U&&!o&&ge(s),I+=N,w=E=!0;break}case k:{i!==d&&(i=d,I=N);break}case Ee:{if(d[1]){const b=O()-o,[z,U]=H(s,d[0],!0),L=U?-W(z,b):z;l+=L,o=v(o+L),u++,I=j+B,_=!0}else H(s,d[0]);break}case D:case oe:{if(o===d)break;if(m===D){const b=w;w=!1,(c===C||!b)&&!a&&A(o>d?ee:Ie)&&(I+=Z),E=fe(o-d)>i,I+=be,b||(_=!1)}o=v(d),I+=j;break}case F:{A(C)&&(I=Z),_=a=!1;break}case ie:{a=!0;break}}I&&g.forEach(([b,z])=>{I&b&&z(E)})}}},Oe=typeof window<"u"?h.useLayoutEffect:h.useEffect,P="current",ye={},le=(e,t)=>{if(Array.isArray(e))for(const n of e)le(n,t);else!J(e)||typeof e=="boolean"||t.push(e)},Ne=e=>{const t=[];return le(e,t),t},ve=e=>{const t=h.useRef(e);return Oe(()=>{t[P]=e},[e]),t},Ae=j+N,xe=N,Me=B,Ve=Z,ke=N,Ue=(e,t,n,s)=>{const[r,f]=h.useState(t),i=ve(t);if(h.useLayoutEffect(()=>{const o=()=>{f(()=>i[P]())};return e._subscribe(n,u=>{u?ce.flushSync(o):o()})},[]),s){const o=t();r!==o&&f(o)}return r},ze=K(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),ue=(e,t,n)=>de(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),We=(e,t,n)=>{let s,r;const f=t?"scrollLeft":"scrollTop",i=()=>s?t?s.scrollWidth:s.scrollHeight:0,o=(l,c)=>t&&n?ze(s)||c?-l:e._getScrollOffsetMax()-l:l,u=async l=>{if(!s)return;const c=()=>M(l(),0,i()-e._getViewportSize());for(;;){const _=c();if(e._update(oe,_),!e._hasUnmeasuredItemsInTargetViewport(_))break;r&&r[1]();const a=e._subscribe(N,()=>{r&&r[0]()});try{await new Promise((w,p)=>{let g=!1;const S=()=>{g||(g=!0,w(),r=void 0)};r=[S,p],se(S,250)})}catch{return}finally{a()}}s[f]=o(c()),e._update(ie)};return{_initRoot(l){s=l;const c=()=>{e._update(D,o(l[f]))},_=ne(()=>{c(),e._update(F)},150),a=()=>{c(),_()},w=ue(e,t,_);return l.addEventListener("scroll",a),l.addEventListener("wheel",w,{passive:!0}),()=>{l.removeEventListener("scroll",a),l.removeEventListener("wheel",w),_._cancel()}},_getActualScrollSize:i,_scrollTo(l){u(()=>l)},_scrollBy(l){l+=e._getScrollOffset(),u(()=>l)},_scrollToIndex(l,c){l=M(l,0,e._getItemsLength()-1),u(c==="end"?()=>e._getItemOffset(l)+e._getItemSize(l)-e._getViewportSize():()=>e._getItemOffset(l))},_fixScrollJump:l=>{s&&(s[f]+=o(l,!0))}}},De=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let f=!1;const i=(a,w)=>{const p=w+a[s],g=a.offsetParent;return a===document.body||!g?p:i(g,p)},o=()=>{f&&e._update(D,window[n]-i(r,0))},u=ne(()=>{o(),e._update(F)},150),l=()=>{o(),u()},c=ue(e,t,u),_=new IntersectionObserver(([a])=>{f=a.isIntersecting});return _.observe(r),window.addEventListener("scroll",l),window.addEventListener("wheel",c,{passive:!0}),()=>{_.disconnect(),window.removeEventListener("scroll",l),window.removeEventListener("wheel",c),u._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},Pe=e=>{const t=h.useRef();return t[P]||(t[P]=e())},Je=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,f=K(()=>new ResizeObserver(i=>{const o=[];for(const{target:u,contentRect:l}of i)if(u===n)e._update(k,l[s]);else{const c=r.get(u);J(c)&&o.push([c,l[s]])}o.length&&e._update(V,o)}));return{_observeRoot(i){n=i;const o=f();return o.observe(i),()=>{o.disconnect()}},_observeItem(i,o){const u=f();return r.set(i,o),u.observe(i),()=>{r.delete(i),u.unobserve(i)}}}},Ke=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,f=K(()=>new ResizeObserver(i=>{const o=[];for(const{target:u,contentRect:l}of i){const c=r.get(u);J(c)&&o.push([c,l[n]])}o.length&&e._update(V,o)}));return{_observeRoot(){const i=()=>{e._update(k,window[s])};return window.addEventListener("resize",i),i(),()=>{window.removeEventListener("resize",i),f().disconnect()}},_observeItem(i,o){const u=f();return r.set(i,o),u.observe(i),()=>{r.delete(i),u.unobserve(i)}}}},qe=(e,t)=>{let n;const s="height",r="width",f=new WeakMap,i=new Set,o=new Set,u=new Map,l=(_,a)=>`${_}-${a}`,c=K(()=>new ResizeObserver(_=>{const a=new Set,w=new Set;for(const{target:p,contentRect:g}of _)if(p===n)e._update(k,g[s]),t._update(k,g[r]);else{const S=f.get(p);if(S){const[O,v]=S,A=l(O,v),m=u.get(A),d=[g[s],g[r]];let E,I;m?(m[0]!==d[0]&&(E=!0),m[1]!==d[1]&&(I=!0)):E=I=!0,E&&a.add(O),I&&w.add(v),(E||I)&&u.set(A,d)}}if(a.size){const p=[];a.forEach(g=>{let S=0;o.forEach(O=>{const v=u.get(l(g,O));v&&(S=T(S,v[0]))}),S&&p.push([g,S])}),e._update(V,p)}if(w.size){const p=[];w.forEach(g=>{let S=0;i.forEach(O=>{const v=u.get(l(O,g));v&&(S=T(S,v[1]))}),S&&p.push([g,S])}),t._update(V,p)}}));return{_observeRoot(_){n=_;const a=c();return a.observe(_),()=>{a.disconnect()}},_observeItem(_,a,w){const p=c();return f.set(_,[a,w]),i.add(a),o.add(w),p.observe(_),()=>{f.delete(_),p.unobserve(_)}}}},te=h.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},f)=>Q("div",{ref:f,...t,children:Q("div",{style:h.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{te.displayName="Viewport",te.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Ee as A,Ae as S,be as U,te as V,Pe as a,Ue as b,Oe as c,ye as d,J as e,Ne as f,Ce as g,Ke as h,De as i,Ve as j,Me as k,xe as l,T as m,W as n,ke as o,qe as p,We as q,P as r,Je as s,ve as u,Te as v};
//# sourceMappingURL=Viewport-023ab0bc.js.map
