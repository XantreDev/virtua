import{r as z}from"./index-c6dae603.js";import{r as oe}from"./index-eb008d06.js";import{j as B}from"./jsx-runtime-c3d7f245.js";const L=Math.min,h=Math.max,ie=Math.abs,G=Date.now,he=Object.values,Q=setTimeout,k=e=>e!=null,le=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},Y=(e,t)=>{let n;const s=()=>{k(n)&&clearTimeout(n)},r=()=>{s(),n=Q(()=>{n=null,e()},t)};return r._cancel=s,r},ue=(e,t)=>{let n=G()-t;return(...s)=>{const r=G();n+t<r&&(n=r,e(...s))}},W=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},R=-1,C=(e,t)=>{const n=e._sizes[t];return n===R?e._defaultItemSize:n},ce=(e,t,n)=>{const s=e._sizes[t]===R;return e._sizes[t]=n,e._measuredOffsetIndex=L(t,e._measuredOffsetIndex),s},K=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let n=e._measuredOffsetIndex,s=e._offsets[n];for(;n<t;)s+=C(e,n),e._offsets[++n]=s;return e._measuredOffsetIndex=t,s},fe=e=>e._length?K(e,e._length-1)+C(e,e._length-1):0,P=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=C(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=C(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return L(e._length-1,h(0,t))},Z=(e,t,n)=>P(e,n,t-K(e,n)),ae=(e,t,n)=>e._sizes.slice(t,n+1).includes(R),de=e=>{const t=e._sizes.filter(s=>s!==R),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:le(t)},$=(e,t)=>{for(let n=e._length;n<t;n++)e._sizes.push(R),e._offsets.push(n===0?0:R);e._length=t},_e=(e,t)=>{const n={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return $(n,e),n},me=(e,t)=>{const n=t-e._length;if(n>0)$(e,t);else{for(let s=n;s<0;s++)e._sizes.pop(),e._offsets.pop();e._length=t,e._measuredOffsetIndex=L(e._measuredOffsetIndex,t-1)}},D=(e,t)=>t.reduce((n,[s,r])=>n+(r-C(e,s)),0),pe=1.5,y=0,ge=1,X=2,A=1,M=2,V=3,H=4,q=5,ee=6,te=1,T=2,se=4,J=8,Se=16,ze=(e,t=40,n=0,s=_e(e,t),r,_)=>{let i=t*h(n-1,0),l=0,a=0,w=0,o=y,c=!1,f=!1,p=[0,n];const d=new Set,g=()=>fe(s),S=()=>g()-i,O=u=>{const m=o;return o=u,o!==m&&(o===y||m===y)};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){const[u,m]=p,b=Z(s,l,u),I=P(s,b,i);return u===b&&m===I?p:p=[b,I]},_isUnmeasuredItem(u){return s._sizes[u]===R},_hasUnmeasuredItemsInTargetViewport(u){const m=Z(s,u,p[0]);return ae(s,h(0,m-1),L(s._length-1,P(s,m,i)+1))},_getItemOffset(u){const m=K(s,u);return r?m+h(0,i-g()):m},_getItemSize(u){return C(s,u)},_getItemLength(){return s._length},_getScrollOffset(){return l},_getScrollOffsetMax:S,_getIsScrolling(){return o!==y},_getViewportSize(){return i},_getCorrectedScrollSize(){return h(g(),i)},_getJumpCount(){return a},_flushJump(){const u=w;return w=0,u},_subscribe(u,m){const b=[u,m];return d.add(b),()=>{d.delete(b)}},_update(u,m){let b,I=0;switch(u){case A:{const E=m.filter(([x,N])=>s._sizes[x]!==N);if(!E.length)break;let v=0;if(o===X)v=D(s,E);else if(c){const[x]=p;l===0||(l>S()-pe?v=D(s,E):v=D(s,E.filter(([N])=>N<x)))}v&&(w=v,a++,I+=se);let j=!1;E.forEach(([x,N])=>{ce(s,x,N)&&(j=!0)}),_&&j&&!l&&de(s),I+=T,f=b=!0;break}case M:{i!==m&&(i=m,I=T);break}case V:case H:{if(l===m)break;if(u===V){const E=f;f=!1,(o===y||!E)&&!c&&O(l>m?X:ge)&&(I+=J),b=ie(l-m)>i,I+=Se}l=L(S(),h(0,m)),I+=te;break}case q:{O(y)&&(I=J),c=!1;break}case ee:{c=!0;break}}I&&d.forEach(([E,v])=>{I&E&&v(b)})},_updateCacheLength(u){s._length!==u&&me(s,u)}}},we=typeof window<"u"?z.useLayoutEffect:z.useEffect,U="current",Le={},ne=(e,t)=>{if(Array.isArray(e))for(const n of e)ne(n,t);else!k(e)||typeof e=="boolean"||t.push(e)},Re=e=>{const t=[];return ne(e,t),t},Ie=e=>{const t=z.useRef(e);return we(()=>{t[U]=e},[e]),t},ye=te+T,Ce=T,Te=se,xe=J,Ne=T,Ae=(e,t,n,s)=>{const[r,_]=z.useState(t),i=Ie(t);if(z.useLayoutEffect(()=>{const l=()=>{_(()=>i[U]())};return e._subscribe(n,a=>{a?oe.flushSync(l):l()})},[]),s){const l=t();r!==l&&_(l)}return r},be=W(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),re=(e,t,n)=>ue(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),Me=(e,t,n)=>{let s,r;const _=t?"scrollLeft":"scrollTop",i=()=>s?t?s.scrollWidth:s.scrollHeight:0,l=(o,c)=>t&&n?be(s)||c?-o:e._getScrollOffsetMax()-o:o,a=async o=>{if(!s)return;const c=()=>L(o(),i()-e._getViewportSize());for(;;){const f=c();if(e._update(H,f),!e._hasUnmeasuredItemsInTargetViewport(f))break;r&&r[1]();const p=e._subscribe(T,()=>{r&&r[0]()});try{await new Promise((d,g)=>{let S=!1;const O=()=>{S||(S=!0,d(),r=void 0)};r=[O,g],Q(O,250)})}catch{return}finally{p()}}s[_]=l(c()),e._update(ee)},w=o=>{o=h(o,0),a(()=>o)};return{_initRoot(o){s=o;const c=()=>{e._update(V,l(o[_]))},f=Y(()=>{c(),e._update(q)},150),p=()=>{c(),f()},d=re(e,t,f);return o.addEventListener("scroll",p),o.addEventListener("wheel",d,{passive:!0}),()=>{o.removeEventListener("scroll",p),o.removeEventListener("wheel",d),f._cancel()}},_getActualScrollSize:i,_scrollTo:w,_scrollBy(o){w(e._getScrollOffset()+o)},_scrollToIndex(o,c){o=L(e._getItemLength()-1,h(0,o)),a(c==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{s&&(s[_]+=l(o,!0))}}},Ve=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let _=!1;const i=(f,p)=>{const d=p+f[s],g=f.offsetParent;return f===document.body||!g?d:i(g,d)},l=()=>{_&&e._update(V,window[n]-i(r,0))},a=Y(()=>{l(),e._update(q)},150),w=()=>{l(),a()},o=re(e,t,a),c=new IntersectionObserver(([f])=>{_=f.isIntersecting});return c.observe(r),window.addEventListener("scroll",w),window.addEventListener("wheel",o,{passive:!0}),()=>{c.disconnect(),window.removeEventListener("scroll",w),window.removeEventListener("wheel",o),a._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},Ue=e=>{const t=z.useRef();return t[U]||(t[U]=e())},ke=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,_=W(()=>new ResizeObserver(i=>{const l=[];for(const{target:a,contentRect:w}of i)if(a===n)e._update(M,w[s]);else{const o=r.get(a);k(o)&&l.push([o,w[s]])}l.length&&e._update(A,l)}));return{_observeRoot(i){n=i;const l=_();return l.observe(i),()=>{l.disconnect()}},_observeItem(i,l){const a=_();return r.set(i,l),a.observe(i),()=>{r.delete(i),a.unobserve(i)}}}},We=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,_=W(()=>new ResizeObserver(i=>{const l=[];for(const{target:a,contentRect:w}of i){const o=r.get(a);k(o)&&l.push([o,w[n]])}l.length&&e._update(A,l)}));return{_observeRoot(){const i=()=>{e._update(M,window[s])};return window.addEventListener("resize",i),i(),()=>{window.removeEventListener("resize",i),_().disconnect()}},_observeItem(i,l){const a=_();return r.set(i,l),a.observe(i),()=>{r.delete(i),a.unobserve(i)}}}},De=(e,t)=>{let n;const s="height",r="width",_=new WeakMap,i=new Set,l=new Set,a=new Map,w=(c,f)=>`${c}-${f}`,o=W(()=>new ResizeObserver(c=>{const f=new Set,p=new Set;for(const{target:d,contentRect:g}of c)if(d===n)e._update(M,g[s]),t._update(M,g[r]);else{const S=_.get(d);if(S){const[O,u]=S,m=w(O,u),b=a.get(m),I=[g[s],g[r]];let E,v;b?(b[0]!==I[0]&&(E=!0),b[1]!==I[1]&&(v=!0)):E=v=!0,E&&f.add(O),v&&p.add(u),(E||v)&&a.set(m,I)}}if(f.size){const d=[];f.forEach(g=>{let S=0;l.forEach(O=>{const u=a.get(w(g,O));u&&(S=h(S,u[0]))}),S&&d.push([g,S])}),e._update(A,d)}if(p.size){const d=[];p.forEach(g=>{let S=0;i.forEach(O=>{const u=a.get(w(O,g));u&&(S=h(S,u[1]))}),S&&d.push([g,S])}),t._update(A,d)}}));return{_observeRoot(c){n=c;const f=o();return f.observe(c),()=>{f.disconnect()}},_observeItem(c,f,p){const d=o();return _.set(c,[f,p]),i.add(f),l.add(p),d.observe(c),()=>{_.delete(c),d.unobserve(c)}}}},F=z.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},_)=>B("div",{ref:_,...t,children:B("div",{style:z.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{F.displayName="Viewport",F.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{ye as S,Se as U,F as V,Ue as a,Ae as b,we as c,Le as d,k as e,Re as f,ze as g,We as h,Ve as i,xe as j,Te as k,Ce as l,h as m,L as n,Ne as o,De as p,Me as q,U as r,ke as s,Ie as u,he as v};
//# sourceMappingURL=Viewport-723ea047.js.map
