import{r as N}from"./index-c6dae603.js";import{j as H}from"./jsx-runtime-c3d7f245.js";const V=Math.min,O=Math.max,be=Math.abs,ee=Date.now,Ve=Object.values,Ie=Array.isArray,q=setTimeout,D=(e,t,n)=>V(n,O(t,e)),K=e=>e!=null,he=e=>{const t=[...e].sort((s,i)=>s-i),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},ue=(e,t)=>{let n;const s=()=>{K(n)&&clearTimeout(n)},i=()=>{s(),n=q(()=>{n=null,e()},t)};return i._cancel=s,i},Oe=(e,t)=>{let n=ee()-t;return(...s)=>{const i=ee();n+t<i&&(n=i,e(...s))}},k=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},Z=e=>getComputedStyle(e),F=e=>e?parseFloat(e):0,z=-1,M=(e,t)=>{const n=e._sizes[t];return n===z?e._defaultItemSize:n},Ee=(e,t,n)=>{const s=e._sizes[t]===z;return e._sizes[t]=n,e._computedOffsetIndex=V(t,e._computedOffsetIndex),s},Q=(e,t)=>{if(!e._length)return 0;if(e._computedOffsetIndex>=t)return e._offsets[t];let n=e._computedOffsetIndex,s=e._offsets[n];for(;n<t;)s+=M(e,n),e._offsets[++n]=s;return e._computedOffsetIndex=t,s},Re=e=>e._length?Q(e,e._length-1)+M(e,e._length-1):0,te=(e,t,n)=>{let s=Q(e,n);for(;n>=0&&n<e._length;)if(s<=t){const i=M(e,n);if(s+i>t)break;s+=i,n++}else s-=M(e,--n);return D(n,0,e._length-1)},ne=(e,t,n,s)=>{const i=te(e,t,V(n,e._length-1));return[i,te(e,t+s,i)]},ye=(e,t,n)=>e._sizes.slice(O(0,t-1),V(e._length-1,n+1)+1).includes(z),ze=e=>{const t=e._sizes.filter(s=>s!==z),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:he(t)},ce=(e,t,n)=>{const s=n?"unshift":"push";for(let i=e._length;i<t;i++)e._sizes[s](z),e._offsets.push(i===0?0:z);e._length=t},Le=(e,t)=>{const n={_defaultItemSize:t,_length:0,_computedOffsetIndex:0,_sizes:[],_offsets:[]};return ce(n,e),n},se=(e,t,n)=>{const s=t-e._length,i=s<0;let a;return i?(a=(n?e._sizes.splice(0,-s):e._sizes.splice(s)).reduce((o,l)=>o+(l===z?e._defaultItemSize:l),0),e._offsets.splice(s)):(a=e._defaultItemSize*s,ce(e,e._length+s,n)),e._computedOffsetIndex=n?0:D(t-1,0,e._computedOffsetIndex),e._length=t,[a,i]},Y=typeof window<"u",Te=k(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),G=k(()=>Y?Z(document.body).direction==="rtl":!1),fe=k(()=>Y?/iP(hone|od|ad)/.test(navigator.userAgent):!1),re=(e,t,n)=>t.reduce((s,[i,a])=>{const o=a-M(e,i);return(!n||o>0)&&(s+=o),s},0),Ce=1.5,W=0,de=1,ae=2,P=1,J=2,xe=3,U=4,_e=5,$=6,me=7,j=1,X=2,Ae=4,ke=(e,t=40,n=0,s=Le(e,t),i,a)=>{let o=t*O(n-1,0),l=0,r=0,c=0,f=0,_=W,d=!1,w=!1,u=!1,p=[0,n];const g=fe(),v=new Set,b=()=>Re(s),L=()=>b()-o,x=m=>D(m,0,L()),A=m=>{g&&_!==W?f+=m:(c+=m,r++)},T=m=>{const S=_;return _=m,_!==S};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){return p=ne(s,l+f,p[0],o)},_isUnmeasuredItem(m){return s._sizes[m]===z},_hasUnmeasuredItemsInTargetViewport(m){const[S,C]=ne(s,m,p[0],o);return ye(s,S,C)},_getItemOffset(m){const S=Q(s,m)-f;return i?S+O(0,o-b()):S},_getItemSize(m){return M(s,m)},_getItemsLength(){return s._length},_getScrollOffset(){return l},_getScrollOffsetMax:L,_getScrollDirection(){return _},_getViewportSize(){return o},_getCorrectedScrollSize(){return O(b(),o)},_getJumpCount(){return r},_flushJump(){const m=c;return c=0,m},_subscribe(m,S){const C=[m,S];return v.add(C),()=>{v.delete(C)}},_update(m,S){let C,B,R=0;switch(m){case P:{const I=S.filter(([h,y])=>s._sizes[h]!==y);if(!I.length)break;if(!d){let h=0;if(l!==0)if(l>L()-Ce)h=re(s,I,!0);else{const[y]=p;h=re(s,I.filter(([ve])=>ve<y))}h&&A(h)}let E=!1;I.forEach(([h,y])=>{Ee(s,h,y)&&(E=!0)}),a&&E&&!l&&ze(s),R+=X,u=B=!0;break}case J:{o!==S&&(o=S,R=X);break}case xe:{if(S[1]){const I=L()-l,[E,h]=se(s,S[0],!0),y=h?-V(E,I):E;A(y),g||(l=x(l+y)),R=j}else se(s,S[0]);break}case U:case _e:{if(l===S)break;if(m===U){const I=S-l,E=u;u=!1,(_===W||!E)&&!w&&T(I<0?ae:de),B=be(I)>o,R+=Ae}else d=!0;l=x(S),R+=j;break}case $:{T(W)&&(C=!0,R=j),w=d=!1;break}case me:{d=!1,w=!0;break}}R&&(C&&f&&(u=!0,c+=f,f=0,r++),v.forEach(([I,E])=>{R&I&&E(B)}))}}},We=Y?N.useLayoutEffect:N.useEffect,pe=(e,t,n)=>Oe(s=>{if(e._getScrollDirection()!==W&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const i=e._getScrollOffset();i>0&&i<e._getScrollOffsetMax()&&n()}},50),ge=(e,t,n,s)=>Te(e)||s?-n:t._getScrollOffsetMax()-n,De=(e,t)=>{let n,s,i=!1;const a=t?"scrollLeft":"scrollTop",o=(r,c)=>t&&G()?ge(n,e,r,c):r,l=async r=>{if(!n)return;const c=()=>D(r(),0,e._getScrollOffsetMax());for(;;){const f=c();if(e._update(_e,f),!e._hasUnmeasuredItemsInTargetViewport(f))break;s&&s[1]();const _=e._subscribe(X,()=>{s&&s[0]()});try{await new Promise((d,w)=>{let u=!1;const p=()=>{u||(u=!0,d(),s=void 0)};s=[p,w],q(p,250)})}catch{return}finally{_()}}n[a]=o(c()),e._update(me)};return{_initRoot(r){n=r;let c=!1,f=!1;const _=()=>{e._update(U,o(r[a]))},d=ue(()=>{if(c){d();return}f=!1,_(),e._update($)},150),w=()=>{f&&(i=!0),_(),d()},u=pe(e,t,d),p=()=>{c=!0,f=i=!1},g=()=>{c=!1,fe()&&(f=!0)};return r.addEventListener("scroll",w),r.addEventListener("wheel",u,{passive:!0}),r.addEventListener("touchstart",p,{passive:!0}),r.addEventListener("touchend",g,{passive:!0}),()=>{r.removeEventListener("scroll",w),r.removeEventListener("wheel",u),r.removeEventListener("touchstart",p),r.removeEventListener("touchend",g),d._cancel()}},_scrollTo(r){l(()=>r)},_scrollBy(r){r+=e._getScrollOffset(),l(()=>r)},_scrollToIndex(r,c){r=D(r,0,e._getItemsLength()-1),l(c==="end"?()=>e._getItemOffset(r)+e._getItemSize(r)-e._getViewportSize():()=>e._getItemOffset(r))},_fixScrollJump:r=>{if(n){if(i){const c=n.style.overflow;n.style.overflow="hidden",i=!1,q(()=>{n.style.overflow=c})}n[a]+=o(r,!0)}}}},Pe=(e,t)=>{let n;const s=t?"scrollX":"scrollY",i=t?"offsetLeft":"offsetTop",a=(o,l)=>t&&G()?ge(n,e,o,l):o;return{_initRoot(o){n=o;let l=!1;const r=(u,p)=>{const g=p+(t&&G()?window.innerWidth-u[i]-u.offsetWidth:u[i]),v=u.offsetParent;return u===document.body||!v?g:r(v,g)},c=()=>{l&&e._update(U,a(window[s])-r(o,0))},f=ue(()=>{c(),e._update($)},150),_=()=>{c(),f()},d=pe(e,t,f),w=new IntersectionObserver(([u])=>{l=u.isIntersecting});return w.observe(o),window.addEventListener("scroll",_),window.addEventListener("wheel",d,{passive:!0}),()=>{w.disconnect(),window.removeEventListener("scroll",_),window.removeEventListener("wheel",d),f._cancel()}},_fixScrollJump:o=>{window.scrollBy(t?a(o,!0):0,t?0:o)}}},oe="current",Je={},we=(e,t)=>{if(Ie(e))for(const n of e)we(n,t);else!K(e)||typeof e=="boolean"||t.push(e)},Ue=e=>{const t=[];return we(e,t),t},Ke=(e,t,n)=>O(e-(n===de?1:O(1,t)),0),Be=(e,t,n,s)=>V(e+(n===ae?1:O(1,t)),s-1),je=e=>{const t=N.useRef();return t[oe]||(t[oe]=e())},Se={box:"border-box"},qe=(e,t)=>{let n;const s=t?"width":"height",i=new WeakMap,a=k(()=>new ResizeObserver(o=>{const l=[];for(const{target:r,contentRect:c}of o)if(r.offsetParent)if(r===n)e._update(J,c[s]+c[t?"left":"top"]+F(Z(n)[t?"paddingRight":"paddingBottom"]));else{const f=i.get(r);K(f)&&l.push([f,c[s]])}l.length&&e._update(P,l)}));return{_observeRoot(o){n=o;const l=a();return l.observe(o,Se),()=>{l.disconnect()}},_observeItem(o,l){const r=a();return i.set(o,l),r.observe(o),()=>{i.delete(o),r.unobserve(o)}}}},Fe=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",i=new WeakMap,a=k(()=>new ResizeObserver(o=>{const l=[];for(const{target:r,contentRect:c}of o){if(!r.offsetParent)continue;const f=i.get(r);K(f)&&l.push([f,c[n]])}l.length&&e._update(P,l)}));return{_observeRoot(){const o=()=>{e._update(J,window[s])};return window.addEventListener("resize",o),o(),()=>{window.removeEventListener("resize",o),a().disconnect()}},_observeItem(o,l){const r=a();return i.set(o,l),r.observe(o),()=>{i.delete(o),r.unobserve(o)}}}},Ge=(e,t)=>{let n;const s="height",i="width",a=new WeakMap,o=new Set,l=new Set,r=new Map,c=(_,d)=>`${_}-${d}`,f=k(()=>new ResizeObserver(_=>{const d=new Set,w=new Set;for(const{target:u,contentRect:p}of _)if(u.offsetParent)if(u===n){const g=Z(n);e._update(J,p[s]+p.top+F(g.paddingBottom)),t._update(J,p[i]+p.left+F(g.paddingRight))}else{const g=a.get(u);if(g){const[v,b]=g,L=c(v,b),x=r.get(L),A=[p[s],p[i]];let T,m;x?(x[0]!==A[0]&&(T=!0),x[1]!==A[1]&&(m=!0)):T=m=!0,T&&d.add(v),m&&w.add(b),(T||m)&&r.set(L,A)}}if(d.size){const u=[];d.forEach(p=>{let g=0;l.forEach(v=>{const b=r.get(c(p,v));b&&(g=O(g,b[0]))}),g&&u.push([p,g])}),e._update(P,u)}if(w.size){const u=[];w.forEach(p=>{let g=0;o.forEach(v=>{const b=r.get(c(v,p));b&&(g=O(g,b[1]))}),g&&u.push([p,g])}),t._update(P,u)}}));return{_observeRoot(_){n=_;const d=f();return d.observe(_,Se),()=>{d.disconnect()}},_observeItem(_,d,w){const u=f();return a.set(_,[d,w]),o.add(d),l.add(w),u.observe(_),()=>{a.delete(_),u.unobserve(_)}}}},ie=N.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:i},a)=>H("div",{ref:a,...t,children:H("div",{style:N.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:i?"none":"auto"}),[n,s,i]),children:e})}));try{ie.displayName="Viewport",ie.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}const le=()=>[],Xe=()=>N.useReducer(le,void 0,le)[1];export{xe as A,W as S,j as U,ie as V,Xe as a,We as b,X as c,Je as d,K as e,Ue as f,ke as g,Fe as h,Pe as i,Be as j,Ke as k,G as l,Ge as m,De as n,Ae as o,qe as p,oe as r,je as u,Ve as v};
//# sourceMappingURL=useRerender-28f8f714.js.map
