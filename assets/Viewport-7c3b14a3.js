import{r as z}from"./index-c6dae603.js";import{r as ie}from"./index-eb008d06.js";import{j as F}from"./jsx-runtime-c3d7f245.js";const C=Math.min,O=Math.max,ce=Math.abs,G=Date.now,ze=Object.values,Y=setTimeout,T=e=>e!=null,ue=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},$=(e,t)=>{let n;const s=()=>{T(n)&&clearTimeout(n)},r=()=>{s(),n=Y(()=>{n=null,e()},t)};return r._cancel=s,r},le=(e,t)=>{let n=G()-t;return(...s)=>{const r=G();n+t<r&&(n=r,e(...s))}},P=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},L=-1,N=(e,t)=>{const n=e._sizes[t];return n===L?e._defaultItemSize:n},fe=(e,t,n)=>{const s=e._sizes[t]===L;return e._sizes[t]=n,e._measuredOffsetIndex=C(t,e._measuredOffsetIndex),s},H=(e,t,n)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return n?e._offsets[t]+N(e,t):e._offsets[t];let s=e._measuredOffsetIndex,r=e._offsets[s];for(;s<=t&&(e._offsets[s]=r,!(s===t&&!n));)r+=N(e,s),s++;return e._measuredOffsetIndex=t,r},ae=e=>H(e,e._length-1,!0),Z=(e,t)=>H(e,t),ee=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=N(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=N(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return C(O(t,0),e._length-1)},B=(e,t,n,s)=>ee(e,n,t-s),de=(e,t,n)=>{for(let s=t;s<=n;s++)if(e._sizes[s]===L)return!0;return!1},_e=e=>{const t=e._sizes.filter(s=>s!==L),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:ue(t)},me=(e,t)=>{const n=[],s=[];for(let r=0;r<e;r++)n.push(L),s.push(r===0?0:L);return{_defaultItemSize:t,_length:e,_measuredOffsetIndex:0,_sizes:n,_offsets:s}},pe=(e,t)=>{const n=[],s=[];for(let r=0;r<t;r++){const a=e._sizes[r];if(n.push(T(a)?a:L),r===0)s.push(0);else{const c=e._offsets[r];s.push(T(c)?c:L)}}e._length=t,e._measuredOffsetIndex=C(e._measuredOffsetIndex,t-1),e._sizes=n,e._offsets=s},J=(e,t)=>t.reduce((n,[s,r])=>n+(r-N(e,s)),0),Se=1.5,y=0,he=1,X=2,W=1,k=2,D=3,te=4,q=5,se=6,ne=1,x=2,re=4,K=8,ge=16,Le=(e,t,n=0,s,r)=>{const a=!t,c=t||40,o=r||me(e,c);let u=c*O(n-1,0),i=0,_=0,d=0,l=y,h=!1,S=!1,m=[0,n];const g=new Set,E=()=>ae(o),b=()=>E()-u,A=f=>{const p=l;return l=f,l!==p&&(l===y||p===y)};return{_getCache(){return JSON.parse(JSON.stringify(o))},_getRange(){const[f,p]=m,w=Z(o,f),I=B(o,i,f,w),v=ee(o,I,u);return f===I&&p===v?m:m=[I,v]},_isUnmeasuredItem(f){return o._sizes[f]===L},_hasUnmeasuredItemsInRange(f){return de(o,O(0,f-2),C(o._length-1,f+2))},_getItemOffset(f){const p=Z(o,f);return s?p+O(0,u-E()):p},_getItemSize(f){return N(o,f)},_getItemLength(){return o._length},_getScrollOffset(){return i},_getScrollOffsetMax:b,_getViewportSize(){return u},_getScrollSize:E,_getCorrectedScrollSize(){return O(E(),u)},_getJumpCount(){return _},_flushJump(){const f=d;return d=0,f},_getItemIndexForScrollTo(f){return B(o,f,0,0)},_subscribe(f,p){const w=[f,p];return g.add(w),()=>{g.delete(w)}},_update(f,p){let w,I=0;switch(f){case W:{const v=p.filter(([M,U])=>o._sizes[M]!==U);if(!v.length)break;let R=0;if(l===X)R=J(o,v);else if(h){const[M]=m;i===0||(i>b()-Se?R=J(o,v):R=J(o,v.filter(([U])=>U<M)))}R&&(d=R,_++,I+=re);let j=!1;v.forEach(([M,U])=>{fe(o,M,U)&&(j=!0)}),a&&j&&!i&&_e(o),I+=x,S=w=!0;break}case k:{u!==p&&(u=p,I=x);break}case D:case te:{if(i===p)break;if(f===D){const v=S;S=!1,(l===y||!v)&&!h&&A(i>p?X:he)&&(I+=K),w=ce(i-p)>u,I+=ge}i=O(0,C(b(),p)),I+=ne;break}case q:{A(y)&&(I=K),h=!1;break}case se:{h=!0;break}}I&&g.forEach(([v,R])=>{I&v&&R(w)})},_getIsScrolling(){return l!==y},_updateCacheLength(f){o._length!==f&&pe(o,f)}}},Ie=typeof window<"u"?z.useLayoutEffect:z.useEffect,V="current",Re={},Ce=e=>{const t=[];return z.Children.forEach(e,n=>{!T(n)||typeof n=="boolean"||t.push(n)}),t},we=e=>{const t=z.useRef(e);return Ie(()=>{t[V]=e},[e]),t},ye=ne+x,Te=x,Ne=re,xe=K,Ae=x,Me=(e,t,n,s)=>{const[r,a]=z.useState(t),c=we(t);if(z.useLayoutEffect(()=>{const o=()=>{a(()=>c[V]())};return e._subscribe(n,u=>{u?ie.flushSync(o):o()})},[]),s){const o=t();r!==o&&a(o)}return r},be=P(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),oe=(e,t,n)=>le(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),Ue=(e,t,n)=>{let s,r;const a=t?"scrollLeft":"scrollTop",c=()=>s?t?s.scrollWidth:s.scrollHeight:0,o=(i,_)=>t&&n?be(s)||_?-i:e._getScrollOffsetMax()-i:i,u=async(i,_)=>{if(!s)return;const d=()=>C(_(),c()-e._getViewportSize());for(;e._update(te,d()),!!e._hasUnmeasuredItemsInRange(i);){r&&r[1]();const l=e._subscribe(x,()=>{r&&r[0]()});try{await new Promise((h,S)=>{let m=!1;const g=()=>{m||(m=!0,h(),r=void 0)};r=[g,S],Y(g,250)})}catch{return}finally{l()}}s[a]=o(d()),e._update(se)};return{_initRoot(i){s=i;const _=()=>{e._update(D,o(i[a]))},d=$(()=>{_(),e._update(q)},150),l=()=>{_(),d()},h=oe(e,t,d);return i.addEventListener("scroll",l),i.addEventListener("wheel",h,{passive:!0}),()=>{i.removeEventListener("scroll",l),i.removeEventListener("wheel",h),d._cancel()}},_getActualScrollSize:c,_scrollTo(i){i=O(i,0),u(e._getItemIndexForScrollTo(i),()=>i)},_scrollToIndex(i){i=O(C(i,e._getItemLength()-1),0),u(i,()=>e._getItemOffset(i))},_fixScrollJump:i=>{s&&(s[a]+=o(i,!0))}}},We=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let a=!1;const c=(l,h)=>{const S=h+l[s],m=l.offsetParent;return l===document.body||!m?S:c(m,S)},o=()=>{a&&e._update(D,window[n]-c(r,0))},u=$(()=>{o(),e._update(q)},150),i=()=>{o(),u()},_=oe(e,t,u),d=new IntersectionObserver(([l])=>{a=l.isIntersecting});return d.observe(r),window.addEventListener("scroll",i),window.addEventListener("wheel",_,{passive:!0}),()=>{d.disconnect(),window.removeEventListener("scroll",i),window.removeEventListener("wheel",_),u._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},ke=e=>{const t=z.useRef();return t[V]||(t[V]=e())},De=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,a=P(()=>new ResizeObserver(c=>{const o=[];for(const{target:u,contentRect:i}of c)if(u===n)e._update(k,i[s]);else{const _=r.get(u);T(_)&&o.push([_,i[s]])}o.length&&e._update(W,o)}));return{_observeRoot(c){n=c;const o=a();return o.observe(c),()=>{o.disconnect()}},_observeItem(c,o){const u=a();return r.set(c,o),u.observe(c),()=>{r.delete(c),u.unobserve(c)}}}},Ve=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,a=P(()=>new ResizeObserver(c=>{const o=[];for(const{target:u,contentRect:i}of c){const _=r.get(u);T(_)&&o.push([_,i[n]])}o.length&&e._update(W,o)}));return{_observeRoot(){const c=()=>{e._update(k,window[s])};return window.addEventListener("resize",c),c(),()=>{window.removeEventListener("resize",c),a().disconnect()}},_observeItem(c,o){const u=a();return r.set(c,o),u.observe(c),()=>{r.delete(c),u.unobserve(c)}}}},Pe=(e,t)=>{let n;const s="height",r="width",a=new WeakMap,c=new Set,o=new Set,u=new Map,i=(d,l)=>`${d}-${l}`,_=P(()=>new ResizeObserver(d=>{const l=new Set,h=new Set;for(const{target:S,contentRect:m}of d)if(S===n)e._update(k,m[s]),t._update(k,m[r]);else{const g=a.get(S);if(g){const[E,b]=g,A=i(E,b),f=u.get(A),p=[m[s],m[r]];let w,I;f?(f[0]!==p[0]&&(w=!0),f[1]!==p[1]&&(I=!0)):w=I=!0,w&&l.add(E),I&&h.add(b),(w||I)&&u.set(A,p)}}if(l.size){const S=[];l.forEach(m=>{let g=0;o.forEach(E=>{const b=u.get(i(m,E));b&&(g=O(g,b[0]))}),g&&S.push([m,g])}),e._update(W,S)}if(h.size){const S=[];h.forEach(m=>{let g=0;c.forEach(E=>{const b=u.get(i(E,m));b&&(g=O(g,b[1]))}),g&&S.push([m,g])}),t._update(W,S)}}));return{_observeRoot(d){n=d;const l=_();return l.observe(d),()=>{l.disconnect()}},_observeItem(d,l,h){const S=_();return a.set(d,[l,h]),c.add(l),o.add(h),S.observe(d),()=>{a.delete(d),S.unobserve(d)}}}},Q=z.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},a)=>F("div",{ref:a,...t,children:F("div",{style:z.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{Q.displayName="Viewport",Q.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{ye as S,ge as U,Q as V,ke as a,Me as b,Ie as c,Re as d,T as e,Ce as f,Le as g,Ve as h,We as i,xe as j,Ne as k,Te as l,O as m,C as n,Ae as o,Pe as p,Ue as q,V as r,De as s,we as u,ze as v};
//# sourceMappingURL=Viewport-7c3b14a3.js.map
