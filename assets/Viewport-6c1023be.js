import{r as L}from"./index-c6dae603.js";import{j as Z}from"./jsx-runtime-c3d7f245.js";const N=Math.min,E=Math.max,me=Math.abs,Q=Date.now,xe=Object.values,ge=Array.isArray,re=setTimeout,V=(e,t,s)=>N(s,E(t,e)),K=e=>e!=null,Se=e=>{const t=[...e].sort((r,n)=>r-n),s=e.length/2|0;return t.length%2===0?(t[s-1]+t[s])/2:t[s]},oe=(e,t)=>{let s;const r=()=>{K(s)&&clearTimeout(s)},n=()=>{r(),s=re(()=>{s=null,e()},t)};return n._cancel=r,n},we=(e,t)=>{let s=Q()-t;return(...r)=>{const n=Q();s+t<n&&(s=n,e(...r))}},J=e=>{let t,s;return(...r)=>(t||(t=!0,s=e(...r)),s)},ie=e=>getComputedStyle(e),B=e=>e?parseFloat(e):0,y=-1,x=(e,t)=>{const s=e._sizes[t];return s===y?e._defaultItemSize:s},Ie=(e,t,s)=>{const r=e._sizes[t]===y;return e._sizes[t]=s,e._computedOffsetIndex=N(t,e._computedOffsetIndex),r},G=(e,t)=>{if(!e._length)return 0;if(e._computedOffsetIndex>=t)return e._offsets[t];let s=e._computedOffsetIndex,r=e._offsets[s];for(;s<t;)r+=x(e,s),e._offsets[++s]=r;return e._computedOffsetIndex=t,r},be=e=>e._length?G(e,e._length-1)+x(e,e._length-1):0,Y=(e,t,s)=>{let r=G(e,s);for(;s>=0&&s<e._length;)if(r<=t){const n=x(e,s);if(r+n>t)break;r+=n,s++}else r-=x(e,--s);return V(s,0,e._length-1)},$=(e,t,s,r)=>{const n=Y(e,t,N(s,e._length-1));return[n,Y(e,t+r,n)]},Oe=(e,t,s)=>e._sizes.slice(E(0,t-1),N(e._length-1,s+1)+1).includes(y),ve=e=>{const t=e._sizes.filter(r=>r!==y),s=t[0];e._defaultItemSize=t.every(r=>r===s)?s:Se(t)},le=(e,t,s)=>{const r=s?"unshift":"push";for(let n=e._length;n<t;n++)e._sizes[r](y),e._offsets.push(n===0?0:y);e._length=t},Re=(e,t)=>{const s={_defaultItemSize:t,_length:0,_computedOffsetIndex:0,_sizes:[],_offsets:[]};return le(s,e),s},H=(e,t,s)=>{const r=t-e._length,n=r<0;let c;return n?(c=(s?e._sizes.splice(0,-r):e._sizes.splice(r)).reduce((l,i)=>l+(i===y?e._defaultItemSize:i),0),e._offsets.splice(r)):(c=e._defaultItemSize*r,le(e,e._length+r,s)),e._computedOffsetIndex=s?0:V(t-1,0,e._computedOffsetIndex),e._length=t,[c,n]},q=(e,t,s)=>t.reduce((r,[n,c])=>{const l=c-x(e,n);return(!s||l>0)&&(r+=l),r},0),ze=1.5,P=0,ce=1,j=2,k=1,D=2,Ee=3,U=4,ue=5,X=6,fe=7,ee=1,F=2,te=4,se=8,he=16,Ne=(e,t,s=40,r=0,n=Re(t,s),c,l)=>{let i=s*E(r-1,0),o=0,f=0,m=0,d=P,u=!1,I=!1,g=!1,p=[0,r];const S=new Set,z=()=>be(n),b=()=>z()-i,A=a=>V(a,0,b()),T=a=>{const _=d;return d=a,d!==_};return{_getCache(){return JSON.parse(JSON.stringify(n))},_getRange(){const[a,_]=p,[w,O]=$(n,o,a,i);return a===w&&_===O?p:p=[w,O]},_isUnmeasuredItem(a){return n._sizes[a]===y},_hasUnmeasuredItemsInTargetViewport(a){const[_,w]=$(n,a,p[0],i);return Oe(n,_,w)},_getItemOffset(a){const _=G(n,a);return c?_+E(0,i-z()):_},_getItemSize(a){return x(n,a)},_getItemsLength(){return n._length},_getScrollOffset(){return o},_getScrollOffsetMax:b,_getScrollDirection(){return d},_getViewportSize(){return i},_getCorrectedScrollSize(){return E(z(),i)},_getJumpCount(){return f},_flushJump(){const a=m;return m=0,a},_subscribe(a,_){const w=[a,_];return S.add(w),()=>{S.delete(w)}},_update(a,_){let w,O=0;switch(a){case k:{const v=_.filter(([h,M])=>n._sizes[h]!==M);if(!v.length)break;let R=0;if(u||I){const[h]=p;o===0||(o>b()-ze?R=q(n,v,!0):R=q(n,v.filter(([M])=>M<h)))}else d===j&&(R=q(n,v));R&&(m=R,f++,O+=te);let C=!1;v.forEach(([h,M])=>{Ie(n,h,M)&&(C=!0)}),l&&C&&!o&&ve(n),O+=F,g=w=!0;break}case D:{i!==_&&(i=_,O=F);break}case Ee:{if(_[1]){const v=b()-o,[R,C]=H(n,_[0],!0),h=C?-N(R,v):R;m+=h,o=A(o+h),f++,O=ee+te,u=!0}else H(n,_[0]);break}case U:case ue:{if(o===_)break;if(a===U){const v=_-o,R=g;g=!1,(d===P||!R)&&!I&&T(v<0?j:ce)&&(O+=se),w=me(v)>i,O+=he,R||(u=!1)}o=A(_),O+=ee;break}case X:{T(P)&&(O=se),u=I=!1;break}case fe:{I=!0;break}}if(O){const v=()=>{S.forEach(([R,C])=>{O&R&&C()})};w?e(v):v()}}}},de=typeof window<"u"?L.useLayoutEffect:L.useEffect,W="current",Ae={},ae=(e,t)=>{if(ge(e))for(const s of e)ae(s,t);else!K(e)||typeof e=="boolean"||t.push(e)},Me=e=>{const t=[];return ae(e,t),t},Ve=(e,t,s)=>E(e-(s===ce?1:E(1,t)),0),ke=(e,t,s,r)=>N(e+(s===j?1:E(1,t)),r-1),ye=e=>{const t=L.useRef(e);return de(()=>{t[W]=e},[e]),t},De=(e,t,s,r)=>{const[n,c]=L.useState(t),l=ye(t);if(de(()=>e._subscribe(s,()=>{c(()=>l[W]())}),[]),r){const i=t();n!==i&&c(i)}return n},Le=J(e=>{const t="scrollLeft",s=e[t];e[t]=1;const r=e[t]<1;return e[t]=s,r}),_e=(e,t,s)=>we(r=>{if(e._getScrollDirection()!==P&&!r.ctrlKey&&(t?r.deltaX:r.deltaY)){const n=e._getScrollOffset();n>0&&n<e._getScrollOffsetMax()&&s()}},50),Pe=(e,t,s)=>{let r,n;const c=t?"scrollLeft":"scrollTop",l=(o,f)=>t&&s?Le(r)||f?-o:e._getScrollOffsetMax()-o:o,i=async o=>{if(!r)return;const f=()=>V(o(),0,e._getScrollOffsetMax());for(;;){const m=f();if(e._update(ue,m),!e._hasUnmeasuredItemsInTargetViewport(m))break;n&&n[1]();const d=e._subscribe(F,()=>{n&&n[0]()});try{await new Promise((u,I)=>{let g=!1;const p=()=>{g||(g=!0,u(),n=void 0)};n=[p,I],re(p,250)})}catch{return}finally{d()}}r[c]=l(f()),e._update(fe)};return{_initRoot(o){r=o;const f=()=>{e._update(U,l(o[c]))},m=oe(()=>{f(),e._update(X)},150),d=()=>{f(),m()},u=_e(e,t,m);return o.addEventListener("scroll",d),o.addEventListener("wheel",u,{passive:!0}),()=>{o.removeEventListener("scroll",d),o.removeEventListener("wheel",u),m._cancel()}},_scrollTo(o){i(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),i(()=>o)},_scrollToIndex(o,f){o=V(o,0,e._getItemsLength()-1),i(f==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{r&&(r[c]+=l(o,!0))}}},Ue=(e,t)=>{const s=t?"scrollX":"scrollY",r=t?"offsetLeft":"offsetTop";return{_initRoot(n){let c=!1;const l=(u,I)=>{const g=I+u[r],p=u.offsetParent;return u===document.body||!p?g:l(p,g)},i=()=>{c&&e._update(U,window[s]-l(n,0))},o=oe(()=>{i(),e._update(X)},150),f=()=>{i(),o()},m=_e(e,t,o),d=new IntersectionObserver(([u])=>{c=u.isIntersecting});return d.observe(n),window.addEventListener("scroll",f),window.addEventListener("wheel",m,{passive:!0}),()=>{d.disconnect(),window.removeEventListener("scroll",f),window.removeEventListener("wheel",m),o._cancel()}},_fixScrollJump:n=>{window.scrollBy(t?n:0,t?0:n)}}},We=e=>{const t=L.useRef();return t[W]||(t[W]=e())},pe={box:"border-box"},Ke=(e,t)=>{let s;const r=t?"width":"height",n=new WeakMap,c=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:f}of l)if(o.offsetParent)if(o===s)e._update(D,f[r]+f[t?"left":"top"]+B(ie(s)[t?"paddingRight":"paddingBottom"]));else{const m=n.get(o);K(m)&&i.push([m,f[r]])}i.length&&e._update(k,i)}));return{_observeRoot(l){s=l;const i=c();return i.observe(l,pe),()=>{i.disconnect()}},_observeItem(l,i){const o=c();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},Je=(e,t)=>{const s=t?"width":"height",r=t?"innerWidth":"innerHeight",n=new WeakMap,c=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:f}of l){if(!o.offsetParent)continue;const m=n.get(o);K(m)&&i.push([m,f[s]])}i.length&&e._update(k,i)}));return{_observeRoot(){const l=()=>{e._update(D,window[r])};return window.addEventListener("resize",l),l(),()=>{window.removeEventListener("resize",l),c().disconnect()}},_observeItem(l,i){const o=c();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},qe=(e,t)=>{let s;const r="height",n="width",c=new WeakMap,l=new Set,i=new Set,o=new Map,f=(d,u)=>`${d}-${u}`,m=J(()=>new ResizeObserver(d=>{const u=new Set,I=new Set;for(const{target:g,contentRect:p}of d)if(g.offsetParent)if(g===s){const S=ie(s);e._update(D,p[r]+p.top+B(S.paddingBottom)),t._update(D,p[n]+p.left+B(S.paddingRight))}else{const S=c.get(g);if(S){const[z,b]=S,A=f(z,b),T=o.get(A),a=[p[r],p[n]];let _,w;T?(T[0]!==a[0]&&(_=!0),T[1]!==a[1]&&(w=!0)):_=w=!0,_&&u.add(z),w&&I.add(b),(_||w)&&o.set(A,a)}}if(u.size){const g=[];u.forEach(p=>{let S=0;i.forEach(z=>{const b=o.get(f(p,z));b&&(S=E(S,b[0]))}),S&&g.push([p,S])}),e._update(k,g)}if(I.size){const g=[];I.forEach(p=>{let S=0;l.forEach(z=>{const b=o.get(f(z,p));b&&(S=E(S,b[1]))}),S&&g.push([p,S])}),t._update(k,g)}}));return{_observeRoot(d){s=d;const u=m();return u.observe(d,pe),()=>{u.disconnect()}},_observeItem(d,u,I){const g=m();return c.set(d,[u,I]),l.add(u),i.add(I),g.observe(d),()=>{c.delete(d),g.unobserve(d)}}}},ne=L.forwardRef(({children:e,attrs:t,width:s,height:r,scrolling:n},c)=>Z("div",{ref:c,...t,children:Z("div",{style:L.useMemo(()=>({position:"relative",visibility:"hidden",width:s??"100%",height:r??"100%",pointerEvents:n?"none":"auto"}),[s,r,n]),children:e})}));try{ne.displayName="Viewport",ne.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Ee as A,P as S,ee as U,ne as V,We as a,De as b,de as c,Ae as d,K as e,Me as f,Ne as g,Je as h,Ue as i,F as j,se as k,te as l,Ve as m,ke as n,qe as o,Pe as p,he as q,W as r,Ke as s,ye as u,xe as v};
//# sourceMappingURL=Viewport-6c1023be.js.map
