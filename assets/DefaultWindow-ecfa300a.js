import{r as O}from"./index-5284b0bf.js";import{r as X}from"./index-480187bb.js";import{j as k}from"./jsx-runtime-f8a6c6ea.js";const N=Math.min,v=Math.max,Y=Math.abs,K=Date.now,E=e=>e!=null,q=(e,t)=>Array.from({length:e},(r,s)=>t(s)),B=(e,t)=>{let r;const s=()=>{E(r)&&clearTimeout(r)},i=()=>{s(),r=setTimeout(()=>{r=null,e()},t)};return i._cancel=s,i},H=(e,t)=>{let r=K()-t;return(...s)=>{const i=K();r+t<i&&(r=i,e(...s))}},U=e=>{let t,r;return(...s)=>(t||(t=!0,r=e(...s)),r)},D=-1,y=(e,t)=>{const r=e._sizes[t];return r===D?e._defaultItemSize:r},ee=(e,t,r)=>{e._sizes[t]=r,e._measuredOffsetIndex=N(t,e._measuredOffsetIndex)},$=(e,t,r)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return r?e._offsets[t]+y(e,t):e._offsets[t];let s=e._measuredOffsetIndex,i=e._offsets[s];for(;s<=t&&(e._offsets[s]=i,!(s===t&&!r));)i+=y(e,s),s++;return e._measuredOffsetIndex=t,i},te=e=>$(e,e._length-1,!0),F=(e,t)=>$(e,t),G=(e,t,r)=>{let s=0;if(r>=0)for(;t<e._length-1;){const i=y(e,t++);if((s+=i)>=r){s-i/2>=r&&t--;break}}else for(;t>0;){const i=y(e,--t);if((s-=i)<=r){s+i/2<r&&t++;break}}return N(v(t,0),e._length-1)},J=(e,t,r,s)=>G(e,r,t-s),P=G,se=(e,t,r)=>{for(let s=t;s<=r;s++)if(e._sizes[s]===D)return!0;return!1},j=(e,t,r)=>({_defaultItemSize:t,_length:e,_measuredOffsetIndex:r?N(r._measuredOffsetIndex,e-1):0,_sizes:q(e,s=>{const i=r&&r._sizes[s];return E(i)?i:D}),_offsets:q(e,s=>{if(s===0)return 0;const i=r&&r._offsets[s];return E(i)?i:D})}),b=0,Q=1,M=2,W=3,L=1,x=2,C=3,V=4,ue=(e,t,r=0,s,i,h)=>{let u=t*v(r-1,0),m=0,S=[],d=j(e,t),o=b,c=!1,a=[0,r],l;const p=new Set,f=()=>te(d);return{_getRange(){const[n,_]=a,g=F(d,n),R=J(d,m,n,g),I=P(d,R,u);return n===R&&_===I?a:a=[R,I]},_isUnmeasuredItem(n){return d._sizes[n]===D},_hasUnmeasuredItemsInRange(n){return se(d,n,P(d,n,u))},_getItemOffset(n){const _=F(d,n);return s?_+v(0,u-f()):_},_getItemSize(n){return y(d,n)},_getScrollOffset(){return m},_getViewportSize(){return u},_getScrollSize(){return f()},_getScrollableDomSize(){return v(f(),u)},_getJump(){return S},_getIsJustResized(){const n=c;return c=!1,n},_getItemIndexForScrollTo(n){return J(d,n,0,0)},_waitForScrollDestinationItemsMeasured(){return l&&l[1](),new Promise((n,_)=>{l=[()=>{Promise.resolve().then(()=>{n(),l=void 0})},_]})},_subscribe(n){return p.add(n),()=>{p.delete(n)}},_update(n,_){let g;(()=>{switch(n){case L:{const I=_.filter(([z,w])=>d._sizes[z]!==w);return I.length?(S=[],I.forEach(([z,w])=>{S.push([w-y(d,z),z]),ee(d,z,w)}),c=g=!0):!1}case x:return u===_?!1:(u=_,!0);case C:case V:{const I=m,z=(m=_)!==I;return z&&n===C&&(g=Y(I-_)>u),z}}})()&&(p.forEach(I=>{I(g)}),n===C?h(m):l&&n===L&&l[0]())},_getScrollDirection(){return o},_setScrollDirection(n){const _=o;o=n,o===b?i(!1):_===b&&(o===Q||o===M)&&i(!0)},_updateCacheLength(n){d._length!==n&&(d=j(n,t,d))}}},re=typeof window<"u"?O.useLayoutEffect:O.useEffect,A="current",fe=e=>!E(e)||typeof e=="boolean",ne=e=>{const t=O.useRef(e);return re(()=>{t[A]=e},[e]),t},ae=(e,t,r)=>{const[s,i]=O.useState(t),h=ne(t);if(O.useLayoutEffect(()=>{const u=()=>{i(()=>h[A]())};return e._subscribe(m=>{m?X.flushSync(u):u()})},[]),r){const u=t();s!==u&&i(u)}return s},oe=U(e=>{const t="scrollLeft",r=e[t];e[t]=1;const s=e[t]<1;return e[t]=r,s}),de=(e,t,r)=>{let s;const i=t?"scrollLeft":"scrollTop",h=()=>s?t?s.scrollWidth:s.scrollHeight:0,u=(o,c)=>oe(s)||c?-o:e._getScrollSize()-e._getViewportSize()-o,m=(o,c)=>{s&&(t&&r&&(o=u(o,c)),c?s[i]+=o:(s[i]=o,e._setScrollDirection(W)))},S=async(o,c)=>{const a=()=>{let l=c();const p=h(),f=e._getViewportSize();return p-(l+f)<=0&&(l=p-f),l};if(e._hasUnmeasuredItemsInRange(o)){do{e._update(V,a());try{await e._waitForScrollDestinationItemsMeasured()}catch{return}}while(e._hasUnmeasuredItemsInRange(o));m(a())}else{const l=a();m(l),e._update(V,l)}},d=o=>o.reduce((c,[a])=>c+a,0);return{_initRoot(o){s=o;const c=()=>{let f=o[i];t&&r&&(f=u(f));const n=e._getScrollOffset();if(n===f)return;const _=e._getScrollDirection(),g=e._getIsJustResized();(_===b||!g)&&_!==W&&e._setScrollDirection(n>f?M:Q),e._update(C,f)},a=B(()=>{c(),e._setScrollDirection(b)},150),l=()=>{c(),a()},p=H(f=>{if(e._getScrollDirection()!==b&&!f.ctrlKey&&(t?f.deltaX:f.deltaY)){const n=e._getScrollOffset();n>0&&n<e._getScrollSize()-e._getViewportSize()&&a()}},50);return o.addEventListener("scroll",l),o.addEventListener("wheel",p,{passive:!0}),()=>{o.removeEventListener("scroll",l),o.removeEventListener("wheel",p),a._cancel()}},_getActualScrollSize:h,_scrollTo(o){o=v(o,0),S(e._getItemIndexForScrollTo(o),()=>o)},_scrollToIndex(o,c){o=v(N(o,c-1),0),S(o,()=>e._getItemOffset(o))},_fixScrollJump:(o,c)=>{const a=e._getScrollDirection();if(a===M){const l=d(o);l&&m(l,!0)}else if(a===W){const l=e._getScrollOffset();if(l!==0){const p=d(o);if(e._getScrollSize()-(l+e._getViewportSize()+p)<=0)p&&m(l+p);else{const f=o.reduce((n,[_,g])=>(g<c&&(n+=_),n),0);f&&m(f,!0)}}}}}},_e=e=>{const t=O.useRef();return t[A]||(t[A]=e())},me=(e,t)=>{let r;const s=t?"width":"height",i=new WeakMap,h=U(()=>new ResizeObserver(u=>{const m=[];for(const{target:S,contentRect:d}of u)if(S===r)e._update(x,d[s]);else{const o=i.get(S);E(o)&&m.push([o,d[s]])}m.length&&e._update(L,m)}));return{_observeRoot(u){r=u;const m=h();return m.observe(u),()=>{m.disconnect()}},_observeItem(u,m){const S=h();return i.set(u,m),S.observe(u),()=>{i.delete(u),S.unobserve(u)}}}},pe=(e,t)=>{let r;const s="height",i="width",h=new WeakMap,u=new Set,m=new Set,S=new Map,d=(c,a)=>`${c}-${a}`,o=U(()=>new ResizeObserver(c=>{const a=new Set,l=new Set;for(const{target:p,contentRect:f}of c)if(p===r)e._update(x,f[s]),t._update(x,f[i]);else{const n=h.get(p);if(n){const[_,g]=n,R=d(_,g),I=S.get(R),z=[f[s],f[i]];let w,T;I?(I[0]!==z[0]&&(w=!0),I[1]!==z[1]&&(T=!0)):w=T=!0,w&&a.add(_),T&&l.add(g),(w||T)&&S.set(R,z)}}if(a.size){const p=[];a.forEach(f=>{let n=0;m.forEach(_=>{const g=S.get(d(f,_));g&&(n=v(n,g[0]))}),n&&p.push([f,n])}),e._update(L,p)}if(l.size){const p=[];l.forEach(f=>{let n=0;u.forEach(_=>{const g=S.get(d(_,f));g&&(n=v(n,g[1]))}),n&&p.push([f,n])}),t._update(L,p)}}));return{_observeRoot(c){r=c;const a=o();return a.observe(c),()=>{a.disconnect()}},_observeItem(c,a,l){const p=o();return h.set(c,[a,l]),u.add(a),m.add(l),p.observe(c),()=>{h.delete(c),p.unobserve(c)}}}},Z=O.forwardRef(({children:e,attrs:t,width:r,height:s,scrolling:i},h)=>k("div",{ref:h,...t,children:k("div",{style:O.useMemo(()=>({position:"relative",visibility:"hidden",width:r??"100%",height:s??"100%",pointerEvents:i?"none":"auto"}),[r,s,i]),children:e})}));try{Z.displayName="DefaultWindow",Z.__docgenInfo={description:"",displayName:"DefaultWindow",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"WindowComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Z as D,re as a,ne as b,_e as c,ue as d,E as e,me as f,de as g,N as h,fe as i,pe as j,v as m,A as r,ae as u};
//# sourceMappingURL=DefaultWindow-ecfa300a.js.map
