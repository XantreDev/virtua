import{j as D}from"./jsx-runtime-c3d7f245.js";import{r as v}from"./index-c6dae603.js";import{r as pe}from"./index-eb008d06.js";const z=Math.min,B=Math.max,me=Math.abs,ee=Date.now,ve=Object.values,ge=Array.isArray,$=setTimeout,Y=(e,r,t)=>z(t,B(r,e)),G=e=>e!=null,ye=(e,r)=>{let t;const n=()=>{G(t)&&clearTimeout(t)},l=()=>{n(),t=$(()=>{t=null,e()},r)};return l.t=n,l},F=e=>{let r,t;return(...n)=>(r||(r=!0,t=e(...n)),t)},ce=e=>getComputedStyle(e),be=e=>e?parseFloat(e):0,H=-1,W=(e,r)=>{const t=e.o[r];return t===H?e.i:t},Q=(e,r)=>{if(!e.l)return 0;if(e.u>=r)return e.h[r];let t=e.u,n=e.h[t];for(;t<r;)n+=W(e,t),e.h[++t]=n;return e.u=r,n},te=(e,r,t)=>{let n=Q(e,t);for(;t>=0&&t<e.l;)if(n<=r){const l=W(e,t);if(n+l>r)break;n+=l,t++}else n-=W(e,--t);return Y(t,0,e.l-1)},re=(e,r,t,n)=>{const l=te(e,r,z(t,e.l-1));return[l,te(e,r+n,l)]},ue=(e,r,t)=>{const n=t?"unshift":"push";for(let l=e.l;l<r;l++)e.o[n](H),e.h.push(l===0?0:H);e.l=r},ne=(e,r,t)=>{const n=r-e.l,l=n<0;let c;return l?(c=(t?e.o.splice(0,-n):e.o.splice(n)).reduce((s,u)=>s+(u===H?e.i:u),0),e.h.splice(n)):(c=e.i*n,ue(e,e.l+n,t)),e.u=t?0:Y(r-1,0,e.u),e.l=r,[c,l]},ae=typeof window<"u",de=()=>document.documentElement,we=F(e=>{const r="scrollLeft",t=e[r];e[r]=1;const n=e[r]<1;return e[r]=t,n}),fe=F(()=>!!ae&&ce(de()).direction==="rtl"),Z=F(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Re=F(()=>"scrollBehavior"in de().style),oe=(e,r,t)=>r.reduce((n,[l,c])=>{const s=c-W(e,l);return(!t||s>0)&&(n+=s),n},0),Ee=(e,r=40,t=0,n=((s,u)=>{const o={i:u,l:0,u:0,o:[],h:[]};return ue(o,s),o})(e,r),l,c)=>{let s=r*B(t-1,0),u=0,o=0,i=0,p=0,b=0,h=0,g=0,k=!1,E=null,S=!1,I=[0,t];const J=new Set,m=()=>(a=>a.l?Q(a,a.l-1)+W(a,a.l-1):0)(n),A=()=>m()-s+u+o,O=a=>Y(a,0,A()),V=a=>{Z()&&g!==0?h+=a:(b+=a,p++)},q=a=>{const f=g;return g=a,g!==f};return{_:()=>JSON.parse(JSON.stringify(n)),g:()=>E?[z(I[0],E[0]),B(I[1],E[1])]:I=re(n,i+h,I[0],s),m:a=>n.o[a]===H,p:()=>!!E&&n.o.slice(B(0,E[0]-1),z(n.l-1,E[1]+1)+1).includes(H),v(a){const f=Q(n,a)-h;return l?f+B(0,s-m()):f},S:a=>W(n,a),I:()=>n.l,R:()=>i,k:A,O:()=>g,C:()=>s,T:()=>u,M:()=>B(m(),s),H:()=>p,J(){const a=b;return b=0,a},W(a,f){const _=[a,f];return J.add(_),()=>{J.delete(_)}},B(a,f){let _,P,x=0;switch(a){case 1:{const w=f.filter(([L,T])=>n.o[L]!==T);if(!w.length)break;let R=0;if(i!==0)if(i>A()-1.5)R=oe(n,w,!0);else{const[L]=I;R=oe(n,w.filter(([T])=>T<L))}R&&V(R);let N=!1;w.forEach(([L,T])=>{((d,y,M)=>{const j=d.o[y]===H;return d.o[y]=M,d.u=z(y,d.u),j})(n,L,T)&&(N=!0)}),c&&N&&!i&&(L=>{const T=L.o.filter(y=>y!==H),d=T[0];L.i=T.every(y=>y===d)?d:(y=>{const M=[...y].sort((K,U)=>K-U),j=y.length/2|0;return M.length%2==0?(M[j-1]+M[j])/2:M[j]})(T)})(n),x+=2,S=P=!0;break}case 2:{const w=f[0]+f[1]+f[2];s!==w&&(s=w,u=f[1],o=f[2],x=2);break}case 3:if(f[1]){const w=A()-i,[R,N]=ne(n,f[0],!0),L=N?-z(R,w):R;V(L),Z()||(i=O(i+L)),x=1}else ne(n,f[0]);break;case 4:{if(i===f)break;const w=f-i,R=S;S=!1,g!==0&&R||k||q(w<0?2:1),P=me(w)>s,x+=4,i=O(f),x+=1;break}case 5:q(0)&&(_=!0,x=1),k=!1,E=null;break;case 6:k=!0;break;case 7:E=re(n,f,I[0],s),x=1}x&&(_&&h&&(S=!0,b+=h,h=0,p++),J.forEach(([w,R])=>{x&w&&R(P)}))}}},X=ae?v.useLayoutEffect:v.useEffect,Le=(e,r,t)=>(()=>{let n=ee()-50;return(...l)=>{const c=ee();n+50<c&&(n=c,(s=>{if(e.O()!==0&&!s.ctrlKey&&(r?s.deltaX:s.deltaY)){const u=e.R();u>0&&u<e.k()&&t()}})(...l))}})(),ke=(e,r,t,n)=>we(e)||n?-t:r.k()-t,xe=(e,r)=>{let t,n,l=!1;const c=r?"scrollLeft":"scrollTop",s=(o,i)=>r&&fe()?ke(t,e,o,i):o,u=async(o,i)=>{if(!t)return;n&&n();const p=()=>Y(o(),0,e.k()),b=()=>{let h;return[new Promise((g,k)=>{h=g,$(n=k,150)}),e.W(2,()=>{h&&h()})]};if(i&&Re()){for(;e.B(7,p()),e.p();){const[h,g]=b();try{await h}catch{return}finally{g()}}t.scrollTo({[r?"left":"top"]:s(p()),behavior:"smooth"})}else for(;;){const[h,g]=b();try{t[c]=s(p()),e.B(6),await h}catch{return}finally{g()}}};return{L(o){t=o;let i=!1,p=!1;const b=ye(()=>{i?b():(p=!1,e.B(5))},150),h=()=>{p&&(l=!0),e.B(4,s(o[c])),b()},g=Le(e,r,b),k=()=>{i=!0,p=l=!1},E=()=>{i=!1,Z()&&(p=!0)};return o.addEventListener("scroll",h),o.addEventListener("wheel",g,{passive:!0}),o.addEventListener("touchstart",k,{passive:!0}),o.addEventListener("touchend",E,{passive:!0}),()=>{o.removeEventListener("scroll",h),o.removeEventListener("wheel",g),o.removeEventListener("touchstart",k),o.removeEventListener("touchend",E),b.t()}},$(o){u(()=>o)},P(o){o+=e.R(),u(()=>o)},j(o,{align:i,smooth:p}={}){if(o=Y(o,0,e.I()-1),i==="nearest"){const b=e.v(o),h=e.R();if(b<h)i="start";else{if(!(b+e.S(o)>h+e.C()))return;i="end"}}u(()=>i==="end"?e.T()+e.v(o)+e.S(o)-e.C():i==="center"?e.T()+e.v(o)+(e.S(o)-e.C())/2:e.T()+e.v(o),p)},D:o=>{if(t){if(l){l=!1;const i=t.style,p=i.overflow;i.overflow="hidden",$(()=>{i.overflow=p})}t[c]+=s(o,!0)}}}},C="current",Te={},he=(e,r)=>{if(ge(e))for(const t of e)he(t,r);else G(e)&&typeof e!="boolean"&&r.push(e)},Me=e=>{const r=[];return he(e,r),r},Se=(e,r,t)=>B(e-(t===1?1:B(1,r)),0),Ie=(e,r,t,n)=>z(e+(t===2?1:B(1,r)),n-1),_e=e=>{const r=v.useRef();return r[C]||(r[C]=e())},se=e=>{const r=v.useRef(e);return X(()=>{r[C]=e},[e]),r},Be={box:"border-box"},Ce=(e,r)=>{let t;const n=r?"width":"height",l=new WeakMap,c=F(()=>new ResizeObserver(s=>{const u=[];for(const{target:o,contentRect:i}of s)if(o.offsetParent)if(o===t)e.B(2,[i[n],i[r?"left":"top"],be(ce(t)[r?"paddingRight":"paddingBottom"])]);else{const p=l.get(o);G(p)&&u.push([p,i[n]])}u.length&&e.B(1,u)}));return{N(s){t=s;const u=c();return u.observe(s,Be),()=>{u.disconnect()}},U(s,u){const o=c();return l.set(s,u),o.observe(s),()=>{l.delete(s),o.unobserve(s)}}}},Oe=v.forwardRef(({children:e,attrs:r,width:t,height:n,scrolling:l},c)=>D("div",{ref:c,...r,children:D("div",{style:v.useMemo(()=>({position:"relative",visibility:"hidden",width:t??"100%",height:n??"100%",pointerEvents:l?"none":"auto"}),[t,n,l]),children:e})})),Ve=v.memo(({V:e,X:r,Y:t,A:n,F:l,q:c,G:s})=>{const u=v.useRef(null);return X(()=>r.U(u[C],t),[t]),D(c,{ref:u,style:v.useMemo(()=>{const o={margin:0,padding:0,position:"absolute",[s?"height":"width"]:"100%",[s?"top":"left"]:0,[s?fe()?"right":"left":"top"]:n,visibility:l?"hidden":"visible"};return s&&(o.display="flex"),o},[n,l]),children:e})}),le=()=>[],He=()=>v.useReducer(le,void 0,le)[1],Ae=v.forwardRef(({children:e,overscan:r=4,initialItemSize:t,initialItemCount:n,shift:l,horizontal:c,reverse:s,cache:u,components:{Root:o=Oe,Item:i="div"}=Te,onScroll:p,onScrollStop:b,onRangeChange:h,...g},k)=>{const E=v.useMemo(()=>Me(e),[e]),S=E.length,I=se(p),J=se(b),[m,A,O,V]=_e(()=>{const d=!!c,y=Ee(S,t,n,u,!!s,!t);return[y,Ce(y,d),xe(y,d),d]});S!==m.I()&&m.B(3,[S,l]);const q=He(),[a,f]=m.g(),_=m.O(),P=m.H(),x=m.M(),w=v.useRef(null),R=_!==0;X(()=>{const d=w[C],y=A.N(d),M=O.L(d),j=m.W(3,U=>{U?pe.flushSync(q):q()}),K=m.W(4,()=>{I[C]&&I[C](m.R())});return()=>{y(),M(),j(),K()}},[]),X(()=>{const d=m.J();d&&O.D(d)},[P]),v.useEffect(()=>{R||J[C]&&J[C]()},[R]),v.useEffect(()=>{h&&h(a,f)},[a,f]),v.useImperativeHandle(k,()=>({get cache(){return m._()},get scrollOffset(){return m.R()},get scrollSize(){return m.M()},get viewportSize(){return m.C()},scrollToIndex:O.j,scrollTo:O.$,scrollBy:O.P}),[]);const N=Se(a,r,_),L=Ie(f,r,_,S),T=[];for(let d=N;d<=L;d++){const y=E[d],M=y.key;T.push(D(Ve,{X:A,Y:d,A:m.v(d),F:m.m(d),q:i,V:y,G:V},G(M)?M:"_"+d))}return D(o,{ref:w,width:V?x:void 0,height:V?void 0:x,scrolling:R,attrs:v.useMemo(()=>({...g,style:{[V?"overflowX":"overflowY"]:"auto",display:V?"inline-block":"block",contain:"strict",width:"100%",height:"100%",...g.style}}),ve(g)),children:T})}),ie=v.memo(({count:e,Component:r,handle:t})=>{const n=v.useRef(null);return v.useImperativeHandle(t,()=>({scrollToIndex:l=>{var c;(c=n.current)==null||c.scrollToIndex(l)}})),D(Ae,{ref:n,children:Array.from({length:e}).map((l,c)=>D(r,{index:c},c))})});try{ie.displayName="VirtuaList",ie.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ie as V};
//# sourceMappingURL=virtua-ba871ced.js.map
