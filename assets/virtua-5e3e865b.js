import{j as S}from"./jsx-runtime-f8a6c6ea.js";import{r as h}from"./index-5284b0bf.js";import{r as he}from"./index-480187bb.js";const P=Math.min,C=Math.max,me=Math.abs,te=Date.now,q=e=>e!=null,ne=(e,t)=>Array.from({length:e},(n,r)=>t(r)),ue=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},D=(e,t)=>{const n=e.t[t];return n===-1?e.o:n},ce=(e,t,n)=>{if(!e.i)return 0;if(e.l>=t)return n?e.u[t]+D(e,t):e.u[t];let r=e.l,l=e.u[r];for(;r<=t&&(e.u[r]=l,r!==t||n);)l+=D(e,r),r++;return e.l=t,l},re=(e,t)=>ce(e,t),ae=(e,t,n)=>{let r=0;if(n>=0)for(;t<e.i-1;){const l=D(e,t++);if((r+=l)>=n){r-l/2>=n&&t--;break}}else for(;t>0;){const l=D(e,--t);if((r-=l)<=n){r+l/2<n&&t++;break}}return P(C(t,0),e.i-1)},oe=(e,t,n,r)=>ae(e,n,t-r),se=ae,le=(e,t,n)=>({o:t,i:e,l:n?P(n.l,e-1):0,t:ne(e,r=>{const l=n&&n.t[r];return q(l)?l:-1}),u:ne(e,r=>{if(r===0)return 0;const l=n&&n.u[r];return q(l)?l:-1})}),pe=(e,t,n=0,r,l,a)=>{let f,m=t*C(n-1,0),w=0,R=[],d=le(e,t),o=0,p=[0,n];const v=new Set,c=()=>(s=>ce(s,s.i-1,!0))(d);return{_(){const[s,i]=p,g=re(d,s),y=oe(d,w,s,g),u=se(d,y,m);return s===y&&i===u?p:p=[y,u]},h:s=>d.t[s]===-1,g:s=>((i,g,y)=>{for(let u=g;u<=y;u++)if(i.t[u]===-1)return!0;return!1})(d,s,se(d,s,m)),m(s){const i=re(d,s);return r?i+C(0,m-c()):i},S:s=>D(d,s),v:()=>w,p:()=>m,I:()=>c(),R:()=>C(c(),m),T:()=>R,M:s=>oe(d,s,0,0),O:()=>(f&&f[1](),new Promise((s,i)=>{f=[()=>{Promise.resolve().then(()=>{s(),f=void 0})},i]})),C:s=>(v.add(s),()=>{v.delete(s)}),H(s,i){let g;(()=>{switch(s){case 1:{const u=i.filter(([b,x])=>d.t[b]!==x);return!!u.length&&(R=[],u.forEach(([b,x])=>{R.push([x-D(d,b),b]),((V,z,k)=>{V.t[z]=k,V.l=P(z,V.l)})(d,b,x)}),g=!0,!0)}case 2:return m!==i&&(m=i,!0);case 3:case 4:{const u=w,b=(w=i)!==u;return b&&s===3&&(g=me(u-i)>m),b}}})()&&(v.forEach(u=>{u(g)}),s===3?a(w):f&&s===1&&f[0]())},D:()=>o,k(s){const i=o;o=s,o===0?l(!1):i!==0||o!==1&&o!==2||l(!0)},J(s){d.i!==s&&(d=le(s,t,d))}}},G=typeof window<"u"?h.useLayoutEffect:h.useEffect,M="current",F=e=>{const t=h.useRef(e);return G(()=>{t[M]=e},[e]),t},A=(e,t,n)=>{const[r,l]=h.useState(t),a=F(t);if(h.useLayoutEffect(()=>{const f=()=>{l(()=>a[M]())};return e.C(m=>{m?he.flushSync(f):f()})},[]),n){const f=t();r!==f&&l(f)}return r},ve=ue(e=>{const t="scrollLeft",n=e[t];e[t]=1;const r=e[t]<1;return e[t]=n,r}),ge=(e,t,n,r)=>{let l;const a=t?"scrollLeft":"scrollTop",f=()=>l?t?l.scrollWidth:l.scrollHeight:0,m=(o,p)=>ve(l)||p?-o:e.I()-e.p()-o,w=(o,p)=>{l&&(t&&n&&(o=m(o,p)),p?l[a]+=o:(l[a]=o,e.k(3)))},R=async(o,p)=>{const v=()=>{let c=p();const s=f(),i=e.p();return s-(c+i)<=0&&(c=s-i),c};if(e.g(o)){do{e.H(4,v());try{await e.O()}catch{return}}while(e.g(o));w(v())}else{const c=v();w(c),e.H(4,c)}},d=o=>o.reduce((p,[v])=>p+v,0);return{W(o){l=o;const p=()=>{let i=o[a];t&&n&&(i=m(i));const g=e.v();if(g===i)return;const y=e.D(),u=r();y!==0&&u||y===3||e.k(g>i?2:1),e.H(3,i)},v=(()=>{let i;const g=()=>{q(i)&&clearTimeout(i)},y=()=>{g(),i=setTimeout(()=>{i=null,p(),e.k(0)},150)};return y.$=g,y})(),c=()=>{p(),v()},s=(()=>{let i=te()-50;return(...g)=>{const y=te();i+50<y&&(i=y,(u=>{if(e.D()!==0&&!u.ctrlKey&&(t?u.deltaX:u.deltaY)){const b=e.v();b>0&&b<e.I()-e.p()&&v()}})(...g))}})();return o.addEventListener("scroll",c),o.addEventListener("wheel",s,{passive:!0}),()=>{o.removeEventListener("scroll",c),o.removeEventListener("wheel",s),v.$()}},L:f,A(o){o=C(o,0),R(e.M(o),()=>o)},B(o,p){o=C(P(o,p-1),0),R(o,()=>e.m(o))},F:(o,p)=>{const v=e.D();if(v===2){const c=d(o);c&&w(c,!0)}else if(v===3){const c=e.v();if(c!==0){const s=d(o);if(e.I()-(c+e.p()+s)<=0)s&&w(c+s);else{const i=o.reduce((g,[y,u])=>(u<p&&(g+=y),g),0);i&&w(i,!0)}}}}}},ye=e=>{const t=h.useRef();return t[M]||(t[M]=e())},we=h.forwardRef(({children:e,attrs:t,width:n,height:r,scrolling:l},a)=>S("div",{ref:a,...t,children:S("div",{style:h.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:r??"100%",pointerEvents:l?"none":"auto"}),[n,r,l]),children:e})})),Ee=h.memo(({P:e,U:t,j:n,V:r,q:l,G:a,K:f})=>{const m=h.useRef(null),w=A(n,()=>n.m(r),!0),R=A(n,()=>n.h(r),!0);return G(()=>t.N(m[M],r),[r]),S(l,{ref:m,style:h.useMemo(()=>{const d=f?"right":"left",o={margin:0,padding:0,position:"absolute",[a?"height":"width"]:"100%",[a?"top":d]:0,[a?d:"top"]:w,visibility:R?"hidden":"visible"};return a&&(o.display="flex"),o},[w,R]),children:e})}),be=({P:e,X:t,j:n,q:r,Y:l,Z:a,G:f})=>{const m=A(n,n.I);return S(r,{ref:t,width:f?m:void 0,height:f?void 0:m,scrolling:l,attrs:h.useMemo(()=>({...a,style:{overflow:f?"auto hidden":"hidden auto",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...a.style}}),[a]),children:e})},Le=h.forwardRef(({children:e,itemSize:t=40,overscan:n=4,initialItemCount:r,horizontal:l,mode:a,element:f=we,itemElement:m="div",onScroll:w,onScrollStop:R,onRangeChange:d,...o},p)=>{const v=h.useMemo(()=>{const E=[];return h.Children.forEach(e,L=>{(_=>!q(_)||typeof _=="boolean")(L)||E.push(L)}),E},[e]),c=v.length,s=F(w),i=F(R),[g,y]=h.useState(!1),[u,b,x,V,z]=ye(()=>{const E=!!l,L=a==="rtl",_=pe(c,t,r,a==="reverse",T=>{y(T),T||i[M]&&i[M]()},T=>{s[M]&&s[M](T)}),J=((T,fe)=>{let U,W=!1;const Y=fe?"width":"height",B=new WeakMap,Z=ue(()=>new ResizeObserver(I=>{const H=[];for(const{target:j,contentRect:Q}of I)if(j===U)T.H(2,Q[Y]);else{const ee=B.get(j);q(ee)&&H.push([ee,Q[Y]])}H.length&&(T.H(1,H),W=!0)}));return{ee(I){U=I;const H=Z();return H.observe(I),()=>{H.disconnect()}},N(I,H){const j=Z();return B.set(I,H),j.observe(I),()=>{B.delete(I),j.unobserve(I)}},te(){const I=W;return W=!1,I}}})(_,E);return[_,J,ge(_,E,L,J.te),E,L]});u.J(c);const[k,N]=A(u,u._),O=A(u,u.T),K=h.useRef(null);G(()=>{const E=K[M],L=b.ee(E),_=x.W(E);return()=>{L(),_()}},[]),G(()=>{O.length&&x.F(O,k)},[O]),h.useEffect(()=>{d&&d({start:k,end:N,count:c})},[k,N]),h.useImperativeHandle(p,()=>({get scrollOffset(){return u.v()},get scrollSize(){return x.L()},get viewportSize(){return u.p()},scrollToIndex(E){x.B(E,c)},scrollTo:x.A,scrollBy(E){x.A(u.v()+E)}}),[c]);const X=C(k-n,0),$=P(N+n,c-1),de=h.useMemo(()=>{const E=[];for(let L=X;L<=$;L++){const _=v[L];q(_)&&E.push(S(Ee,{U:b,j:u,V:L,q:m,P:_,G:V,K:z},(_==null?void 0:_.key)||L))}return E},[v,X,$]);return S(be,{X:K,j:u,q:f,Y:g,P:de,Z:o,G:V})}),ie=h.memo(({count:e,Component:t,handle:n})=>{const r=h.useRef(null);return h.useImperativeHandle(n,()=>({scrollToIndex:l=>{var a;(a=r.current)==null||a.scrollToIndex(l)}})),S(Le,{ref:r,children:Array.from({length:e}).map((l,a)=>S(t,{index:a},a))})});try{ie.displayName="VirtuaList",ie.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ie as V};
//# sourceMappingURL=virtua-5e3e865b.js.map
