import{r as R}from"./index-c6dae603.js";import{r as le}from"./index-eb008d06.js";import{j as F}from"./jsx-runtime-c3d7f245.js";const y=Math.min,O=Math.max,ue=Math.abs,B=Date.now,Le=Object.values,$=setTimeout,W=e=>e!=null,fe=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},H=(e,t)=>{let n;const s=()=>{W(n)&&clearTimeout(n)},r=()=>{s(),n=$(()=>{n=null,e()},t)};return r._cancel=s,r},ae=(e,t)=>{let n=B()-t;return(...s)=>{const r=B();n+t<r&&(n=r,e(...s))}},P=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},E=-1,N=(e,t)=>{const n=e._sizes[t];return n===E?e._defaultItemSize:n},de=(e,t,n)=>{const s=e._sizes[t]===E;return e._sizes[t]=n,e._measuredOffsetIndex=y(t,e._measuredOffsetIndex),s},ee=(e,t,n)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return n?e._offsets[t]+N(e,t):e._offsets[t];let s=e._measuredOffsetIndex,r=e._offsets[s];for(;s<=t&&(e._offsets[s]=r,!(s===t&&!n));)r+=N(e,s),s++;return e._measuredOffsetIndex=t,r},_e=e=>ee(e,e._length-1,!0),X=(e,t)=>ee(e,t),te=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=N(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=N(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return y(O(t,0),e._length-1)},Z=(e,t,n,s)=>te(e,n,t-s),me=(e,t,n)=>{for(let s=t;s<=n;s++)if(e._sizes[s]===E)return!0;return!1},pe=e=>{const t=e._sizes.filter(s=>s!==E),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:fe(t)},ge=(e,t)=>{const n=[],s=[];for(let r=0;r<e;r++)n.push(E),s.push(r===0?0:E);return{_defaultItemSize:t,_length:e,_measuredOffsetIndex:0,_sizes:n,_offsets:s}},he=(e,t)=>{const n=[],s=[];for(let r=0;r<t;r++){const a=e._sizes[r];if(n.push(W(a)?a:E),r===0)s.push(0);else{const c=e._offsets[r];s.push(W(c)?c:E)}}e._length=t,e._measuredOffsetIndex=y(e._measuredOffsetIndex,t-1),e._sizes=n,e._offsets=s},K=e=>e.reduce((t,[n])=>t+n,0),G=(e,t)=>t.map(([n,s])=>[s-N(e,n),n]),we=1.5,T=0,Se=1,Q=2,k=1,U=2,D=3,se=4,j=5,ne=6,re=1,x=2,oe=4,V=8,Ie=16,ye=(e,t,n=0,s,r)=>{const a=!t,c=t||40,o=r||ge(e,c);let l=c*O(n-1,0),i=0,_=0,d=0,u=T,h=!1,g=!1,m=[0,n];const w=new Set,v=()=>_e(o),b=()=>v()-l,A=f=>{const p=u;return u=f,u!==p&&(u===T||p===T)};return{_getCache(){return JSON.parse(JSON.stringify(o))},_getRange(){const[f,p]=m,I=X(o,f),S=Z(o,i,f,I),z=te(o,S,l);return f===S&&p===z?m:m=[S,z]},_isUnmeasuredItem(f){return o._sizes[f]===E},_hasUnmeasuredItemsInRange(f){return me(o,O(0,f-2),y(o._length-1,f+2))},_getItemOffset(f){const p=X(o,f);return s?p+O(0,l-v()):p},_getItemSize(f){return N(o,f)},_getItemLength(){return o._length},_getScrollOffset(){return i},_getScrollOffsetMax:b,_getViewportSize(){return l},_getScrollSize:v,_getCorrectedScrollSize(){return O(v(),l)},_getJumpCount(){return _},_flushJump(){const f=d;return d=0,f},_getItemIndexForScrollTo(f){return Z(o,f,0,0)},_subscribe(f,p){const I=[f,p];return w.add(I),()=>{w.delete(I)}},_update(f,p){let I,S=0;switch(f){case k:{const z=p.filter(([C,M])=>o._sizes[C]!==M);if(!z.length)break;let L=0;if(u===Q)L=K(G(o,z));else if(h){const C=G(o,z),[M]=m;i===0||(i>b()-we?L=K(C):L=K(C.filter(([,ce])=>ce<M)))}L&&(d=L,_++,S+=oe);let q=!1;z.forEach(([C,M])=>{de(o,C,M)&&(q=!0)}),a&&q&&!i&&pe(o),S+=x,g=I=!0;break}case U:{l!==p&&(l=p,S=x);break}case D:case se:{if(i===p)break;if(f===D){const z=g;g=!1,(u===T||!z)&&!h&&A(i>p?Q:Se)&&(S+=V),I=ue(i-p)>l,S+=Ie}i=O(0,y(b(),p)),S+=re;break}case j:{A(T)&&(S=V),h=!1;break}case ne:{h=!0;break}}S&&w.forEach(([z,L])=>{S&z&&L(I)})},_getIsScrolling(){return u!==T},_updateCacheLength(f){o._length!==f&&he(o,f)}}},be=typeof window<"u"?R.useLayoutEffect:R.useEffect,J="current",Ce=e=>{const t=[];return R.Children.forEach(e,n=>{!W(n)||typeof n=="boolean"||t.push(n)}),t},ve=e=>{const t=R.useRef(e);return be(()=>{t[J]=e},[e]),t},Te=(e,t,n)=>{const[s,r]=R.useState(t),a=ve(t);if(R.useLayoutEffect(()=>{let c;t===e._getRange?c=re+x:t===e._getCorrectedScrollSize?c=x:t===e._getJumpCount?c=oe:t===e._getIsScrolling?c=V:c=x;const o=()=>{r(()=>a[J]())};return e._subscribe(c,l=>{l?le.flushSync(o):o()})},[]),n){const c=t();s!==c&&r(c)}return s},ze=P(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),ie=(e,t,n)=>ae(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),xe=(e,t,n)=>{let s,r;const a=t?"scrollLeft":"scrollTop",c=()=>s?t?s.scrollWidth:s.scrollHeight:0,o=(i,_)=>t&&n?ze(s)||_?-i:e._getScrollOffsetMax()-i:i,l=async(i,_)=>{if(!s)return;const d=()=>y(_(),c()-e._getViewportSize());for(;e._update(se,d()),!!e._hasUnmeasuredItemsInRange(i);){r&&r[1]();const u=e._subscribe(x,()=>{r&&r[0]()});try{await new Promise((h,g)=>{let m=!1;const w=()=>{m||(m=!0,h(),r=void 0)};r=[w,g],$(w,250)})}catch{return}finally{u()}}s[a]=o(d()),e._update(ne)};return{_initRoot(i){s=i;const _=()=>{e._update(D,o(i[a]))},d=H(()=>{_(),e._update(j)},150),u=()=>{_(),d()},h=ie(e,t,d);return i.addEventListener("scroll",u),i.addEventListener("wheel",h,{passive:!0}),()=>{i.removeEventListener("scroll",u),i.removeEventListener("wheel",h),d._cancel()}},_getActualScrollSize:c,_scrollTo(i){i=O(i,0),l(e._getItemIndexForScrollTo(i),()=>i)},_scrollToIndex(i){i=O(y(i,e._getItemLength()-1),0),l(i,()=>e._getItemOffset(i))},_fixScrollJump:i=>{s&&(s[a]+=o(i,!0))}}},We=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let a=!1;const c=(u,h)=>{const g=h+u[s],m=u.offsetParent;return u===document.body||!m?g:c(m,g)},o=()=>{a&&e._update(D,window[n]-c(r,0))},l=H(()=>{o(),e._update(j)},150),i=()=>{o(),l()},_=ie(e,t,l),d=new IntersectionObserver(([u])=>{a=u.isIntersecting});return d.observe(r),window.addEventListener("scroll",i),window.addEventListener("wheel",_,{passive:!0}),()=>{d.disconnect(),window.removeEventListener("scroll",i),window.removeEventListener("wheel",_),l._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},Ne=e=>{const t=R.useRef();return t[J]||(t[J]=e())},Ae=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,a=P(()=>new ResizeObserver(c=>{const o=[];for(const{target:l,contentRect:i}of c)if(l===n)e._update(U,i[s]);else{const _=r.get(l);W(_)&&o.push([_,i[s]])}o.length&&e._update(k,o)}));return{_observeRoot(c){n=c;const o=a();return o.observe(c),()=>{o.disconnect()}},_observeItem(c,o){const l=a();return r.set(c,o),l.observe(c),()=>{r.delete(c),l.unobserve(c)}}}},Me=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,a=P(()=>new ResizeObserver(c=>{const o=[];for(const{target:l,contentRect:i}of c){const _=r.get(l);W(_)&&o.push([_,i[n]])}o.length&&e._update(k,o)}));return{_observeRoot(){const c=()=>{e._update(U,window[s])};return window.addEventListener("resize",c),c(),()=>{window.removeEventListener("resize",c),a().disconnect()}},_observeItem(c,o){const l=a();return r.set(c,o),l.observe(c),()=>{r.delete(c),l.unobserve(c)}}}},ke=(e,t)=>{let n;const s="height",r="width",a=new WeakMap,c=new Set,o=new Set,l=new Map,i=(d,u)=>`${d}-${u}`,_=P(()=>new ResizeObserver(d=>{const u=new Set,h=new Set;for(const{target:g,contentRect:m}of d)if(g===n)e._update(U,m[s]),t._update(U,m[r]);else{const w=a.get(g);if(w){const[v,b]=w,A=i(v,b),f=l.get(A),p=[m[s],m[r]];let I,S;f?(f[0]!==p[0]&&(I=!0),f[1]!==p[1]&&(S=!0)):I=S=!0,I&&u.add(v),S&&h.add(b),(I||S)&&l.set(A,p)}}if(u.size){const g=[];u.forEach(m=>{let w=0;o.forEach(v=>{const b=l.get(i(m,v));b&&(w=O(w,b[0]))}),w&&g.push([m,w])}),e._update(k,g)}if(h.size){const g=[];h.forEach(m=>{let w=0;c.forEach(v=>{const b=l.get(i(v,m));b&&(w=O(w,b[1]))}),w&&g.push([m,w])}),t._update(k,g)}}));return{_observeRoot(d){n=d;const u=_();return u.observe(d),()=>{u.disconnect()}},_observeItem(d,u,h){const g=_();return a.set(d,[u,h]),c.add(u),o.add(h),g.observe(d),()=>{a.delete(d),g.unobserve(d)}}}},Y=R.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},a)=>F("div",{ref:a,...t,children:F("div",{style:R.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{Y.displayName="Window",Y.__docgenInfo={description:"",displayName:"Window",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"WindowComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Ie as U,Y as W,Ne as a,Te as b,be as c,ye as d,W as e,Ce as f,Me as g,We as h,y as i,ke as j,xe as k,Ae as l,O as m,J as r,ve as u,Le as v};
//# sourceMappingURL=Window-9f94ab1e.js.map
