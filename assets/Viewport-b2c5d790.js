import{r as h}from"./index-c6dae603.js";import{r as ie}from"./index-eb008d06.js";import{j as G}from"./jsx-runtime-c3d7f245.js";const K=Math.min,z=Math.max,le=Math.abs,Z=Date.now,ze=Object.values,Y=setTimeout,N=(e,t,n)=>K(n,z(t,e)),k=e=>e!=null,ue=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},$=(e,t)=>{let n;const s=()=>{k(n)&&clearTimeout(n)},r=()=>{s(),n=Y(()=>{n=null,e()},t)};return r._cancel=s,r},ce=(e,t)=>{let n=Z()-t;return(...s)=>{const r=Z();n+t<r&&(n=r,e(...s))}},W=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},L=-1,y=(e,t)=>{const n=e._sizes[t];return n===L?e._defaultItemSize:n},fe=(e,t,n)=>{const s=e._sizes[t]===L;return e._sizes[t]=n,e._measuredOffsetIndex=K(t,e._measuredOffsetIndex),s},q=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let n=e._measuredOffsetIndex,s=e._offsets[n];for(;n<t;)s+=y(e,n),e._offsets[++n]=s;return e._measuredOffsetIndex=t,s},ae=e=>e._length?q(e,e._length-1)+y(e,e._length-1):0,P=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=y(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=y(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return N(t,0,e._length-1)},X=(e,t,n)=>P(e,n,t-q(e,n)),de=(e,t,n)=>e._sizes.slice(t,n+1).includes(L),_e=e=>{const t=e._sizes.filter(s=>s!==L),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:ue(t)},H=(e,t)=>{for(let n=e._length;n<t;n++)e._sizes.push(L),e._offsets.push(n===0?0:L);e._length=t},me=(e,t)=>{const n={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return H(n,e),n},pe=(e,t)=>{const n=t-e._length;if(n>0)H(e,t);else{for(let s=n;s<0;s++)e._sizes.pop(),e._offsets.pop();e._length=t,e._measuredOffsetIndex=N(t-1,0,e._measuredOffsetIndex)}},D=(e,t)=>t.reduce((n,[s,r])=>n+(r-y(e,s)),0),ge=1.5,R=0,Se=1,F=2,A=1,M=2,V=3,ee=4,j=5,te=6,se=1,C=2,ne=4,J=8,we=16,Le=(e,t=40,n=0,s=me(e,t),r,_)=>{let i=t*z(n-1,0),l=0,f=0,o=0,c=R,a=!1,d=!1,p=[0,n];const g=new Set,S=()=>ae(s),w=()=>S()-i,v=u=>{const m=c;return c=u,c!==m&&(c===R||m===R)};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){const[u,m]=p,b=X(s,l,u),I=P(s,b,i);return u===b&&m===I?p:p=[b,I]},_isUnmeasuredItem(u){return s._sizes[u]===L},_hasUnmeasuredItemsInTargetViewport(u){const m=X(s,u,p[0]);return de(s,z(0,m-1),K(s._length-1,P(s,m,i)+1))},_getItemOffset(u){const m=q(s,u);return r?m+z(0,i-S()):m},_getItemSize(u){return y(s,u)},_getItemLength(){return s._length},_getScrollOffset(){return l},_getScrollOffsetMax:w,_getIsScrolling(){return c!==R},_getViewportSize(){return i},_getCorrectedScrollSize(){return z(S(),i)},_getJumpCount(){return f},_flushJump(){const u=o;return o=0,u},_subscribe(u,m){const b=[u,m];return g.add(b),()=>{g.delete(b)}},_update(u,m){let b,I=0;switch(u){case A:{const E=m.filter(([T,x])=>s._sizes[T]!==x);if(!E.length)break;let O=0;if(c===F)O=D(s,E);else if(a&&l!==0)if(l>w()-ge)O=D(s,E);else{const[T]=p;O=D(s,E.filter(([x])=>x<T))}O&&(o=O,f++,I+=ne);let B=!1;E.forEach(([T,x])=>{fe(s,T,x)&&(B=!0)}),_&&B&&!l&&_e(s),I+=C,d=b=!0;break}case M:{i!==m&&(i=m,I=C);break}case V:case ee:{if(l===m)break;if(u===V){const E=d;d=!1,(c===R||!E)&&!a&&v(l>m?F:Se)&&(I+=J),b=le(l-m)>i,I+=we}l=N(m,0,w()),I+=se;break}case j:{v(R)&&(I=J),a=!1;break}case te:{a=!0;break}}I&&g.forEach(([E,O])=>{I&E&&O(b)})},_updateCacheLength(u){s._length!==u&&pe(s,u)}}},Ie=typeof window<"u"?h.useLayoutEffect:h.useEffect,U="current",Re={},re=(e,t)=>{if(Array.isArray(e))for(const n of e)re(n,t);else!k(e)||typeof e=="boolean"||t.push(e)},ye=e=>{const t=[];return re(e,t),t},be=e=>{const t=h.useRef(e);return Ie(()=>{t[U]=e},[e]),t},Ce=se+C,Te=C,xe=ne,Ne=J,Ae=C,Me=(e,t,n,s)=>{const[r,_]=h.useState(t),i=be(t);if(h.useLayoutEffect(()=>{const l=()=>{_(()=>i[U]())};return e._subscribe(n,f=>{f?ie.flushSync(l):l()})},[]),s){const l=t();r!==l&&_(l)}return r},Ee=W(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),oe=(e,t,n)=>ce(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),Ve=(e,t,n)=>{let s,r;const _=t?"scrollLeft":"scrollTop",i=()=>s?t?s.scrollWidth:s.scrollHeight:0,l=(o,c)=>t&&n?Ee(s)||c?-o:e._getScrollOffsetMax()-o:o,f=async o=>{if(!s)return;const c=()=>N(o(),0,i()-e._getViewportSize());for(;;){const a=c();if(e._update(ee,a),!e._hasUnmeasuredItemsInTargetViewport(a))break;r&&r[1]();const d=e._subscribe(C,()=>{r&&r[0]()});try{await new Promise((p,g)=>{let S=!1;const w=()=>{S||(S=!0,p(),r=void 0)};r=[w,g],Y(w,250)})}catch{return}finally{d()}}s[_]=l(c()),e._update(te)};return{_initRoot(o){s=o;const c=()=>{e._update(V,l(o[_]))},a=$(()=>{c(),e._update(j)},150),d=()=>{c(),a()},p=oe(e,t,a);return o.addEventListener("scroll",d),o.addEventListener("wheel",p,{passive:!0}),()=>{o.removeEventListener("scroll",d),o.removeEventListener("wheel",p),a._cancel()}},_getActualScrollSize:i,_scrollTo(o){f(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),f(()=>o)},_scrollToIndex(o,c){o=N(o,0,e._getItemLength()-1),f(c==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{s&&(s[_]+=l(o,!0))}}},Ue=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let _=!1;const i=(d,p)=>{const g=p+d[s],S=d.offsetParent;return d===document.body||!S?g:i(S,g)},l=()=>{_&&e._update(V,window[n]-i(r,0))},f=$(()=>{l(),e._update(j)},150),o=()=>{l(),f()},c=oe(e,t,f),a=new IntersectionObserver(([d])=>{_=d.isIntersecting});return a.observe(r),window.addEventListener("scroll",o),window.addEventListener("wheel",c,{passive:!0}),()=>{a.disconnect(),window.removeEventListener("scroll",o),window.removeEventListener("wheel",c),f._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},ke=e=>{const t=h.useRef();return t[U]||(t[U]=e())},We=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,_=W(()=>new ResizeObserver(i=>{const l=[];for(const{target:f,contentRect:o}of i)if(f===n)e._update(M,o[s]);else{const c=r.get(f);k(c)&&l.push([c,o[s]])}l.length&&e._update(A,l)}));return{_observeRoot(i){n=i;const l=_();return l.observe(i),()=>{l.disconnect()}},_observeItem(i,l){const f=_();return r.set(i,l),f.observe(i),()=>{r.delete(i),f.unobserve(i)}}}},De=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,_=W(()=>new ResizeObserver(i=>{const l=[];for(const{target:f,contentRect:o}of i){const c=r.get(f);k(c)&&l.push([c,o[n]])}l.length&&e._update(A,l)}));return{_observeRoot(){const i=()=>{e._update(M,window[s])};return window.addEventListener("resize",i),i(),()=>{window.removeEventListener("resize",i),_().disconnect()}},_observeItem(i,l){const f=_();return r.set(i,l),f.observe(i),()=>{r.delete(i),f.unobserve(i)}}}},Pe=(e,t)=>{let n;const s="height",r="width",_=new WeakMap,i=new Set,l=new Set,f=new Map,o=(a,d)=>`${a}-${d}`,c=W(()=>new ResizeObserver(a=>{const d=new Set,p=new Set;for(const{target:g,contentRect:S}of a)if(g===n)e._update(M,S[s]),t._update(M,S[r]);else{const w=_.get(g);if(w){const[v,u]=w,m=o(v,u),b=f.get(m),I=[S[s],S[r]];let E,O;b?(b[0]!==I[0]&&(E=!0),b[1]!==I[1]&&(O=!0)):E=O=!0,E&&d.add(v),O&&p.add(u),(E||O)&&f.set(m,I)}}if(d.size){const g=[];d.forEach(S=>{let w=0;l.forEach(v=>{const u=f.get(o(S,v));u&&(w=z(w,u[0]))}),w&&g.push([S,w])}),e._update(A,g)}if(p.size){const g=[];p.forEach(S=>{let w=0;i.forEach(v=>{const u=f.get(o(v,S));u&&(w=z(w,u[1]))}),w&&g.push([S,w])}),t._update(A,g)}}));return{_observeRoot(a){n=a;const d=c();return d.observe(a),()=>{d.disconnect()}},_observeItem(a,d,p){const g=c();return _.set(a,[d,p]),i.add(d),l.add(p),g.observe(a),()=>{_.delete(a),g.unobserve(a)}}}},Q=h.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},_)=>G("div",{ref:_,...t,children:G("div",{style:h.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{Q.displayName="Viewport",Q.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Ce as S,we as U,Q as V,ke as a,Me as b,Ie as c,Re as d,k as e,ye as f,Le as g,De as h,Ue as i,Ne as j,xe as k,Te as l,z as m,K as n,Ae as o,Pe as p,Ve as q,U as r,We as s,be as u,ze as v};
//# sourceMappingURL=Viewport-b2c5d790.js.map
