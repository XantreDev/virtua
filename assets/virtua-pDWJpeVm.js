import{a as D}from"./jsx-runtime-sgeEVxPu.js";import{r as g}from"./index-yp3VsGQP.js";import{r as ve}from"./index-8dy-jdxy.js";const Y=Math.min,V=Math.max,Z=Math.abs,ee=Date.now,ge=Object.values,ye=Array.isArray,$=setTimeout,z=(e,n,t)=>Y(t,V(n,e)),K=e=>e!=null,be=(e,n)=>{let t;const r=()=>{K(t)&&clearTimeout(t)},s=()=>{r(),t=$(()=>{t=null,e()},n)};return s.t=r,s},F=e=>{let n,t;return(...r)=>(n||(n=!0,t=e(...r)),t)},ce=e=>getComputedStyle(e),we=e=>e?parseFloat(e):0,J=-1,j=(e,n)=>{const t=e.o[n];return t===J?e.i:t},Q=(e,n)=>{if(!e.l)return 0;if(e.u>=n)return e.h[n];let t=e.u,r=e.h[t];for(;t<n;)r+=j(e,t),e.h[++t]=r;return e.u=n,r},te=(e,n,t)=>{let r=Q(e,t);for(;t>=0&&t<e.l;)if(r<=n){const s=j(e,t);if(r+s>n)break;r+=s,t++}else r-=j(e,--t);return z(t,0,e.l-1)},re=(e,n,t,r)=>{const s=te(e,n,Y(t,e.l-1));return[s,te(e,n+r,s)]},ue=(e,n,t)=>{const r=t?"unshift":"push";for(let s=e.l;s<n;s++)e.o[r](J),e.h.push(s===0?0:J);e.l=n},ne=(e,n,t)=>{const r=n-e.l,s=r<0;let c;return s?(c=(t?e.o.splice(0,-r):e.o.splice(r)).reduce((l,i)=>l+(i===J?e.i:i),0),e.h.splice(r)):(c=e.i*r,ue(e,e.l+r,t)),e.u=t?0:z(n-1,0,e.u),e.l=n,[c,s]},ae=typeof window<"u",fe=()=>document.documentElement,Le=F(e=>{const n="scrollLeft",t=e[n];e[n]=1;const r=e[n]<1;return e[n]=t,r}),de=F(()=>!!ae&&ce(fe()).direction==="rtl"),he=F(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Re=F(()=>"scrollBehavior"in fe().style),oe=(e,n,t)=>n.reduce((r,[s,c])=>{const l=c-j(e,s);return(!t||l>0)&&(r+=l),r},0),Ee=(e,n=40,t=0,r=((l,i)=>{const p={i,l:0,u:0,o:[],h:[]};return ue(p,l),p})(e,n),s,c)=>{let l=n*V(t-1,0),i=0,p=0,o=0,a=0,m=0,y=0,f=0,b=0,k=!1,E=null,x=[0,t];const P=new Set,B=()=>(d=>d.l?Q(d,d.l-1)+j(d,d.l-1):0)(r),v=()=>l-i-p,N=()=>B()-v(),H=d=>{he()&&b!==0?y+=d:(m+=d,a++)},q=d=>{const h=b;return b=d,b!==h};return{_:()=>JSON.parse(JSON.stringify(r)),g:()=>E?[Y(x[0],E[0]),V(x[1],E[1])]:f?x:x=re(r,o+y+m,x[0],l),p:d=>r.o[d]===J,m:()=>!!E&&r.o.slice(V(0,E[0]-1),Y(r.l-1,E[1]+1)+1).includes(J),v(d){const h=Q(r,d)-y;return s?h+V(0,l-B()):h},S:d=>j(r,d),I:()=>r.l,R:()=>o,k:N,O:()=>b,C:()=>l,T:()=>i,M:()=>V(B(),v()),H:B,J:()=>a,W:()=>v()>B()?m=0:(f=m,m=0,f),B(d,h){const O=[d,h];return P.add(O),()=>{P.delete(O)}},L(d,h){let O,X,T=0;switch(d){case 1:{const w=h.filter(([S,I])=>r.o[S]!==I);if(!w.length)break;let L=0;if(o!==0)if(o>N()-1.5)L=oe(r,w,!0);else{const[S]=x;L=oe(r,w.filter(([I])=>I<S))}L&&H(L);let M=!1;w.forEach(([S,I])=>{((_,u,R)=>{const C=_.o[u]===J;return _.o[u]=R,_.u=Y(u,_.u),C})(r,S,I)&&(M=!0)}),c&&M&&!o&&(S=>{const I=S.o.filter(u=>u!==J),_=I[0];S.i=I.every(u=>u===_)?_:(u=>{const R=[...u].sort((U,G)=>U-G),C=u.length/2|0;return R.length%2==0?(R[C-1]+R[C])/2:R[C]})(I)})(r),T=2,X=!0;break}case 2:{const w=h[0]+h[1]+h[2];l!==w&&(l=w,i=h[1],p=h[2],T=2);break}case 3:if(h[1]){const w=N()-o,[L,M]=ne(r,h[0],!0);H(M?-Y(L,w):L),T=1}else ne(r,h[0]);break;case 4:{const w=z(h,0,N());if(w===o)break;const L=w-o,M=Z(L),S=f&&M<Z(f)+1;f=0,S||k||q(L<0?2:1),X=M>l,o=w,T=5;break}case 5:q(0)&&(O=!0,T=1),k=!1,E=null;break;case 6:k=!0;break;case 7:E=re(r,h,x[0],l),T=1}T&&(O&&y&&(m+=y,y=0,a++),P.forEach(([w,L])=>{T&w&&L(X)}))}}},W=ae?g.useLayoutEffect:g.useEffect,ke=(e,n,t)=>(()=>{let r=ee()-50;return(...s)=>{const c=ee();r+50<c&&(r=c,(l=>{if(e.O()!==0&&!l.ctrlKey&&(n?l.deltaX:l.deltaY)){const i=e.R();i>0&&i<e.k()&&t()}})(...s))}})(),xe=(e,n,t,r)=>Le(e)||r?-t:n.k()-t,Se=(e,n)=>{let t,r,s=!1;const c=n?"scrollLeft":"scrollTop",l=n?"overflowX":"overflowY",i=(o,a)=>n&&de()?xe(t,e,o,a):o,p=async(o,a)=>{if(!t)return;r&&r();const m=()=>z(o(),0,e.k()),y=()=>{let f;return[new Promise((b,k)=>{f=b,$(r=k,150)}),e.B(2,()=>{f&&f()})]};if(a&&Re()){for(;e.L(7,m()),e.m();){const[f,b]=y();try{await f}catch{return}finally{b()}}t.scrollTo({[n?"left":"top"]:i(m()),behavior:"smooth"})}else for(;;){const[f,b]=y();try{t[c]=i(m()),e.L(6),await f}catch{return}finally{b()}}};return{$(o){t=o;let a=!1,m=!1;const y=be(()=>{a?y():(m=!1,e.L(5))},150),f=()=>{m&&(s=!0),e.L(4,i(o[c])),y()},b=ke(e,n,y),k=()=>{a=!0,m=s=!1},E=()=>{a=!1,he()&&(m=!0)};return o.addEventListener("scroll",f),o.addEventListener("wheel",b,{passive:!0}),o.addEventListener("touchstart",k,{passive:!0}),o.addEventListener("touchend",E,{passive:!0}),()=>{o.removeEventListener("scroll",f),o.removeEventListener("wheel",b),o.removeEventListener("touchstart",k),o.removeEventListener("touchend",E),y.t()}},A(o){p(()=>o)},X(o){o+=e.R(),p(()=>o)},Y(o,{align:a,smooth:m}={}){if(o=z(o,0,e.I()-1),a==="nearest"){const y=e.v(o),f=e.R();if(y<f)a="start";else{if(!(y+e.S(o)>f+e.C()))return;a="end"}}p(()=>e.T()+(a==="end"?e.v(o)+e.S(o)-e.C():a==="center"?e.v(o)+(e.S(o)-e.C())/2:e.v(o)),m)},j:o=>{if(t){if(s){s=!1;const a=t.style,m=a[l];a[l]="hidden",$(()=>{a[l]=m})}t[c]+=i(o,!0)}}}},A="current",Me={},pe=(e,n)=>{if(ye(e))for(const t of e)pe(t,n);else K(e)&&typeof e!="boolean"&&n.push(e)},Ie=(e,n,t)=>V(e-(t===1?1:V(1,n)),0),Te=(e,n,t,r)=>Y(e+(t===2?1:V(1,n)),r-1),_e=e=>{const n=g.useRef();return n[A]||(n[A]=e())},se=e=>{const n=g.useRef(e);return W(()=>{n[A]=e},[e]),n},Ce={box:"border-box"},Oe=(e,n)=>{let t;const r=n?"width":"height",s=new WeakMap,c=F(()=>new ResizeObserver(l=>{const i=[];for(const{target:p,contentRect:o}of l)if(p.offsetParent)if(p===t)e.L(2,[o[r],o[n?"left":"top"],we(ce(t)[n?"paddingRight":"paddingBottom"])]);else{const a=s.get(p);K(a)&&i.push([a,o[r]])}i.length&&e.L(1,i)}));return{D(l){t=l;const i=c();return i.observe(l,Ce),()=>{i.disconnect()}},N(l,i){const p=c();return s.set(l,i),p.observe(l),()=>{s.delete(l),p.unobserve(l)}}}},Ve=g.forwardRef(({children:e,attrs:n,width:t,height:r,scrolling:s},c)=>D("div",{ref:c,...n,children:D("div",{style:g.useMemo(()=>({position:"relative",visibility:"hidden",width:t??"100%",height:r??"100%",pointerEvents:s?"none":"auto"}),[t,r,s]),children:e})})),Ae=g.memo(({P:e,U:n,V:t,F:r,G:s,q:c,K:l})=>{const i=g.useRef(null);W(()=>n.N(i[A],t),[t]);const p=g.useMemo(()=>{const o={margin:0,padding:0,position:"absolute",[l?"height":"width"]:"100%",[l?"top":"left"]:0,[l?de()?"right":"left":"top"]:r,visibility:s?"hidden":"visible"};return l&&(o.display="flex"),o},[r,s]);return D(c,typeof c=="string"?{ref:i,style:p,children:e}:{ref:i,style:p,index:t,children:e})}),le=()=>[],Be=()=>g.useReducer(le,void 0,le)[1],He=(e,n)=>g.useMemo(()=>{if(typeof e=="function")return[e,n||0];const t=(r=>{const s=[];return pe(r,s),s})(e);return[r=>t[r],t.length]},[e,n]),qe=g.forwardRef(({children:e,count:n,overscan:t=4,initialItemSize:r,initialItemCount:s,shift:c,horizontal:l,reverse:i,cache:p,components:{Root:o=Ve,Item:a="div"}=Me,onScroll:m,onScrollStop:y,onRangeChange:f,...b},k)=>{const[E,x]=He(e,n),P=se(m),B=se(y),[v,N,H,q]=_e(()=>{const u=!!l,R=Ee(x,r,s,p,!!i,!r);return[R,Oe(R,u),Se(R,u),u]});x!==v.I()&&v.L(3,[x,c]);const d=Be(),[h,O]=v.g(),X=v.O(),T=v.J(),w=v.M(),L=g.useRef(null),M=X!==0;W(()=>{const u=L[A],R=v.B(3,me=>{me?ve.flushSync(d):d()}),C=v.B(4,()=>{P[A]&&P[A](v.R())}),U=N.D(u),G=H.$(u);return()=>{R(),C(),U(),G()}},[]),W(()=>{const u=v.W();u&&H.j(u)},[T]),g.useEffect(()=>{M||B[A]&&B[A]()},[M]),g.useEffect(()=>{f&&f(h,O)},[h,O]),g.useImperativeHandle(k,()=>({get cache(){return v._()},get scrollOffset(){return v.R()},get scrollSize(){return v.M()},get viewportSize(){return v.C()},scrollToIndex:H.Y,scrollTo:H.A,scrollBy:H.X}),[]);const S=Ie(h,t,X),I=Te(O,t,X,x),_=[];for(let u=S;u<=I;u++){const R=E(u),C=R.key;_.push(D(Ae,{U:N,V:u,F:v.v(u),G:v.p(u),q:a,P:R,K:q},K(C)?C:"_"+u))}return D(o,{ref:L,width:q?w:void 0,height:q?void 0:w,scrolling:M,attrs:g.useMemo(()=>({...b,style:{display:q?"inline-block":"block",[q?"overflowX":"overflowY"]:"auto",overflowAnchor:"none",contain:"strict",width:"100%",height:"100%",...b.style}}),ge(b)),children:_})}),ie=g.memo(({count:e,Component:n,handle:t})=>{const r=g.useRef(null);return g.useImperativeHandle(t,()=>({scrollToIndex:s=>{var c;(c=r.current)==null||c.scrollToIndex(s)}})),D(qe,{ref:r,children:Array.from({length:e}).map((s,c)=>D(n,{index:c},c))})});try{ie.displayName="VirtuaList",ie.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ie as V};
