import{r as T}from"./index-c6dae603.js";import{j as Z}from"./jsx-runtime-c3d7f245.js";const V=Math.min,y=Math.max,ae=Math.abs,F=Date.now,Le=Object.values,ne=setTimeout,k=(e,t,s)=>V(s,y(t,e)),K=e=>e!=null,de=e=>{const t=[...e].sort((r,n)=>r-n),s=e.length/2|0;return t.length%2===0?(t[s-1]+t[s])/2:t[s]},re=(e,t)=>{let s;const r=()=>{K(s)&&clearTimeout(s)},n=()=>{r(),s=ne(()=>{s=null,e()},t)};return n._cancel=r,n},_e=(e,t)=>{let s=F()-t;return(...r)=>{const n=F();s+t<n&&(s=n,e(...r))}},J=e=>{let t,s;return(...r)=>(t||(t=!0,s=e(...r)),s)},E=-1,A=(e,t)=>{const s=e._sizes[t];return s===E?e._defaultItemSize:s},me=(e,t,s)=>{const r=e._sizes[t]===E;return e._sizes[t]=s,e._measuredOffsetIndex=V(t,e._measuredOffsetIndex),r},G=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let s=e._measuredOffsetIndex,r=e._offsets[s];for(;s<t;)r+=A(e,s),e._offsets[++s]=r;return e._measuredOffsetIndex=t,r},pe=e=>e._length?G(e,e._length-1)+A(e,e._length-1):0,j=(e,t,s)=>{let r=0;if(s>=0)for(;t<e._length-1;){const n=A(e,t++);if((r+=n)>=s){r-n/2>=s&&t--;break}}else for(;t>0;){const n=A(e,--t);if((r-=n)<=s){r+n/2<s&&t++;break}}return k(t,0,e._length-1)},Q=(e,t,s)=>j(e,s,t-G(e,s)),ge=(e,t,s)=>e._sizes.slice(t,s+1).includes(E),we=e=>{const t=e._sizes.filter(r=>r!==E),s=t[0];e._defaultItemSize=t.every(r=>r===s)?s:de(t)},oe=(e,t,s)=>{const r=s?"unshift":"push";for(let n=e._length;n<t;n++)e._sizes[r](E),e._offsets.push(n===0?0:E);e._length=t},Ie=(e,t)=>{const s={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return oe(s,e),s},Y=(e,t,s)=>{const r=t-e._length,n=r<0;let f;return n?(f=(s?e._sizes.splice(0,-r):e._sizes.splice(r)).reduce((l,i)=>l+(i===E?e._defaultItemSize:i),0),e._offsets.splice(r)):(f=e._defaultItemSize*r,oe(e,e._length+r,s)),e._measuredOffsetIndex=s?0:k(t-1,0,e._measuredOffsetIndex),e._length=t,[f,n]},q=(e,t)=>t.reduce((s,[r,n])=>s+(n-A(e,r)),0),Se=1.5,N=0,be=1,$=2,U=1,W=2,ve=3,D=4,ie=5,X=6,le=7,H=1,B=2,ee=4,te=8,Oe=16,ye=(e,t,s=40,r=0,n=Ie(t,s),f,l)=>{let i=s*y(r-1,0),o=0,d=0,m=0,c=N,u=!1,I=!1,g=!1,p=[0,r];const w=new Set,h=()=>pe(n),b=()=>h()-i,M=_=>k(_,0,b()),C=_=>{const a=c;return c=_,c!==a&&(c===N||a===N)};return{_getCache(){return JSON.parse(JSON.stringify(n))},_getRange(){const[_,a]=p,S=Q(n,o,V(_,n._length-1)),v=j(n,S,i);return _===S&&a===v?p:p=[S,v]},_isUnmeasuredItem(_){return n._sizes[_]===E},_hasUnmeasuredItemsInTargetViewport(_){const a=Q(n,_,p[0]);return ge(n,y(0,a-1),V(n._length-1,j(n,a,i)+1))},_getItemOffset(_){const a=G(n,_);return f?a+y(0,i-h()):a},_getItemSize(_){return A(n,_)},_getItemsLength(){return n._length},_getScrollOffset(){return o},_getScrollOffsetMax:b,_getIsScrolling(){return c!==N},_getViewportSize(){return i},_getCorrectedScrollSize(){return y(h(),i)},_getJumpCount(){return d},_flushJump(){const _=m;return m=0,_},_subscribe(_,a){const S=[_,a];return w.add(S),()=>{w.delete(S)}},_update(_,a){let S,v=0;switch(_){case U:{const O=a.filter(([R,L])=>n._sizes[R]!==L);if(!O.length)break;let z=0;if(u||I){const[R]=p;o===0||(o>b()-Se?z=q(n,O.filter(([L])=>L>=R)):z=q(n,O.filter(([L])=>L<R)))}else c===$&&(z=q(n,O));z&&(m=z,d++,v+=ee);let x=!1;O.forEach(([R,L])=>{me(n,R,L)&&(x=!0)}),l&&x&&!o&&we(n),v+=B,g=S=!0;break}case W:{i!==a&&(i=a,v=B);break}case ve:{if(a[1]){const O=b()-o,[z,x]=Y(n,a[0],!0),R=x?-V(z,O):z;m+=R,o=M(o+R),d++,v=H+ee,u=!0}else Y(n,a[0]);break}case D:case ie:{if(o===a)break;if(_===D){const O=a-o,z=g;g=!1,(c===N||!z)&&!I&&C(O<0?$:be)&&(v+=te),S=ae(O)>i,v+=Oe,z||(u=!1)}o=M(a),v+=H;break}case X:{C(N)&&(v=te),u=I=!1;break}case le:{I=!0;break}}if(v){const O=()=>{w.forEach(([z,x])=>{v&z&&x()})};S?e(O):O()}}}},ue=typeof window<"u"?T.useLayoutEffect:T.useEffect,P="current",Te={},fe=(e,t)=>{if(Array.isArray(e))for(const s of e)fe(s,t);else!K(e)||typeof e=="boolean"||t.push(e)},Ce=e=>{const t=[];return fe(e,t),t},ze=e=>{const t=T.useRef(e);return ue(()=>{t[P]=e},[e]),t},xe=(e,t,s,r)=>{const[n,f]=T.useState(t),l=ze(t);if(ue(()=>e._subscribe(s,()=>{f(()=>l[P]())}),[]),r){const i=t();n!==i&&f(i)}return n},he=J(e=>{const t="scrollLeft",s=e[t];e[t]=1;const r=e[t]<1;return e[t]=s,r}),ce=(e,t,s)=>_e(r=>{if(e._getIsScrolling()&&!r.ctrlKey&&(t?r.deltaX:r.deltaY)){const n=e._getScrollOffset();n>0&&n<e._getScrollOffsetMax()&&s()}},50),Ne=(e,t,s)=>{let r,n;const f=t?"scrollLeft":"scrollTop",l=(o,d)=>t&&s?he(r)||d?-o:e._getScrollOffsetMax()-o:o,i=async o=>{if(!r)return;const d=()=>k(o(),0,e._getScrollOffsetMax());for(;;){const m=d();if(e._update(ie,m),!e._hasUnmeasuredItemsInTargetViewport(m))break;n&&n[1]();const c=e._subscribe(B,()=>{n&&n[0]()});try{await new Promise((u,I)=>{let g=!1;const p=()=>{g||(g=!0,u(),n=void 0)};n=[p,I],ne(p,250)})}catch{return}finally{c()}}r[f]=l(d()),e._update(le)};return{_initRoot(o){r=o;const d=()=>{e._update(D,l(o[f]))},m=re(()=>{d(),e._update(X)},150),c=()=>{d(),m()},u=ce(e,t,m);return o.addEventListener("scroll",c),o.addEventListener("wheel",u,{passive:!0}),()=>{o.removeEventListener("scroll",c),o.removeEventListener("wheel",u),m._cancel()}},_scrollTo(o){i(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),i(()=>o)},_scrollToIndex(o,d){o=k(o,0,e._getItemsLength()-1),i(d==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{r&&(r[f]+=l(o,!0))}}},Ae=(e,t)=>{const s=t?"scrollX":"scrollY",r=t?"offsetLeft":"offsetTop";return{_initRoot(n){let f=!1;const l=(u,I)=>{const g=I+u[r],p=u.offsetParent;return u===document.body||!p?g:l(p,g)},i=()=>{f&&e._update(D,window[s]-l(n,0))},o=re(()=>{i(),e._update(X)},150),d=()=>{i(),o()},m=ce(e,t,o),c=new IntersectionObserver(([u])=>{f=u.isIntersecting});return c.observe(n),window.addEventListener("scroll",d),window.addEventListener("wheel",m,{passive:!0}),()=>{c.disconnect(),window.removeEventListener("scroll",d),window.removeEventListener("wheel",m),o._cancel()}},_fixScrollJump:n=>{window.scrollBy(t?n:0,t?0:n)}}},Me=e=>{const t=T.useRef();return t[P]||(t[P]=e())},Ve=(e,t)=>{let s;const r=t?"width":"height",n=new WeakMap,f=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:d}of l)if(o===s)e._update(W,d[r]);else{const m=n.get(o);K(m)&&i.push([m,d[r]])}i.length&&e._update(U,i)}));return{_observeRoot(l){s=l;const i=f();return i.observe(l),()=>{i.disconnect()}},_observeItem(l,i){const o=f();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},ke=(e,t)=>{const s=t?"width":"height",r=t?"innerWidth":"innerHeight",n=new WeakMap,f=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:d}of l){const m=n.get(o);K(m)&&i.push([m,d[s]])}i.length&&e._update(U,i)}));return{_observeRoot(){const l=()=>{e._update(W,window[r])};return window.addEventListener("resize",l),l(),()=>{window.removeEventListener("resize",l),f().disconnect()}},_observeItem(l,i){const o=f();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},Ue=(e,t)=>{let s;const r="height",n="width",f=new WeakMap,l=new Set,i=new Set,o=new Map,d=(c,u)=>`${c}-${u}`,m=J(()=>new ResizeObserver(c=>{const u=new Set,I=new Set;for(const{target:g,contentRect:p}of c)if(g===s)e._update(W,p[r]),t._update(W,p[n]);else{const w=f.get(g);if(w){const[h,b]=w,M=d(h,b),C=o.get(M),_=[p[r],p[n]];let a,S;C?(C[0]!==_[0]&&(a=!0),C[1]!==_[1]&&(S=!0)):a=S=!0,a&&u.add(h),S&&I.add(b),(a||S)&&o.set(M,_)}}if(u.size){const g=[];u.forEach(p=>{let w=0;i.forEach(h=>{const b=o.get(d(p,h));b&&(w=y(w,b[0]))}),w&&g.push([p,w])}),e._update(U,g)}if(I.size){const g=[];I.forEach(p=>{let w=0;l.forEach(h=>{const b=o.get(d(h,p));b&&(w=y(w,b[1]))}),w&&g.push([p,w])}),t._update(U,g)}}));return{_observeRoot(c){s=c;const u=m();return u.observe(c),()=>{u.disconnect()}},_observeItem(c,u,I){const g=m();return f.set(c,[u,I]),l.add(u),i.add(I),g.observe(c),()=>{f.delete(c),g.unobserve(c)}}}},se=T.forwardRef(({children:e,attrs:t,width:s,height:r,scrolling:n},f)=>Z("div",{ref:f,...t,children:Z("div",{style:T.useMemo(()=>({position:"relative",visibility:"hidden",width:s??"100%",height:r??"100%",pointerEvents:n?"none":"auto"}),[s,r,n]),children:e})}));try{se.displayName="Viewport",se.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{ve as A,H as U,se as V,Me as a,xe as b,ue as c,Te as d,K as e,Ce as f,ye as g,ke as h,Ae as i,B as j,te as k,ee as l,y as m,V as n,Ue as o,Ne as p,Oe as q,P as r,Ve as s,ze as u,Le as v};
//# sourceMappingURL=Viewport-d99b3875.js.map
