import{j as I}from"./jsx-runtime-f8a6c6ea.js";import{r as f}from"./index-5284b0bf.js";import{s as de}from"./index-847519d5.js";const q=Math.min,D=Math.max,Z=Date.now,z=e=>e!=null,Q=(e,t)=>Array.from({length:e},(n,o)=>t(o)),le=e=>{let t,n;return(...o)=>(t||(t=!0,n=e(...o)),n)},C=(e,t)=>{const n=e.t[t];return n===-1?e.o:n},ce=(e,t,n)=>{if(!e.i)return 0;if(e.l>=t)return n?e.u[t]+C(e,t):e.u[t];let o=e.l,i=e.u[o];for(;o<=t&&(e.u[o]=i,o!==t||n);)i+=C(e,o),o++;return e.l=t,i},ee=(e,t)=>ce(e,t),ue=(e,t,n)=>{let o=0;if(n>=0)for(;t<e.i-1;){const i=C(e,t++);if((o+=i)>=n){o-i/2>=n&&t--;break}}else for(;t>0;){const i=C(e,--t);if((o-=i)<=n){o+i/2<n&&t++;break}}return q(D(t,0),e.i-1)},te=(e,t,n,o)=>ue(e,n,t-o),ne=ue,re=(e,t,n)=>({o:t,i:e,l:n?q(n.l,e-1):0,t:Q(e,o=>{const i=n&&n.t[o];return z(i)?i:-1}),u:Q(e,o=>{if(o===0)return 0;const i=n&&n.u[o];return z(i)?i:-1})}),fe=(e,t,n,o,i=0,a,L)=>{let m,w=t*D(i-1,0),b=0,s=[],l=re(e,t),h=0,u=[0,i];const p=new Set;return{_(){const[r,c]=u,v=ee(l,r),d=te(l,b,r,v),R=ne(l,d,w);return r===d&&c===R?u:u=[d,R]},h:r=>l.t[r]===-1,g:r=>((c,v,d)=>{for(let R=v;R<=d;R++)if(c.t[R]===-1)return!0;return!1})(l,r,ne(l,r,w)),m:r=>ee(l,r),S:r=>C(l,r),v:()=>b,p:()=>w,I:()=>(r=>ce(r,r.i-1,!0))(l),R:()=>s,T:()=>n,M:()=>o,C:r=>te(l,r,0,0),O:()=>(m&&m[1](),new Promise((r,c)=>{m=[()=>{Promise.resolve().then(()=>{r(),m=void 0})},c]})),W:r=>(p.add(r),()=>{p.delete(r)}),H(r,c){(()=>{switch(r){case 1:{const d=c.filter(([V,E])=>l.t[V]!==E);if(!d.length)return!1;const R=[];return d.forEach(([V,E])=>{R.push([E-C(l,V),V]),((_,x,k)=>{_.t[x]=k,_.l=q(x,_.l)})(l,V,E)}),s=R,!0}case 2:return w!==c&&(w=c,!0);case 3:case 4:{const d=b;return(b=c)!==d}}})()&&(p.forEach(d=>{d()}),r===3?L(b):m&&r===1&&m[0]())},k:()=>h,D(r){const c=h;h=r,h===0?a(!1):c!==0||h!==1&&h!==2||a(!0)},J(r){l.i!==r&&(l=re(r,t,l))}}},j=typeof window<"u"?f.useLayoutEffect:f.useEffect,A=(e,t)=>de.useSyncExternalStore(e,t,t),oe=le(e=>{const t="scrollLeft",n=e[t];e[t]=1;const o=e[t]===0;return e[t]=n,o}),he=(e,t)=>{let n;const o=e.T(),i=e.M(),a=o?"scrollLeft":"scrollTop",L=()=>n?o?n.scrollWidth:n.scrollHeight:0,m=(s,l)=>{n&&(o&&i&&oe(n)&&(s*=-1),l?n[a]+=s:(n[a]=s,e.D(3)))},w=async(s,l)=>{const h=()=>{let u=l();const p=L(),r=e.p();return p-(u+r)<=0&&(u=p-r),u};if(e.g(s)){do{e.H(4,h());try{await e.O()}catch{return}}while(e.g(s));m(h())}else{const u=h();m(u),e.H(4,u)}},b=s=>s.reduce((l,[h])=>l+h,0);return{$(s){n=s;const l=()=>{let r=s[a];o&&i&&oe(s)&&(r*=-1);const c=e.v();if(c===r)return;const v=e.k(),d=t();v!==0&&d||v===3||e.D(c>r?2:1),e.H(3,r)},h=(()=>{let r;const c=()=>{z(r)&&clearTimeout(r)},v=()=>{c(),r=setTimeout(()=>{r=null,l(),e.D(0)},150)};return v.L=c,v})(),u=()=>{l(),h()},p=(()=>{let r=Z()-50;return(...c)=>{const v=Z();r+50<v&&(r=v,(d=>{if(e.k()!==0&&!d.ctrlKey&&(o?d.deltaX:d.deltaY)){const R=e.v();R>0&&R<e.I()-e.p()&&h()}})(...c))}})();return s.addEventListener("scroll",u),s.addEventListener("wheel",p,{passive:!0}),()=>{s.removeEventListener("scroll",u),s.removeEventListener("wheel",p),h.L()}},j:L,A(s){s=D(s,0),w(e.C(s),()=>s)},F(s,l){s=D(q(s,l-1),0),w(s,()=>e.m(s))},P:(s,l)=>{const h=e.k();if(h===2){const u=b(s);u&&m(u,!0)}else if(h===3){const u=e.v();if(u!==0){const p=b(s);if(e.I()-(u+e.p()+p)<=0)p&&m(u+p);else{const r=s.reduce((c,[v,d])=>(d<l&&(c+=v),c),0);r&&m(r,!0)}}}}}},M="current",me=e=>{const t=f.useRef();return t[M]||(t[M]=e())},se=e=>{const t=f.useRef(e);return j(()=>{t[M]=e},[e]),t},pe=f.memo(({U:e,B:t,V:n,q:o,G:i})=>{const a=f.useRef(null),L=A(n.W,()=>n.m(o)),m=A(n.W,()=>n.h(o));return j(()=>t.K(a[M],o),[o]),I(i,{ref:a,style:f.useMemo(()=>{const w=n.T(),b=n.M()?"right":"left",s={margin:0,padding:0,position:"absolute",[w?"height":"width"]:"100%",[w?"top":b]:0,[w?b:"top"]:L,visibility:m?"hidden":"visible"};return w&&(s.display="flex"),s},[L,m]),children:e})}),ve=f.forwardRef(({children:e,scrollSize:t,scrolling:n,horizontal:o,attrs:i},a)=>I("div",{ref:a,...i,children:I("div",{style:f.useMemo(()=>({position:"relative",visibility:"hidden",width:o?t:"100%",height:o?"100%":t,pointerEvents:n?"none":"auto"}),[t,n]),children:e})})),ge=({U:e,N:t,V:n,G:o,X:i,Y:a})=>{const L=A(n.W,n.I),m=n.T();return I(o,{ref:t,scrollSize:L,scrolling:i,horizontal:m,attrs:f.useMemo(()=>({...a,style:{overflow:m?"auto hidden":"hidden auto",contain:"strict",width:"100%",height:"100%",padding:0,margin:0,...a.style}}),[a]),children:e})},ye=f.forwardRef(({children:e,itemSize:t=40,overscan:n=4,initialItemCount:o,horizontal:i,rtl:a,element:L=ve,itemElement:m="div",onScroll:w,onScrollStop:b,onRangeChange:s,...l},h)=>{const u=f.useMemo(()=>{const y=[];return f.Children.forEach(e,S=>{(g=>!z(g)||typeof g=="boolean")(S)||y.push(S)}),y},[e]),p=u.length,r=se(w),c=se(b),[v,d]=f.useState(new Set),[R,V]=f.useState(!1),[E,_,x]=me(()=>{const y=fe(p,t,!!i,!!a,o,g=>{V(g),g||(d(new Set),c[M]&&c[M]())},g=>{r[M]&&r[M](g)}),S=(g=>{let K,O=!1;const X=g.T()?"width":"height",P=new WeakMap,J=le(()=>new ResizeObserver(T=>{const H=[];for(const{target:W,contentRect:Y}of T)if(W===K)g.H(2,Y[X]);else{const $=P.get(W);z($)&&H.push([$,Y[X]])}H.length&&(g.H(1,H),O=!0)}));return{Z(T){K=T;const H=J();return H.observe(T),()=>{H.disconnect()}},K(T,H){const W=J();return P.set(T,H),W.observe(T),()=>{P.delete(T),W.unobserve(T)}},ee(){const T=O;return O=!1,T}}})(y);return[y,S,he(y,S.ee)]});E.J(p);const[k,G]=A(E.W,E._),N=A(E.W,E.R),U=f.useRef(null);j(()=>{const y=U[M],S=_.Z(y),g=x.$(y);return()=>{S(),g()}},[]),j(()=>{N.length&&x.P(N,k)},[N]),f.useEffect(()=>{s&&s({start:k,end:G,count:p})},[k,G]),f.useImperativeHandle(h,()=>({get scrollOffset(){return E.v()},get scrollSize(){return x.j()},get viewportSize(){return E.p()},scrollToIndex(y){x.F(y,p)},scrollTo:x.A,scrollBy(y){x.A(E.v()+y)}}),[p]);const B=D(k-n,0),F=q(G+n,p-1),ae=f.useMemo(()=>{const y=[];for(let S=B;S<=F;S++)v.add(S);return v.forEach(S=>{const g=u[S];z(g)&&y.push(I(pe,{B:_,V:E,q:S,G:m,U:g},(g==null?void 0:g.key)||S))}),y},[u,v,B,F]);return I(ge,{N:U,V:E,G:L,X:R,U:ae,Y:l})}),ie=f.memo(({count:e,Component:t,handle:n})=>{const o=f.useRef(null);return f.useImperativeHandle(n,()=>({scrollToIndex:i=>{var a;(a=o.current)==null||a.scrollToIndex(i)}})),I(ye,{ref:o,children:Array.from({length:e}).map((i,a)=>I(t,{index:a},a))})});try{ie.displayName="VirtuaList",ie.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{ie as V};
//# sourceMappingURL=virtua-221a4560.js.map
