import{j}from"./jsx-runtime-c3d7f245.js";import{r as h}from"./index-c6dae603.js";import{r as ue}from"./index-eb008d06.js";const D=Math.min,V=Math.max,ae=Math.abs,G=Date.now,de=Object.values,fe=Array.isArray,ne=setTimeout,B=(e,r,t)=>D(t,V(r,e)),Y=e=>e!=null,he=(e,r)=>{let t;const n=()=>{Y(t)&&clearTimeout(t)},s=()=>{n(),t=ne(()=>{t=null,e()},r)};return s.t=n,s},K=e=>{let r,t;return(...n)=>(r||(r=!0,t=e(...n)),t)},oe=e=>getComputedStyle(e),pe=e=>e?parseFloat(e):0,H=-1,F=(e,r)=>{const t=e.o[r];return t===H?e.i:t},U=(e,r)=>{if(!e.l)return 0;if(e.u>=r)return e.h[r];let t=e.u,n=e.h[t];for(;t<r;)n+=F(e,t),e.h[++t]=n;return e.u=r,n},Q=(e,r,t)=>{let n=U(e,t);for(;t>=0&&t<e.l;)if(n<=r){const s=F(e,t);if(n+s>r)break;n+=s,t++}else n-=F(e,--t);return B(t,0,e.l-1)},Z=(e,r,t,n)=>{const s=Q(e,r,D(t,e.l-1));return[s,Q(e,r+n,s)]},se=(e,r,t)=>{const n=t?"unshift":"push";for(let s=e.l;s<r;s++)e.o[n](H),e.h.push(s===0?0:H);e.l=r},ee=(e,r,t)=>{const n=r-e.l,s=n<0;let l;return s?(l=(t?e.o.splice(0,-n):e.o.splice(n)).reduce((u,o)=>u+(o===H?e.i:o),0),e.h.splice(n)):(l=e.i*n,se(e,e.l+n,t)),e.u=t?0:B(r-1,0,e.u),e.l=r,[l,s]},te=(e,r,t)=>r.reduce((n,[s,l])=>{const u=l-F(e,s);return(!t||u>0)&&(n+=u),n},0),me=(e,r,t=40,n=0,s=((o,i)=>{const d={i,l:0,u:0,o:[],h:[]};return se(d,o),d})(r,t),l,u)=>{let o=t*V(n-1,0),i=0,d=0,g=0,R=0,S=!1,L=!1,C=!1,_=[0,n];const W=new Set,z=()=>(c=>c.l?U(c,c.l-1)+F(c,c.l-1):0)(s),J=()=>z()-o,f=c=>B(c,0,J()),q=c=>{const a=R;return R=c,R!==a};return{_:()=>JSON.parse(JSON.stringify(s)),g(){const[c,a]=_,[y,p]=Z(s,i,c,o);return c===y&&a===p?_:_=[y,p]},m:c=>s.o[c]===H,p(c){const[a,y]=Z(s,c,_[0],o);return((p,m,b)=>p.o.slice(V(0,m-1),D(p.l-1,b+1)+1).includes(H))(s,a,y)},v(c){const a=U(s,c);return l?a+V(0,o-z()):a},S:c=>F(s,c),I:()=>s.l,R:()=>i,k:J,O:()=>R,C:()=>o,T:()=>V(z(),o),M:()=>d,H(){const c=g;return g=0,c},J(c,a){const y=[c,a];return W.add(y),()=>{W.delete(y)}},W(c,a){let y,p=0;switch(c){case 1:{const m=a.filter(([w,k])=>s.o[w]!==k);if(!m.length)break;let b=0;if(!S){const[w]=_;i===0||(b=i>J()-1.5?te(s,m,!0):te(s,m.filter(([k])=>k<w)))}b&&(g=b,d++,p+=4);let T=!1;m.forEach(([w,k])=>{((I,E,O)=>{const v=I.o[E]===H;return I.o[E]=O,I.u=D(E,I.u),v})(s,w,k)&&(T=!0)}),u&&T&&!i&&(w=>{const k=w.o.filter(E=>E!==H),I=k[0];w.i=k.every(E=>E===I)?I:(E=>{const O=[...E].sort((x,A)=>x-A),v=E.length/2|0;return O.length%2==0?(O[v-1]+O[v])/2:O[v]})(k)})(s),p+=2,C=y=!0;break}case 2:o!==a&&(o=a,p=2);break;case 3:if(a[1]){const m=J()-i,[b,T]=ee(s,a[0],!0),w=T?-D(b,m):b;g+=w,i=f(i+w),d++,p=5}else ee(s,a[0]);break;case 4:case 5:if(i===a)break;if(c===4){const m=a-i,b=C;C=!1,R!==0&&b||L||q(m<0?2:1)&&(p+=8),y=ae(m)>o,p+=16}else S=!0;i=f(a),p+=1;break;case 6:q(0)&&(p=8),L=S=!1;break;case 7:S=!1,L=!0}if(p){const m=()=>{W.forEach(([b,T])=>{p&b&&T()})};y?e(m):m()}}}},le=typeof window<"u",ve=K(e=>{const r="scrollLeft",t=e[r];e[r]=1;const n=e[r]<1;return e[r]=t,n}),ie=K(()=>!!le&&oe(document.body).direction==="rtl"),P=le?h.useLayoutEffect:h.useEffect,M="current",ge={},ce=(e,r)=>{if(fe(e))for(const t of e)ce(t,r);else Y(e)&&typeof e!="boolean"&&r.push(e)},ye=e=>{const r=[];return ce(e,r),r},be=(e,r,t)=>V(e-(t===1?1:V(1,r)),0),we=(e,r,t,n)=>D(e+(t===2?1:V(1,r)),n-1),$=e=>{const r=h.useRef(e);return P(()=>{r[M]=e},[e]),r},N=(e,r,t,n)=>{const[s,l]=h.useState(r),u=$(r);if(P(()=>e.J(t,()=>{l(()=>u[M]())}),[]),n){const o=r();s!==o&&l(o)}return s},Re=(e,r,t)=>(()=>{let n=G()-50;return(...s)=>{const l=G();n+50<l&&(n=l,(u=>{if(e.O()!==0&&!u.ctrlKey&&(r?u.deltaX:u.deltaY)){const o=e.R();o>0&&o<e.k()&&t()}})(...s))}})(),ke=(e,r,t,n)=>ve(e)||n?-t:r.k()-t,Ee=(e,r)=>{let t,n;const s=r?"scrollLeft":"scrollTop",l=(o,i)=>r&&ie()?ke(t,e,o,i):o,u=async o=>{if(!t)return;const i=()=>B(o(),0,e.k());for(;;){const d=i();if(e.W(5,d),!e.p(d))break;n&&n[1]();const g=e.J(2,()=>{n&&n[0]()});try{await new Promise((R,S)=>{let L=!1;const C=()=>{L||(L=!0,R(),n=void 0)};n=[C,S],ne(C,250)})}catch{return}finally{g()}}t[s]=l(i()),e.W(7)};return{L(o){t=o;const i=()=>{e.W(4,l(o[s]))},d=he(()=>{i(),e.W(6)},150),g=()=>{i(),d()},R=Re(e,r,d);return o.addEventListener("scroll",g),o.addEventListener("wheel",R,{passive:!0}),()=>{o.removeEventListener("scroll",g),o.removeEventListener("wheel",R),d.t()}},$(o){u(()=>o)},B(o){o+=e.R(),u(()=>o)},j(o,i){o=B(o,0,e.I()-1),u(i==="end"?()=>e.v(o)+e.S(o)-e.C():()=>e.v(o))},D:o=>{t&&(t[s]+=l(o,!0))}}},xe=e=>{const r=h.useRef();return r[M]||(r[M]=e())},Le={box:"border-box"},Ie=(e,r)=>{let t;const n=r?"width":"height",s=new WeakMap,l=K(()=>new ResizeObserver(u=>{const o=[];for(const{target:i,contentRect:d}of u)if(i.offsetParent)if(i===t)e.W(2,d[n]+d[r?"left":"top"]+pe(oe(t)[r?"paddingRight":"paddingBottom"]));else{const g=s.get(i);Y(g)&&o.push([g,d[n]])}o.length&&e.W(1,o)}));return{N(u){t=u;const o=l();return o.observe(u,Le),()=>{o.disconnect()}},U(u,o){const i=l();return s.set(u,o),i.observe(u),()=>{s.delete(u),i.unobserve(u)}}}},Me=h.forwardRef(({children:e,attrs:r,width:t,height:n,scrolling:s},l)=>j("div",{ref:l,...r,children:j("div",{style:h.useMemo(()=>({position:"relative",visibility:"hidden",width:t??"100%",height:n??"100%",pointerEvents:s?"none":"auto"}),[t,n,s]),children:e})})),Se=h.memo(({V:e,A:r,F:t,P:n,X:s,Y:l})=>{const u=h.useRef(null),o=N(t,()=>t.v(n),2,!0),i=N(t,()=>t.m(n),2,!0);return P(()=>r.U(u[M],n),[n]),j(s,{ref:u,style:h.useMemo(()=>{const d=ie()?"right":"left",g={margin:0,padding:0,position:"absolute",[l?"height":"width"]:"100%",[l?"top":d]:0,[l?d:"top"]:o,visibility:i?"hidden":"visible"};return l&&(g.display="flex"),g},[o,i]),children:e})}),_e=h.forwardRef(({children:e,overscan:r=4,initialItemSize:t,initialItemCount:n,shift:s,horizontal:l,reverse:u,cache:o,components:{Root:i=Me,Item:d="div"}=ge,onScroll:g,onScrollStop:R,onRangeChange:S,...L},C)=>{const _=h.useMemo(()=>ye(e),[e]),W=_.length,z=$(g),J=$(R),[f,q,c,a]=xe(()=>{const v=!!l,x=me(ue.flushSync,W,t,n,o,!!u,!t);return[x,Ie(x,v),Ee(x,v),v]});W!==f.I()&&f.W(3,[W,s]);const[y,p]=N(f,f.g,3),m=N(f,f.O,8),b=N(f,f.M,4),T=N(f,f.T,2,!0),w=h.useRef(null),k=m!==0;P(()=>{const v=w[M],x=q.N(v),A=c.L(v),X=f.J(16,()=>{z[M]&&z[M](f.R())});return()=>{x(),A(),X()}},[]),P(()=>{const v=f.H();v&&c.D(v)},[b]),h.useEffect(()=>{k||J[M]&&J[M]()},[k]),h.useEffect(()=>{S&&S(y,p)},[y,p]),h.useImperativeHandle(C,()=>({get cache(){return f._()},get scrollOffset(){return f.R()},get scrollSize(){return f.T()},get viewportSize(){return f.C()},scrollToIndex:c.j,scrollTo:c.$,scrollBy:c.B}),[]);const I=be(y,r,m),E=we(p,r,m,W),O=h.useMemo(()=>{const v=[];for(let x=I;x<=E;x++){const A=_[x],X=A.key;v.push(j(Se,{A:q,F:f,P:x,X:d,V:A,Y:a},Y(X)?X:"_"+x))}return v},[_,I,E]);return j(i,{ref:w,width:a?T:void 0,height:a?void 0:T,scrolling:k,attrs:h.useMemo(()=>({...L,style:{overflow:"auto",display:a?"inline-block":"block",contain:"strict",width:"100%",height:"100%",...L.style}}),de(L)),children:O})}),re=h.memo(({count:e,Component:r,handle:t})=>{const n=h.useRef(null);return h.useImperativeHandle(t,()=>({scrollToIndex:s=>{var l;(l=n.current)==null||l.scrollToIndex(s)}})),j(_e,{ref:n,children:Array.from({length:e}).map((s,l)=>j(r,{index:l},l))})});try{re.displayName="VirtuaList",re.__docgenInfo={description:"",displayName:"VirtuaList",props:{count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},Component:{defaultValue:null,description:"",name:"Component",required:!0,type:{name:"ForwardRefExoticComponent<{ index: number; } & RefAttributes<HTMLDivElement>>"}},handle:{defaultValue:null,description:"",name:"handle",required:!1,type:{name:"Ref<ListHandle>"}}}}}catch{}export{re as V};
//# sourceMappingURL=virtua-5bce7ae0.js.map
