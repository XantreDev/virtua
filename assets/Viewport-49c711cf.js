import{r as L}from"./index-c6dae603.js";import{j as Z}from"./jsx-runtime-c3d7f245.js";const V=Math.min,y=Math.max,me=Math.abs,Q=Date.now,xe=Object.values,pe=Array.isArray,re=setTimeout,k=(e,t,s)=>V(s,y(t,e)),K=e=>e!=null,ge=e=>{const t=[...e].sort((r,n)=>r-n),s=e.length/2|0;return t.length%2===0?(t[s-1]+t[s])/2:t[s]},oe=(e,t)=>{let s;const r=()=>{K(s)&&clearTimeout(s)},n=()=>{r(),s=re(()=>{s=null,e()},t)};return n._cancel=r,n},we=(e,t)=>{let s=Q()-t;return(...r)=>{const n=Q();s+t<n&&(s=n,e(...r))}},J=e=>{let t,s;return(...r)=>(t||(t=!0,s=e(...r)),s)},ie=e=>getComputedStyle(e),B=e=>e?parseFloat(e):0,E=-1,N=(e,t)=>{const s=e._sizes[t];return s===E?e._defaultItemSize:s},Se=(e,t,s)=>{const r=e._sizes[t]===E;return e._sizes[t]=s,e._measuredOffsetIndex=V(t,e._measuredOffsetIndex),r},F=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let s=e._measuredOffsetIndex,r=e._offsets[s];for(;s<t;)r+=N(e,s),e._offsets[++s]=r;return e._measuredOffsetIndex=t,r},Ie=e=>e._length?F(e,e._length-1)+N(e,e._length-1):0,j=(e,t,s)=>{let r=0;if(s>=0)for(;t<e._length-1;){const n=N(e,t++);if((r+=n)>=s){r-n/2>=s&&t--;break}}else for(;t>0;){const n=N(e,--t);if((r-=n)<=s){r+n/2<s&&t++;break}}return k(t,0,e._length-1)},Y=(e,t,s)=>j(e,s,t-F(e,s)),be=(e,t,s)=>e._sizes.slice(t,s+1).includes(E),Oe=e=>{const t=e._sizes.filter(r=>r!==E),s=t[0];e._defaultItemSize=t.every(r=>r===s)?s:ge(t)},le=(e,t,s)=>{const r=s?"unshift":"push";for(let n=e._length;n<t;n++)e._sizes[r](E),e._offsets.push(n===0?0:E);e._length=t},ve=(e,t)=>{const s={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return le(s,e),s},$=(e,t,s)=>{const r=t-e._length,n=r<0;let u;return n?(u=(s?e._sizes.splice(0,-r):e._sizes.splice(r)).reduce((l,i)=>l+(i===E?e._defaultItemSize:i),0),e._offsets.splice(r)):(u=e._defaultItemSize*r,le(e,e._length+r,s)),e._measuredOffsetIndex=s?0:k(t-1,0,e._measuredOffsetIndex),e._length=t,[u,n]},q=(e,t,s)=>t.reduce((r,[n,u])=>{const l=u-N(e,n);return(!s||l>0)&&(r+=l),r},0),he=1.5,x=0,ze=1,H=2,U=1,W=2,Re=3,D=4,ue=5,X=6,fe=7,ee=1,G=2,te=4,se=8,Ee=16,Ne=(e,t,s=40,r=0,n=ve(t,s),u,l)=>{let i=s*y(r-1,0),o=0,a=0,p=0,c=x,f=!1,S=!1,g=!1,m=[0,r];const w=new Set,z=()=>Ie(n),b=()=>z()-i,A=_=>k(_,0,b()),T=_=>{const d=c;return c=_,c!==d&&(c===x||d===x)};return{_getCache(){return JSON.parse(JSON.stringify(n))},_getRange(){const[_,d]=m,I=Y(n,o,V(_,n._length-1)),O=j(n,I,i);return _===I&&d===O?m:m=[I,O]},_isUnmeasuredItem(_){return n._sizes[_]===E},_hasUnmeasuredItemsInTargetViewport(_){const d=Y(n,_,m[0]);return be(n,y(0,d-1),V(n._length-1,j(n,d,i)+1))},_getItemOffset(_){const d=F(n,_);return u?d+y(0,i-z()):d},_getItemSize(_){return N(n,_)},_getItemsLength(){return n._length},_getScrollOffset(){return o},_getScrollOffsetMax:b,_getIsScrolling(){return c!==x},_getViewportSize(){return i},_getCorrectedScrollSize(){return y(z(),i)},_getJumpCount(){return a},_flushJump(){const _=p;return p=0,_},_subscribe(_,d){const I=[_,d];return w.add(I),()=>{w.delete(I)}},_update(_,d){let I,O=0;switch(_){case U:{const v=d.filter(([R,M])=>n._sizes[R]!==M);if(!v.length)break;let h=0;if(f||S){const[R]=m;o===0||(o>b()-he?h=q(n,v,!0):h=q(n,v.filter(([M])=>M<R)))}else c===H&&(h=q(n,v));h&&(p=h,a++,O+=te);let C=!1;v.forEach(([R,M])=>{Se(n,R,M)&&(C=!0)}),l&&C&&!o&&Oe(n),O+=G,g=I=!0;break}case W:{i!==d&&(i=d,O=G);break}case Re:{if(d[1]){const v=b()-o,[h,C]=$(n,d[0],!0),R=C?-V(h,v):h;p+=R,o=A(o+R),a++,O=ee+te,f=!0}else $(n,d[0]);break}case D:case ue:{if(o===d)break;if(_===D){const v=d-o,h=g;g=!1,(c===x||!h)&&!S&&T(v<0?H:ze)&&(O+=se),I=me(v)>i,O+=Ee,h||(f=!1)}o=A(d),O+=ee;break}case X:{T(x)&&(O=se),f=S=!1;break}case fe:{S=!0;break}}if(O){const v=()=>{w.forEach(([h,C])=>{O&h&&C()})};I?e(v):v()}}}},ce=typeof window<"u"?L.useLayoutEffect:L.useEffect,P="current",Ae={},de=(e,t)=>{if(pe(e))for(const s of e)de(s,t);else!K(e)||typeof e=="boolean"||t.push(e)},Me=e=>{const t=[];return de(e,t),t},ye=e=>{const t=L.useRef(e);return ce(()=>{t[P]=e},[e]),t},Ve=(e,t,s,r)=>{const[n,u]=L.useState(t),l=ye(t);if(ce(()=>e._subscribe(s,()=>{u(()=>l[P]())}),[]),r){const i=t();n!==i&&u(i)}return n},Le=J(e=>{const t="scrollLeft",s=e[t];e[t]=1;const r=e[t]<1;return e[t]=s,r}),ae=(e,t,s)=>we(r=>{if(e._getIsScrolling()&&!r.ctrlKey&&(t?r.deltaX:r.deltaY)){const n=e._getScrollOffset();n>0&&n<e._getScrollOffsetMax()&&s()}},50),ke=(e,t,s)=>{let r,n;const u=t?"scrollLeft":"scrollTop",l=(o,a)=>t&&s?Le(r)||a?-o:e._getScrollOffsetMax()-o:o,i=async o=>{if(!r)return;const a=()=>k(o(),0,e._getScrollOffsetMax());for(;;){const p=a();if(e._update(ue,p),!e._hasUnmeasuredItemsInTargetViewport(p))break;n&&n[1]();const c=e._subscribe(G,()=>{n&&n[0]()});try{await new Promise((f,S)=>{let g=!1;const m=()=>{g||(g=!0,f(),n=void 0)};n=[m,S],re(m,250)})}catch{return}finally{c()}}r[u]=l(a()),e._update(fe)};return{_initRoot(o){r=o;const a=()=>{e._update(D,l(o[u]))},p=oe(()=>{a(),e._update(X)},150),c=()=>{a(),p()},f=ae(e,t,p);return o.addEventListener("scroll",c),o.addEventListener("wheel",f,{passive:!0}),()=>{o.removeEventListener("scroll",c),o.removeEventListener("wheel",f),p._cancel()}},_scrollTo(o){i(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),i(()=>o)},_scrollToIndex(o,a){o=k(o,0,e._getItemsLength()-1),i(a==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{r&&(r[u]+=l(o,!0))}}},Ue=(e,t)=>{const s=t?"scrollX":"scrollY",r=t?"offsetLeft":"offsetTop";return{_initRoot(n){let u=!1;const l=(f,S)=>{const g=S+f[r],m=f.offsetParent;return f===document.body||!m?g:l(m,g)},i=()=>{u&&e._update(D,window[s]-l(n,0))},o=oe(()=>{i(),e._update(X)},150),a=()=>{i(),o()},p=ae(e,t,o),c=new IntersectionObserver(([f])=>{u=f.isIntersecting});return c.observe(n),window.addEventListener("scroll",a),window.addEventListener("wheel",p,{passive:!0}),()=>{c.disconnect(),window.removeEventListener("scroll",a),window.removeEventListener("wheel",p),o._cancel()}},_fixScrollJump:n=>{window.scrollBy(t?n:0,t?0:n)}}},We=e=>{const t=L.useRef();return t[P]||(t[P]=e())},_e={box:"border-box"},De=(e,t)=>{let s;const r=t?"width":"height",n=new WeakMap,u=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:a}of l)if(o===s)e._update(W,a[r]+a[t?"left":"top"]+B(ie(s)[t?"paddingRight":"paddingBottom"]));else{const p=n.get(o);K(p)&&i.push([p,a[r]])}i.length&&e._update(U,i)}));return{_observeRoot(l){s=l;const i=u();return i.observe(l,_e),()=>{i.disconnect()}},_observeItem(l,i){const o=u();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},Pe=(e,t)=>{const s=t?"width":"height",r=t?"innerWidth":"innerHeight",n=new WeakMap,u=J(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:a}of l){const p=n.get(o);K(p)&&i.push([p,a[s]])}i.length&&e._update(U,i)}));return{_observeRoot(){const l=()=>{e._update(W,window[r])};return window.addEventListener("resize",l),l(),()=>{window.removeEventListener("resize",l),u().disconnect()}},_observeItem(l,i){const o=u();return n.set(l,i),o.observe(l),()=>{n.delete(l),o.unobserve(l)}}}},Ke=(e,t)=>{let s;const r="height",n="width",u=new WeakMap,l=new Set,i=new Set,o=new Map,a=(c,f)=>`${c}-${f}`,p=J(()=>new ResizeObserver(c=>{const f=new Set,S=new Set;for(const{target:g,contentRect:m}of c)if(g===s){const w=ie(s);e._update(W,m[r]+m.top+B(w.paddingBottom)),t._update(W,m[n]+m.left+B(w.paddingRight))}else{const w=u.get(g);if(w){const[z,b]=w,A=a(z,b),T=o.get(A),_=[m[r],m[n]];let d,I;T?(T[0]!==_[0]&&(d=!0),T[1]!==_[1]&&(I=!0)):d=I=!0,d&&f.add(z),I&&S.add(b),(d||I)&&o.set(A,_)}}if(f.size){const g=[];f.forEach(m=>{let w=0;i.forEach(z=>{const b=o.get(a(m,z));b&&(w=y(w,b[0]))}),w&&g.push([m,w])}),e._update(U,g)}if(S.size){const g=[];S.forEach(m=>{let w=0;l.forEach(z=>{const b=o.get(a(z,m));b&&(w=y(w,b[1]))}),w&&g.push([m,w])}),t._update(U,g)}}));return{_observeRoot(c){s=c;const f=p();return f.observe(c,_e),()=>{f.disconnect()}},_observeItem(c,f,S){const g=p();return u.set(c,[f,S]),l.add(f),i.add(S),g.observe(c),()=>{u.delete(c),g.unobserve(c)}}}},ne=L.forwardRef(({children:e,attrs:t,width:s,height:r,scrolling:n},u)=>Z("div",{ref:u,...t,children:Z("div",{style:L.useMemo(()=>({position:"relative",visibility:"hidden",width:s??"100%",height:r??"100%",pointerEvents:n?"none":"auto"}),[s,r,n]),children:e})}));try{ne.displayName="Viewport",ne.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Re as A,ee as U,ne as V,We as a,Ve as b,ce as c,Ae as d,K as e,Me as f,Ne as g,Pe as h,Ue as i,G as j,se as k,te as l,y as m,V as n,Ke as o,ke as p,Ee as q,P as r,De as s,ye as u,xe as v};
//# sourceMappingURL=Viewport-49c711cf.js.map
