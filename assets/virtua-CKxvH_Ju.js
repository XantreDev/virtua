import{j as B}from"./jsx-runtime-DCrfGL6_.js";import{r as R}from"./index-98wxwTcn.js";import{r as me}from"./index-SCI4cgSJ.js";const q=Math.min,A=Math.max,ne=Math.abs,pe=Array.isArray,Q=setTimeout,ie=(e,t,n)=>q(n,A(t,e)),Z=e=>e!=null,le=e=>[...e].sort((t,n)=>t-n),ce=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},te=e=>{let t,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},V=-1,J=(e,t,n)=>{const r=n?"unshift":"push";for(let s=0;s<t;s++)e[r](V);return e},G=(e,t)=>{const n=e.t[t];return n===V?e.o:n},ve=(e,t,n)=>{const r=e.t[t]===V;return e.t[t]=n,e.i=q(t,e.i),r},ee=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let n=e.i,r=e.u[n];for(;n<t;)r+=G(e,n),e.u[++n]=r;return e.i=t,r},re=(e,t,n)=>{for(;n>=0&&n<e.l;){const r=ee(e,n);if(r<=t){if(r+G(e,n)>t)break;n++}else n--}return ie(n,0,e.l-1)},oe=(e,t,n)=>{const r=t-e.l;return e.i=n?-1:q(t-1,e.i),e.l=t,r>0?(J(e.u,r),J(e.t,r,n),e.o*r):(e.u.splice(r),(n?e.t.splice(0,-r):e.t.splice(r)).reduce((s,u)=>s-(u===V?e.o:u),0))},ue=typeof window<"u",ae=()=>document.documentElement,ye=e=>e.ownerDocument,ge=e=>e.defaultView,fe=te(()=>!!ue&&getComputedStyle(ae()).direction==="rtl"),de=te(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),we=te(()=>"scrollBehavior"in ae().style),xe=e=>A(e.h(),e._()),be=(e,t,n,r,s)=>(r!==1&&(e-=A(0,n)),r!==2&&(t+=A(0,n)),[A(e,0),q(t,s-1)]),ke=(e,t=40,n=0,r,s=!1,u=0)=>{let l=!!n,h=[],o=0,c=0,d=0,f=0,a=0,g=0,C=0,S=0,E=l?[0,A(n-1,0)]:null,m=[0,0],x=0;const p=((i,v,b)=>({o:b?b[1]:v,t:b&&b[0]?J(b[0].slice(0,q(i,b[0].length)),A(0,i-b[0].length)):J([],i),l:i,i:-1,u:J([],i)}))(e,t,r),Y=new Set,X=()=>c-u,F=i=>((v,b,D,L)=>{const j=re(v,b,q(D,v.l-1));return[j,re(v,b+L,j)]})(p,i,m[0],o),w=()=>(i=>i.l?ee(i,i.l-1)+G(i,i.l-1):0)(p),W=i=>ee(p,i)-a,z=i=>G(p,i),H=i=>{i&&(de()&&C!==0?a+=i:(f+=i,d++))};return{p:()=>h,v:()=>(i=>[[...i.t],i.o])(p),m:()=>g?m:(m=F(A(0,X()+a+f)),E?[q(m[0],E[0]),A(m[1],E[1])]:m),S:i=>p.t[i]===V,I:()=>!!E&&p.t.slice(A(0,E[0]-1),q(p.l-1,E[1]+1)+1).includes(V),k:W,R:z,C:()=>p.l,M:()=>c,T:()=>C,_:()=>o,H:()=>u,h:w,W:()=>d,J:()=>(g=f,f=0,[g,S===2]),B(i,v){const b=[i,v];return Y.add(b),()=>{Y.delete(b)}},O(i,v){let b,D,L=0;switch(i){case 1:{const j=g;g=0;const y=v-c,M=ne(y);j&&M<ne(j)+1||S!==0||(C=y<0?2:1),l&&(E=null,l=!1),c=v,L=4;const O=X();O>=-o&&O<=w()&&(L+=1,D=M>o);break}case 2:L=8,C!==0&&(b=!0,L+=1),C=0,S=0,E=null;break;case 3:{const j=v.filter(([y,M])=>p.t[y]!==M);if(!j.length)break;H(j.reduce((y,[M,O])=>((S===2||(E?M<E[0]:W(M)+(C===0&&S===0?z(M):0)<X()))&&(y+=O-z(M)),y),0));for(const[y,M]of j){const O=z(y),P=ve(p,y,M);s&&(x+=M,P||(x-=O))}s&&o&&x>o&&(H(((y,M)=>{let O=0;const P=y.t.filter((T,I)=>{const $=T!==V;return $&&I<M&&O++,$}),k=y.o;return y.i=-1,((y.o=(T=>{const I=le(T),$=T.length/2|0;return I.length%2==0?(I[$-1]+I[$])/2:I[$]})(P))-k)*A(M-O,0)})(p,m[0])),s=!1),L=3,D=!0;break}case 4:o!==v&&(o=v,L=3);break;case 5:v[1]?(H(oe(p,v[0],!0)),S=2,L=1):oe(p,v[0]);break;case 6:u=v;break;case 7:S=1;break;case 8:E=F(v),L=1}L&&(h=[],b&&a&&(f+=a,a=0,d++),Y.forEach(([j,y])=>{L&j&&y(D)}))}}},U=ue?R.useLayoutEffect:R.useEffect,N=(e,t)=>t&&fe()?-e:e,Re=(e,t,n,r,s,u)=>{const l=Date.now;let h=0,o=!1,c=!1,d=!1,f=!1;const a=(()=>{let m;const x=()=>{Z(m)&&clearTimeout(m)},p=()=>{x(),m=Q(()=>{m=null,(()=>{if(o||c)return o=!1,void a();d=!1,e.O(2)})()},150)};return p.L=x,p})(),g=()=>{h=l(),d&&(f=!0),e.O(1,r()),a()},C=m=>{if(o||e.T()===0||m.ctrlKey)return;const x=l()-h;150>x&&50<x&&(n?m.deltaX:m.deltaY)&&(o=!0)},S=()=>{c=!0,d=f=!1},E=()=>{c=!1,de()&&(d=!0)};return t.addEventListener("scroll",g),t.addEventListener("wheel",C,{passive:!0}),t.addEventListener("touchstart",S,{passive:!0}),t.addEventListener("touchend",E,{passive:!0}),{$:()=>{t.removeEventListener("scroll",g),t.removeEventListener("wheel",C),t.removeEventListener("touchstart",S),t.removeEventListener("touchend",E),a.L()},A:()=>{const[m,x]=e.J();m&&(s(N(m,n),x,f),f=!1,x&&e._()>e.h()&&e.O(1,r()))}}},Ee=(e,t)=>{let n,r,s;const u=t?"scrollLeft":"scrollTop",l=t?"overflowX":"overflowY",h=async(o,c)=>{if(!n)return void ce(()=>h(o,c));s&&s();const d=()=>{let f;return[new Promise((a,g)=>{f=a,Q(s=g,150)}),e.B(2,()=>{f&&f()})]};if(c&&we()){for(;e.O(8,o()),e.I();){const[f,a]=d();try{await f}catch{return}finally{a()}}n.scrollTo({[t?"left":"top"]:N(o(),t),behavior:"smooth"})}else for(;;){const[f,a]=d();try{n[u]=N(o(),t),e.O(7),await f}catch{return}finally{a()}}};return{D(o){n=o,r=Re(e,o,t,()=>N(o[u],t),(c,d,f)=>{if(f){const a=o.style,g=a[l];a[l]="hidden",Q(()=>{a[l]=g})}d?(o[u]=e.M()+c,s&&s()):o[u]+=c})},$(){r&&r.$()},P(o){h(()=>o)},V(o){o+=e.M(),h(()=>o)},X(o,{align:c,smooth:d,offset:f=0}={}){if(o=ie(o,0,e.C()-1),c==="nearest"){const a=e.k(o),g=e.M();if(a<g)c="start";else{if(!(a+e.R(o)>g+e._()))return;c="end"}}h(()=>f+e.H()+e.k(o)+(c==="end"?e.R(o)-e._():c==="center"?(e.R(o)-e._())/2:0),d)},A:()=>{r&&r.A()}}},_="current",he=(e,t)=>{if(pe(e))for(const n of e)he(n,t);else Z(e)&&typeof e!="boolean"&&t.push(e)},Me=(e,t)=>{const n=e.key;return Z(n)?n:"_"+t},Te=e=>{const t=R.useRef();return t[_]||(t[_]=e())},se=e=>{const t=R.useRef(e);return U(()=>{t[_]=e},[e]),t},Se=e=>{let t;return{D(n){(t||(t=new(ge(ye(n))).ResizeObserver(e))).observe(n)},Y(n){t.unobserve(n)},$(){t&&t.disconnect()}}},Le=(e,t)=>{let n;const r=t?"width":"height",s=new WeakMap,u=Se(l=>{const h=[];for(const{target:o,contentRect:c}of l)if(o.offsetParent)if(o===n)e.O(4,c[r]);else{const d=s.get(o);Z(d)&&h.push([d,c[r]])}h.length&&e.O(3,h)});return{j(l){u.D(n=l)},q:(l,h)=>(s.set(l,h),u.D(l),()=>{s.delete(l),u.Y(l)}),$:u.$}},je=R.memo(({U:e,F:t,G:n,K:r,N:s,Z:u,ee:l,te:h})=>{const o=R.useRef(null);U(()=>t(o[_],n),[n]);const c=R.useMemo(()=>{const d={margin:0,padding:0,position:s&&h?void 0:"absolute",[l?"height":"width"]:"100%",[l?"top":"left"]:0,[l?fe()?"right":"left":"top"]:r,visibility:!s||h?"visible":"hidden"};return l&&(d.display="flex"),d},[r,s,h]);return B.jsx(u,typeof u=="string"?{ref:o,style:c,children:e}:{ref:o,style:c,index:n,children:e})}),Ce=e=>R.useReducer(e.p,void 0,e.p)[1],Ie=(e,t)=>R.useMemo(()=>{if(typeof e=="function")return[e,t||0];const n=(r=>{const s=[];return he(r,s),s})(e);return[r=>n[r],n.length]},[e,t]),Oe=R.forwardRef(({children:e,count:t,overscan:n=4,keepMounted:r,itemSize:s,shift:u,horizontal:l,cache:h,startMargin:o,ssrCount:c,as:d="div",item:f="div",scrollRef:a,onScroll:g,onScrollEnd:C,onRangeChange:S},E)=>{const[m,x]=Ie(e,t),p=R.useRef(null),Y=R.useRef(!!c),X=se(g),F=se(C),[w,W,z,H]=Te(()=>{const k=!!l,T=ke(x,s,c,h,!s,o);return[T,Le(T,k),Ee(T,k),k]});x!==w.C()&&w.O(5,[x,u]);const i=Ce(w),[v,b]=w.m(),D=w.T(),L=w.W(),j=w.h(),y=[],[M,O]=be(v,b,n,D,x),P=k=>{const T=m(k);return B.jsx(je,{F:W.q,G:k,K:w.k(k),N:w.S(k),Z:f,U:T,ee:H,te:Y[_]},Me(T,k))};U(()=>{Y[_]=!1;const k=w.B(1,K=>{K?me.flushSync(i):i()}),T=w.B(4,()=>{X[_]&&X[_](w.M())}),I=w.B(8,()=>{F[_]&&F[_]()}),$=K=>{W.j(K),z.D(K)};return a?ce(()=>$(a[_])):$(p[_].parentElement),()=>{k(),T(),I(),W.$(),z.$()}},[]),U(()=>{z.A()},[L]),R.useEffect(()=>{S&&S(v,b)},[v,b]),R.useImperativeHandle(E,()=>({get cache(){return w.v()},get scrollOffset(){return w.M()},get scrollSize(){return xe(w)},get viewportSize(){return w._()},getItemOffset:w.k,scrollToIndex:z.X,scrollTo:z.P,scrollBy:z.V}),[]);for(let k=M,T=O;k<=T;k++)y.push(P(k));if(r){const k=[],T=[];le(r).forEach(I=>{I<M&&k.push(P(I)),I>O&&T.push(P(I))}),y.unshift(...k),y.push(...T)}return B.jsx(d,{ref:p,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:H?j:"100%",height:H?"100%":j,pointerEvents:D!==0?"none":"auto"},children:y})}),_e=R.forwardRef(({children:e,count:t,overscan:n,keepMounted:r,itemSize:s,shift:u,horizontal:l,reverse:h,cache:o,ssrCount:c,item:d,onScroll:f,onScrollEnd:a,onRangeChange:g,style:C,...S},E)=>{const m=R.useRef(null),x=h&&!l;let p=B.jsx(Oe,{ref:E,scrollRef:x?m:void 0,count:t,overscan:n,keepMounted:r,itemSize:s,shift:u,horizontal:l,cache:o,ssrCount:c,item:d,onScroll:f,onScrollEnd:a,onRangeChange:g,children:e});return x&&(p=B.jsx("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:p})),B.jsx("div",{ref:m,...S,style:{display:l?"inline-block":"block",[l?"overflowX":"overflowY"]:"auto",contain:"strict",width:"100%",height:"100%",...C},children:p})}),ze=R.memo(({count:e,Component:t,handle:n})=>{const r=R.useRef(null);return R.useImperativeHandle(n,()=>({scrollToIndex:s=>{var u;(u=r.current)==null||u.scrollToIndex(s)}})),B.jsx(_e,{ref:r,children:Array.from({length:e}).map((s,u)=>B.jsx(t,{index:u},u))})});ze.__docgenInfo={description:"",methods:[{name:"scrollToIndex",docblock:null,modifiers:[],params:[{name:"i",optional:!1,type:null}],returns:null}],displayName:"VirtuaList",props:{count:{required:!0,tsType:{name:"number"},description:""},Component:{required:!0,tsType:{name:"SimpleItem"},description:""},handle:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{ scrollToIndex: (index: number) => void }",signature:{properties:[{key:"scrollToIndex",value:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<ListHandle>"},description:""}}};export{ze as V};
