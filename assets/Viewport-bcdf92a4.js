import{r as T}from"./index-c6dae603.js";import{r as ce}from"./index-eb008d06.js";import{j as Q}from"./jsx-runtime-c3d7f245.js";const M=Math.min,h=Math.max,ae=Math.abs,Y=Date.now,Te=Object.values,se=setTimeout,V=(e,t,n)=>M(n,h(t,e)),J=e=>e!=null,de=e=>{const t=[...e].sort((s,r)=>s-r),n=e.length/2|0;return t.length%2===0?(t[n-1]+t[n])/2:t[n]},ne=(e,t)=>{let n;const s=()=>{J(n)&&clearTimeout(n)},r=()=>{s(),n=se(()=>{n=null,e()},t)};return r._cancel=s,r},_e=(e,t)=>{let n=Y()-t;return(...s)=>{const r=Y();n+t<r&&(n=r,e(...s))}},K=e=>{let t,n;return(...s)=>(t||(t=!0,n=e(...s)),n)},R=-1,y=(e,t)=>{const n=e._sizes[t];return n===R?e._defaultItemSize:n},me=(e,t,n)=>{const s=e._sizes[t]===R;return e._sizes[t]=n,e._measuredOffsetIndex=M(t,e._measuredOffsetIndex),s},X=(e,t)=>{if(!e._length)return 0;if(e._measuredOffsetIndex>=t)return e._offsets[t];let n=e._measuredOffsetIndex,s=e._offsets[n];for(;n<t;)s+=y(e,n),e._offsets[++n]=s;return e._measuredOffsetIndex=t,s},pe=e=>e._length?X(e,e._length-1)+y(e,e._length-1):0,G=(e,t,n)=>{let s=0;if(n>=0)for(;t<e._length-1;){const r=y(e,t++);if((s+=r)>=n){s-r/2>=n&&t--;break}}else for(;t>0;){const r=y(e,--t);if((s-=r)<=n){s+r/2<n&&t++;break}}return V(t,0,e._length-1)},$=(e,t,n)=>G(e,n,t-X(e,n)),ge=(e,t,n)=>e._sizes.slice(t,n+1).includes(R),Se=e=>{const t=e._sizes.filter(s=>s!==R),n=t[0];e._defaultItemSize=t.every(s=>s===n)?n:de(t)},re=(e,t,n)=>{const s=n?"unshift":"push";for(let r=e._length;r<t;r++)e._sizes[s](R),e._offsets.push(r===0?0:R);e._length=t},Ie=(e,t)=>{const n={_defaultItemSize:t,_length:0,_measuredOffsetIndex:0,_sizes:[],_offsets:[]};return re(n,e),n},H=(e,t,n)=>{const s=t-e._length,r=s<0;let f;return r?(f=(n?e._sizes.splice(0,-s):e._sizes.splice(s)).reduce((l,i)=>l+(i===R?e._defaultItemSize:i),0),e._offsets.splice(s)):(f=e._defaultItemSize*s,re(e,e._length+s,n)),e._measuredOffsetIndex=n?0:V(t-1,0,e._measuredOffsetIndex),e._length=t,[f,r]},q=(e,t)=>t.reduce((n,[s,r])=>n+(r-y(e,s)),0),we=1.5,C=0,be=1,ee=2,k=1,U=2,Ee=3,W=4,oe=5,F=6,ie=7,j=1,N=2,B=4,Z=8,Oe=16,Ce=(e,t=40,n=0,s=Ie(e,t),r,f)=>{let l=t*h(n-1,0),i=0,o=0,a=0,d=C,m=!1,u=!1,b=!1,p=[0,n];const g=new Set,I=()=>pe(s),O=()=>I()-l,v=_=>V(_,0,O()),x=_=>{const c=d;return d=_,d!==c&&(d===C||c===C)};return{_getCache(){return JSON.parse(JSON.stringify(s))},_getRange(){const[_,c]=p,w=$(s,i,M(_,s._length-1)),S=G(s,w,l);return _===w&&c===S?p:p=[w,S]},_isUnmeasuredItem(_){return s._sizes[_]===R},_hasUnmeasuredItemsInTargetViewport(_){const c=$(s,_,p[0]);return ge(s,h(0,c-1),M(s._length-1,G(s,c,l)+1))},_getItemOffset(_){const c=X(s,_);return r?c+h(0,l-I()):c},_getItemSize(_){return y(s,_)},_getItemsLength(){return s._length},_getScrollOffset(){return i},_getScrollOffsetMax:O,_getIsScrolling(){return d!==C},_getViewportSize(){return l},_getCorrectedScrollSize(){return h(I(),l)},_getJumpCount(){return o},_flushJump(){const _=a;return a=0,_},_subscribe(_,c){const w=[_,c];return g.add(w),()=>{g.delete(w)}},_update(_,c){let w,S=0;switch(_){case k:{const E=c.filter(([L,A])=>s._sizes[L]!==A);if(!E.length)break;let z=0;if(m||u){if(i!==0)if(i>O()-we)z=q(s,E);else{const[L]=p;z=q(s,E.filter(([A])=>A<L))}}else d===ee&&(z=q(s,E));z&&(a=z,o++,S+=B);let D=!1;E.forEach(([L,A])=>{me(s,L,A)&&(D=!0)}),f&&D&&!i&&Se(s),S+=N,b=w=!0;break}case U:{l!==c&&(l=c,S=N);break}case Ee:{if(c[1]){const E=O()-i,[z,D]=H(s,c[0],!0),L=D?-M(z,E):z;a+=L,i=v(i+L),o++,S=j+B,m=!0}else H(s,c[0]);break}case W:case oe:{if(i===c)break;if(_===W){const E=b;b=!1,(d===C||!E)&&!u&&x(i>c?ee:be)&&(S+=Z),w=ae(i-c)>l,S+=Oe,E||(m=!1)}i=v(c),S+=j;break}case F:{x(C)&&(S=Z),m=u=!1;break}case ie:{u=!0;break}}S&&g.forEach(([E,z])=>{S&E&&z(w)})}}},le=typeof window<"u"?T.useLayoutEffect:T.useEffect,P="current",ye={},ue=(e,t)=>{if(Array.isArray(e))for(const n of e)ue(n,t);else!J(e)||typeof e=="boolean"||t.push(e)},Ne=e=>{const t=[];return ue(e,t),t},ve=e=>{const t=T.useRef(e);return le(()=>{t[P]=e},[e]),t},xe=j+N,Ae=N,Me=B,Ve=Z,ke=N,Ue=(e,t,n,s)=>{const[r,f]=T.useState(t),l=ve(t);if(le(()=>{const i=()=>{f(()=>l[P]())};return e._subscribe(n,o=>{o?ce.flushSync(i):i()})},[]),s){const i=t();r!==i&&f(i)}return r},ze=K(e=>{const t="scrollLeft",n=e[t];e[t]=1;const s=e[t]<1;return e[t]=n,s}),fe=(e,t,n)=>_e(s=>{if(e._getIsScrolling()&&!s.ctrlKey&&(t?s.deltaX:s.deltaY)){const r=e._getScrollOffset();r>0&&r<e._getScrollOffsetMax()&&n()}},50),De=(e,t,n)=>{let s,r;const f=t?"scrollLeft":"scrollTop",l=(o,a)=>t&&n?ze(s)||a?-o:e._getScrollOffsetMax()-o:o,i=async o=>{if(!s)return;const a=()=>V(o(),0,e._getScrollOffsetMax());for(;;){const d=a();if(e._update(oe,d),!e._hasUnmeasuredItemsInTargetViewport(d))break;r&&r[1]();const m=e._subscribe(N,()=>{r&&r[0]()});try{await new Promise((u,b)=>{let p=!1;const g=()=>{p||(p=!0,u(),r=void 0)};r=[g,b],se(g,250)})}catch{return}finally{m()}}s[f]=l(a()),e._update(ie)};return{_initRoot(o){s=o;const a=()=>{e._update(W,l(o[f]))},d=ne(()=>{a(),e._update(F)},150),m=()=>{a(),d()},u=fe(e,t,d);return o.addEventListener("scroll",m),o.addEventListener("wheel",u,{passive:!0}),()=>{o.removeEventListener("scroll",m),o.removeEventListener("wheel",u),d._cancel()}},_scrollTo(o){i(()=>o)},_scrollBy(o){o+=e._getScrollOffset(),i(()=>o)},_scrollToIndex(o,a){o=V(o,0,e._getItemsLength()-1),i(a==="end"?()=>e._getItemOffset(o)+e._getItemSize(o)-e._getViewportSize():()=>e._getItemOffset(o))},_fixScrollJump:o=>{s&&(s[f]+=l(o,!0))}}},We=(e,t)=>{const n=t?"scrollX":"scrollY",s=t?"offsetLeft":"offsetTop";return{_initRoot(r){let f=!1;const l=(u,b)=>{const p=b+u[s],g=u.offsetParent;return u===document.body||!g?p:l(g,p)},i=()=>{f&&e._update(W,window[n]-l(r,0))},o=ne(()=>{i(),e._update(F)},150),a=()=>{i(),o()},d=fe(e,t,o),m=new IntersectionObserver(([u])=>{f=u.isIntersecting});return m.observe(r),window.addEventListener("scroll",a),window.addEventListener("wheel",d,{passive:!0}),()=>{m.disconnect(),window.removeEventListener("scroll",a),window.removeEventListener("wheel",d),o._cancel()}},_fixScrollJump:r=>{window.scrollBy(t?r:0,t?0:r)}}},Pe=e=>{const t=T.useRef();return t[P]||(t[P]=e())},Je=(e,t)=>{let n;const s=t?"width":"height",r=new WeakMap,f=K(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:a}of l)if(o===n)e._update(U,a[s]);else{const d=r.get(o);J(d)&&i.push([d,a[s]])}i.length&&e._update(k,i)}));return{_observeRoot(l){n=l;const i=f();return i.observe(l),()=>{i.disconnect()}},_observeItem(l,i){const o=f();return r.set(l,i),o.observe(l),()=>{r.delete(l),o.unobserve(l)}}}},Ke=(e,t)=>{const n=t?"width":"height",s=t?"innerWidth":"innerHeight",r=new WeakMap,f=K(()=>new ResizeObserver(l=>{const i=[];for(const{target:o,contentRect:a}of l){const d=r.get(o);J(d)&&i.push([d,a[n]])}i.length&&e._update(k,i)}));return{_observeRoot(){const l=()=>{e._update(U,window[s])};return window.addEventListener("resize",l),l(),()=>{window.removeEventListener("resize",l),f().disconnect()}},_observeItem(l,i){const o=f();return r.set(l,i),o.observe(l),()=>{r.delete(l),o.unobserve(l)}}}},qe=(e,t)=>{let n;const s="height",r="width",f=new WeakMap,l=new Set,i=new Set,o=new Map,a=(m,u)=>`${m}-${u}`,d=K(()=>new ResizeObserver(m=>{const u=new Set,b=new Set;for(const{target:p,contentRect:g}of m)if(p===n)e._update(U,g[s]),t._update(U,g[r]);else{const I=f.get(p);if(I){const[O,v]=I,x=a(O,v),_=o.get(x),c=[g[s],g[r]];let w,S;_?(_[0]!==c[0]&&(w=!0),_[1]!==c[1]&&(S=!0)):w=S=!0,w&&u.add(O),S&&b.add(v),(w||S)&&o.set(x,c)}}if(u.size){const p=[];u.forEach(g=>{let I=0;i.forEach(O=>{const v=o.get(a(g,O));v&&(I=h(I,v[0]))}),I&&p.push([g,I])}),e._update(k,p)}if(b.size){const p=[];b.forEach(g=>{let I=0;l.forEach(O=>{const v=o.get(a(O,g));v&&(I=h(I,v[1]))}),I&&p.push([g,I])}),t._update(k,p)}}));return{_observeRoot(m){n=m;const u=d();return u.observe(m),()=>{u.disconnect()}},_observeItem(m,u,b){const p=d();return f.set(m,[u,b]),l.add(u),i.add(b),p.observe(m),()=>{f.delete(m),p.unobserve(m)}}}},te=T.forwardRef(({children:e,attrs:t,width:n,height:s,scrolling:r},f)=>Q("div",{ref:f,...t,children:Q("div",{style:T.useMemo(()=>({position:"relative",visibility:"hidden",width:n??"100%",height:s??"100%",pointerEvents:r?"none":"auto"}),[n,s,r]),children:e})}));try{te.displayName="Viewport",te.__docgenInfo={description:"",displayName:"Viewport",props:{children:{defaultValue:null,description:"Renderable item elements.",name:"children",required:!0,type:{name:"ReactNode"}},attrs:{defaultValue:null,description:"Attributes that should be passed to the scrollable element.",name:"attrs",required:!0,type:{name:"ViewportComponentAttributes"}},height:{defaultValue:null,description:"Total height of items. It's undefined if component is not vertically scrollable.",name:"height",required:!0,type:{name:"number | undefined"}},width:{defaultValue:null,description:"Total width of items. It's undefined if component is not horizontally scrollable.",name:"width",required:!0,type:{name:"number | undefined"}},scrolling:{defaultValue:null,description:"Currently component is scrolling or not.",name:"scrolling",required:!0,type:{name:"boolean"}}}}}catch{}export{Ee as A,xe as S,Oe as U,te as V,Pe as a,Ue as b,le as c,ye as d,J as e,Ne as f,Ce as g,Ke as h,We as i,Ve as j,Me as k,Ae as l,h as m,M as n,ke as o,qe as p,De as q,P as r,Je as s,ve as u,Te as v};
//# sourceMappingURL=Viewport-bcdf92a4.js.map
