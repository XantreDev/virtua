"use strict";(self.webpackChunkvirtua=self.webpackChunkvirtua||[]).push([[465],{"./stories/advanced/Chat.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _src__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/react/List.tsx"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_faker_js_faker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@faker-js/faker/dist/esm/index.mjs");const __WEBPACK_DEFAULT_EXPORT__={component:_src__WEBPACK_IMPORTED_MODULE_2__.a},itemStyle={border:"solid 1px #ccc",background:"#fff",margin:10,padding:10,borderRadius:8,whiteSpace:"pre-wrap"},Item=({value,me})=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{...itemStyle,...me?{background:"lightyellow",marginLeft:80}:{marginRight:80}}},value),Default={name:"Chat",render:()=>{const id=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(0),createItem=({value:value2=_faker_js_faker__WEBPACK_IMPORTED_MODULE_1__.We.lorem.paragraphs(1),me=!1}={})=>({id:id.current++,value:value2,me}),[items,setItems]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>Array.from({length:100},(()=>createItem())))),ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[value,setValue]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)("Hello world!");(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{ref.current&&ref.current.scrollToIndex(items.length-1)}),[items.length]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{let canceled=!1,timer=null;const setTimer=()=>{timer=setTimeout((()=>{canceled||(setItems((p=>[...p,createItem()])),setTimer())}),5e3)};return setTimer(),()=>{canceled=!0,timer&&clearTimeout(timer)}}),[]);const disabled=!value.length,submit=()=>{disabled||(setItems((p=>[...p,createItem({value,me:!0})])),setValue(""))};return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:"90vw",height:"90vh",display:"flex",flexDirection:"column"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_src__WEBPACK_IMPORTED_MODULE_2__.a,{ref,style:{flex:1}},items.map(((d,i)=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(Item,{key:d.id,...d})))),react__WEBPACK_IMPORTED_MODULE_0__.createElement("form",{style:{margin:10},onSubmit:e=>{e.preventDefault(),e.stopPropagation(),submit()}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("textarea",{style:{width:400},rows:6,value,onChange:e=>{setValue(e.target.value)},onKeyDown:e=>{"Enter"===e.code&&(e.ctrlKey||e.metaKey)&&(submit(),e.preventDefault())}}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{type:"submit",disabled},"submit")))}};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'{\n  name: "Chat",\n  render: () => {\n    const id = useRef(0);\n    const createItem = ({\n      value: value2 = faker.lorem.paragraphs(1),\n      me = false\n    } = {}) => ({\n      id: id.current++,\n      value: value2,\n      me\n    });\n    const [items, setItems] = useState(() => Array.from({\n      length: 100\n    }, () => createItem()));\n    const ref = useRef(null);\n    const [value, setValue] = useState("Hello world!");\n    useEffect(() => {\n      if (!ref.current) return;\n      ref.current.scrollToIndex(items.length - 1);\n    }, [items.length]);\n    useEffect(() => {\n      let canceled = false;\n      let timer = null;\n      const setTimer = () => {\n        timer = setTimeout(() => {\n          if (canceled) return;\n          setItems(p => [...p, createItem()]);\n          setTimer();\n        }, 5e3);\n      };\n      setTimer();\n      return () => {\n        canceled = true;\n        if (timer) {\n          clearTimeout(timer);\n        }\n      };\n    }, []);\n    const disabled = !value.length;\n    const submit = () => {\n      if (disabled) return;\n      setItems(p => [...p, createItem({\n        value,\n        me: true\n      })]);\n      setValue("");\n    };\n    return /* @__PURE__ */React.createElement("div", {\n      style: {\n        width: "90vw",\n        height: "90vh",\n        display: "flex",\n        flexDirection: "column"\n      }\n    }, /* @__PURE__ */React.createElement(List, {\n      ref,\n      style: {\n        flex: 1\n      }\n    }, items.map((d, i) => /* @__PURE__ */React.createElement(Item, {\n      key: d.id,\n      ...d\n    }))), /* @__PURE__ */React.createElement("form", {\n      style: {\n        margin: 10\n      },\n      onSubmit: e => {\n        e.preventDefault();\n        e.stopPropagation();\n        submit();\n      }\n    }, /* @__PURE__ */React.createElement("textarea", {\n      style: {\n        width: 400\n      },\n      rows: 6,\n      value,\n      onChange: e => {\n        setValue(e.target.value);\n      },\n      onKeyDown: e => {\n        if (e.code === "Enter" && (e.ctrlKey || e.metaKey)) {\n          submit();\n          e.preventDefault();\n        }\n      }\n    }), /* @__PURE__ */React.createElement("button", {\n      type: "submit",\n      disabled\n    }, "submit")));\n  }\n}',...Default.parameters?.docs?.source}}}}}]);